Document Type: WSE
item: Global
  Version=9.02
  Title=Installation
  Title French= Installation
  Flags=00010100
  Languages=65 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
  Copy Default=1
  Japanese Font Name=MS Gothic
  Japanese Font Size=9
  Start Gradient=0 0 255
  End Gradient=0 0 0
  Windows Flags=00000100000010100000110000001010
  Log Pathname=%MAINDIR%\WISE.LOG
  Message Font=MS Sans Serif
  Font Size=8
  Pages Modified=10011000011101100010001100100011
  Extra Pages=00000000000000000000000010110000
  Disk Label=Default
  Disk Filename=SETUP
  Patch Flags=0000000000000001
  Patch Threshold=85
  Patch Memory=4000
  MIF PDF Version=1.0
  MIF SMS Version=2.0
  EXE Filename=Enabler4Setup.exe
  Code Sign Name=Enabler Setup
  Code Sign Info=http://www.integration.co.nz
  Code Sign TimeStamp=http://timestamp.verisign.com/scripts/timstamp.dll
  SPC Pathname=C:\PVK\2010EnbCertificate.spc
  PVK Pathname=C:\PVK\2010Enbkey.pvk
  FTP Cluster Size=20
  Per-User Version ID=1
  Dialogs Version=7
  Version File=%ENB_VERSION%
  Version Description=Enabler Installer
  Version Copyright=2018 Integration Technologies Limited
  Version Company=Integration Technologies Ltd
  Crystal Format=10111100101100000010001001001001
  Crystal Destination=00000000000000000000000000001011
  Distribute Type=1
  Step View=&Properties
  Variable Name1=_SYS_
  Variable Default1=C:\WINNT\system32
  Variable Flags1=00001000
  Variable Name2=_WIN_
  Variable Default2=C:\WINNT
  Variable Flags2=00001000
  Variable Name3=_WISE_
  Variable Default3=C:\PROGRA~2\WISEIN~1
  Variable Flags3=00001000
  Variable Name4=_JETOPT_
  Variable Default4=AB
  Variable Flags4=00001000
  Variable Name5=_ODBC16_
  Variable Default5=C:\WINNT\system32
  Variable Flags5=00001000
  Variable Name6=_ODBC32_
  Variable Default6=C:\WINNT\system32
  Variable Flags6=00001000
  Variable Name7=_ALIASNAME_
  Variable Flags7=00001000
  Variable Name8=_ALIASPATH_
  Variable Flags8=00001000
  Variable Name9=_ALIASTYPE_
  Variable Flags9=00001000
  Variable Name10=_VB4WIN32SAVE_
  Variable Flags10=00001000
  Variable Name11=_VBINIT_
  Variable Default11=VB6SP5
  Variable Flags11=00001000
  Variable Name12=_VB4WIN32OPT_
  Variable Default12=Aacdefgcdg
  Variable Flags12=00001000
  Variable Name13=_VB4WIN32DIR_
  Variable Default13=C:\Program Files\Microsoft Visual Studio\VB98
  Variable Flags13=00001000
  Variable Name14=_VB4WIN32DAO_
  Variable Default14=c:\Program Files\Common Files\Microsoft Shared\DAO
  Variable Flags14=00001000
  Variable Name15=_COMMONFILES_
  Variable Default15=c:\Program Files\Common Files
  Variable Flags15=00001000
  Variable Name16=ENB_VERSION
  Variable Description16=Enter the version For this Enabler Release.  E.g. 3.30.2
  Variable Name17=_INIT_WINDOW_
  Variable Default17=HIDE
  Variable Flags17=00001000
  Variable Name18=_PCIFIRMWARE_
  Variable Description18=Version of Firmware included in install package.
  Variable Description18=Used for validation only.
  Variable Default18=!
  Variable Flags18=00001000
end
item: Remark
end
item: Remark
end
item: Remark
  Text=SQL2008 R2 preferred, then SQL2005, SQL2012 next, then MSDE2000
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=======                                                            ======
end
item: Remark
  Text=======      V4   SCRIPT INITIALISATION      ======
end
item: Remark
  Text=======                                                            ======
end
item: Remark
  Text===========================================
end
item: Remark
end
item: Remark
  Text=EnablerSetup return codes:
end
item: Remark
  Text=0 - Successful
end
item: Remark
  Text=1 - Parameter error
end
item: Remark
  Text=2 - new IE/new MDAC required
end
item: Remark
  Text=3 - UNC(network) Install error
end
item: Remark
  Text=4 - No Database Server/MSI/.NET components to install. (Can't add Start menu items)
end
item: Remark
  Text=5 - SA Password error
end
item: Remark
  Text=6 - MSDE/MSI requires reboot
end
item: Remark
  Text=7 - MSDE/MSI/.NET installation error
end
item: Remark
  Text=8 - OSQL not working after install. Reboot required.
end
item: Remark
  Text=9 - DBInstall.bat error
end
item: Remark
  Text=10 - Upgrade error
end
item: Remark
  Text=11 - SQL Server not running
end
item: Remark
  Text=12 - Windows OS not supported
end
item: Remark
  Text=13 - UNUSED (was Device Driver Installation Failure)
end
item: Remark
  Text=14 - UNUSED (was The Driver requires a restart to complete installation)
end
item: Remark
  Text=15 - UNUSED (was The Device wasn't present after driver installation)
end
item: Remark
  Text=16 - UNUSED (was File copy error)
end
item: Remark
  Text=17 - Not admin
end
item: Remark
  Text=18 - SQL Version not compatible
end
item: Remark
  Text=19 - SQL Named Instance incorrect
end
item: Remark
  Text=20 - not enough disk space
end
item: Remark
  Text=21 - C: drive compressed
end
item: Remark
  Text=22 - Installation of VC runtime failed
end
item: Remark
  Text=23 - .NET 3.5 required but cannot be installed automatically (Windows Server 2008 only)
end
item: Remark
  Text=24 - Enabler API install failed
end
item: Remark
  Text=25 - 8dot3Name disabled
end
item: Remark
end
item: Remark
end
item: Remark
  Text=This varaible forces applications to be installed even if the SDK options is not avaliable or selected
end
item: Remark
  Text=By including a letter in a varaible that application will be installed
end
item: Remark
  Text=Even if the SDK options is not avaliable or ticked
end
item: Remark
  Text=See the varaible near the bottom to change what applications are installed when SDK is checked
end
item: Remark
  Text=A - MMPSim
end
item: Remark
  Text=B - Pumpdemo
end
item: Remark
  Text=C - Documents (This includes all SDK documents)
end
item: Remark
  Text=D - Sample Apps (All sample apps are copied across)
end
item: Remark
  Text=F - ITLMPPSim.dll
end
item: Remark
  Text=The default is for none of the apps to be installed without the SDK option selected
end
item: Set Variable
  Variable=SDK_OPTIONS
end
item: Remark
end
item: Remark
  Text=Initialise components variable
end
item: Set Variable
  Variable=COMPONENTS
end
item: Get Registry Key Value
  Variable=COMPONENTS
  Key=Software\ITL\Enabler
  Value Name=Components
  Flags=00000100
end
item: Remark
end
item: Remark
  Text=Initialise Applications variable
end
item: Set Variable
  Variable=APPLICATIONS
end
item: Get Registry Key Value
  Variable=APPLICATIONS
  Key=Software\ITL\Enabler
  Value Name=Applications
  Flags=00000100
end
item: Remark
end
item: Remark
  Text=OS_ARCHITECTURE variable to store the OS architecture (32 or 64)
end
item: Set Variable
  Variable=OS
end
item: Set Variable
  Variable=OS_ARCHITECTURE
end
item: Set Variable
  Variable=OS_ARCHITEW6432
end
item: Set Variable
  Variable=OPERATING_SYSTEM
end
item: Remark
  Text=Disabling 8.3 will install files with short name: https://support.microsoft.com/en-us/kb/121007
end
item: Set Variable
  Variable=FILE_SYSTEM
end
item: Remark
end
item: Remark
  Text=Get the environment variables to determine OS
end
item: Get Environment Variable
  Variable=OS_ARCHITECTURE
  Environment=PROCESSOR_ARCHITECTURE
end
item: Get Environment Variable
  Variable=OS_ARCHITEW6432
  Environment=PROCESSOR_ARCHITEW6432
end
item: Remark
end
item: If/While Statement
  Variable=OS_ARCHITECTURE
  Value=AMD64
end
item: Set Variable
  Variable=OS
  Value=64
end
item: ElseIf Statement
  Variable=OS_ARCHITECTURE
  Value=IA64
end
item: Set Variable
  Variable=OS
  Value=64
end
item: ElseIf Statement
  Variable=OS_ARCHITECTURE
  Value=x86
end
item: If/While Statement
  Variable=OS_ARCHITEW6432
  Value=AMD64
end
item: Remark
  Text=Installing driver from 32-bit installer on 64-bit OS (WOW64)
end
item: Set Variable
  Variable=OS
  Value=64
end
item: Else Statement
end
item: Remark
  Text=Installing driver from 32-bit installer on 32-bit OS
end
item: Set Variable
  Variable=OS
  Value=32
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=We will set this variable according to the 'Windows Current Version' Registry Key
end
item: Remark
  Text=NOTE: The Registry Key is: \\HKLM\Software\Microsoft\Windows NT\CurrentVersion\(CurrentVersion) - it contains a number.
end
item: Remark
  Text=NOTE: Windows 10 returns a value of 6.3 for backwards compatibility. Indicates its Windows 8.1
end
item: Get Registry Key Value
  Variable=OPERATING_SYSTEM
  Key=Software\Microsoft\Windows NT\CurrentVersion
  Value Name=CurrentVersion
  Flags=00000100
end
item: Remark
end
item: Remark
  Text=Driver Installation code
end
item: Set Variable
  Variable=DRIVERCODE
  Value=0
end
item: Remark
end
item: Remark
  Text=SQL Server Major Product Number
end
item: Set Variable
  Variable=SQLVER_MAJOR
end
item: Remark
end
item: Remark
  Text=APPTITLE is the application title of the installation
end
item: Set Variable
  Variable=APPTITLE
  Value=The Enabler
  Flags=10000000
end
item: Set Variable
  Variable=SQLTITLE
  Flags=10000000
end
item: Remark
end
item: Remark
  Text=GROUP is the variable that holds the Program Files Group that shortcuts will be placed on the Windows Start Menu
end
item: Set Variable
  Variable=GROUP
  Value=The Enabler
  Flags=10000000
end
item: Remark
end
item: Remark
  Text=DISABLED variable is initialized for backward compatability
end
item: Set Variable
  Variable=DISABLED
  Value=!
end
item: Remark
end
item: Remark
  Text=MAINDIR is the variable that holds the default destination directory
end
item: Set Variable
  Variable=MAINDIR
  Value=Enabler
  Flags=10000000
end
item: Set Variable
  Variable=MAINDIR
  Value=C:\%MAINDIR%
  Flags=00001100
end
item: Remark
end
item: Set Variable
  Variable=BACKUP
  Value=%MAINDIR%\BACKUP
  Flags=10000000
end
item: Remark
  Text=BACKUP is the variable that holds the path that all backup files will be copied to when overwritten
end
item: Remark
end
item: Remark
  Text=DOBACKUP determines if a backup will be performed.  The possible values are A (do backup) or B (do not do backup)
end
item: Set Variable
  Variable=DOBACKUP
  Value=B
  Flags=10000000
end
item: Remark
end
item: Remark
  Text=DBDIR specifies the location of the Enabler database files
end
item: Set Variable
  Variable=DBDIR
  Value=C:\EnablerDB
end
item: Remark
end
item: Set Variable
  Variable=SQLSERVER_STARTED
end
item: Remark
end
item: Remark
  Text=SA_PASSWORD stores the SA password (if any)
end
item: Set Variable
  Variable=SA_PASSWORD
end
item: Remark
end
item: Remark
  Text=SQL Named Instance name
end
item: Set Variable
  Variable=SQL_SERVERS
end
item: Remark
end
item: Remark
  Text=SQL Named Instance name
end
item: Set Variable
  Variable=SQL_INSTANCE
end
item: Set Variable
  Variable=CLIENT_SQL_INSTANCE
end
item: Set Variable
  Variable=PC_NAME
end
item: Get Environment Variable
  Variable=PC_NAME
  Environment=COMPUTERNAME
end
item: Set Variable
  Variable=SQLQUERY
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=1
end
item: Set Variable
  Variable=INSTANCE_NAME_LIST
  Value=0
end
item: Set Variable
  Variable=CMD_INSTANCE
end
item: Set Variable
  Variable=SQL_INSTANCES
end
item: Remark
end
item: Remark
  Text=OSQL_PATH stores the path to OSQL.EXE
end
item: Set Variable
  Variable=OSQL_PATH
end
item: Remark
end
item: Remark
  Text=SERVER_NAME stores the Enabler Server name (used for client installs only)
end
item: Set Variable
  Variable=SERVER_NAME
end
item: Get Environment Variable
  Variable=ENV_COMPUTERNAME
  Environment=COMPUTERNAME
end
item: Remark
end
item: Remark
  Text=Variable to determine if the BAckup up checkbox option should be shown or not
end
item: Set Variable
  Variable=PRE_BACKUP
  Value=0
end
item: Remark
end
item: Remark
  Text=Initialise Checked variable this stops applications variable resetting in the wizard loop
end
item: Set Variable
  Variable=CHECKED
  Value=A
end
item: Remark
end
item: Remark
  Text=Set variables for an SDK build. SDK checked, SDK_APPS if present
end
item: Set Variable
  Variable=SDK
end
item: Set Variable
  Variable=SDK_APPS
  Value=0
end
item: Get Registry Key Value
  Variable=SDK
  Key=Software\ITL\Enabler
  Value Name=SDK
  Flags=00000100
end
item: Remark
end
item: Remark
  Text=Variables with defaults for ENBWEB port & domain
end
item: Get Registry Key Value
  Variable=ENBWEB_DOMAIN
  Key=Software\ITL\Enabler
  Default=mydomain.com
  Value Name=EnbWebDomain
  Flags=00000100
end
item: Get Registry Key Value
  Variable=ENBWEB_PORT
  Key=Software\ITL\Enabler
  Default=8081
  Value Name=EnbWebPort
  Flags=00000100
end
item: Remark
end
item: Remark
  Text=Initialise icons variable. A is desktop icons B is start menu icons
end
item: Set Variable
  Variable=ICONS
  Value=B
end
item: Remark
end
item: Remark
  Text=set variables to start apps or restart computer on finish
end
item: Set Variable
  Variable=NOSTART
  Value=0
end
item: Set Variable
  Variable=RUNNING
end
item: Set Variable
  Variable=START_MPP
end
item: Set Variable
  Variable=START_PUMP
end
item: Remark
end
item: Remark
  Text=Initialise unattended variables
end
item: Set Variable
  Variable=UNATTENDED
  Value=0
end
item: Set Variable
  Variable=SILENT
  Value=0
end
item: Set Variable
  Variable=PHASE2
  Value=0
end
item: Remark
end
item: Remark
  Text=Initialise fast startup variables
end
item: Set Variable
  Variable=FAST_STARTUP
  Value=0
end
item: Remark
end
item: Remark
  Text=Initialise variables for detecting Adminstrator and User group
end
item: Set Variable
  Variable=BUILTIN_USERS_GROUP
  Value=S-1-5-32-545
end
item: Set Variable
  Variable=BUILTIN_ADMINISTRATORS_GROUP
  Value=S-1-5-32-544
end
item: Remark
end
item: Remark
  Text=SHOW_USAGE indicates whether we should display a dialog describing the installer command-line usage
end
item: Set Variable
  Variable=SHOW_USAGE
  Value=0
end
item: Remark
end
item: Check Configuration
  Flags=10000000
end
item: Check Configuration
  Flags=01011010
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Get Windows version
end
item: Get System Information
  Variable=WINDOWS_VERSION
  Flags=00000001
end
item: Remark
end
item: Remark
  Text=Start WISE.LOG and record the Enabler version
end
item: Open/Close INSTALL.LOG
end
item: Remark
end
item: Remark
  Text=Check the Windows version to see if running on Windows 10
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C  ver | find /i "Version 10."
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=Running on Windows 10 / Windows Server 2016, set OPERATING SYSTEM = 10
end
item: Set Variable
  Variable=OPERATING_SYSTEM
  Value=10
end
item: End Block
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=os = %OPERATING_SYSTEM%  ir=%INSTALL_RESULT%
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Installing Enabler V%ENB_VERSION% on Windows V%WINDOWS_VERSION% %OS%bit (Version %OPERATING_SYSTEM%)
end
item: Remark
end
item: Remark
  Text=Driver Installation code
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=PARSE COMMAND LINE OPTIONS
end
item: Remark
  Text=====================================================================================
end
item: Set Variable
  Variable=CMDLINE_LOG
end
item: Set Variable
  Variable=CMDLINEUPPER
  Value=%CMDLINE%
  Flags=00011000
end
item: If/While Statement
  Variable=CMDLINE
  Flags=00010001
end
item: Set Variable
  Variable=CMDOPTION
end
item: Set Variable
  Variable=CMDUPPER
end
item: Parse String
  Source=%CMDLINE%
  Pattern= 
  Variable1=CMDOPTION
  Variable2=CMDLINE
end
item: Set Variable
  Variable=CMDUPPER
  Value=%CMDOPTION%
  Flags=00011000
end
item: Remark
  Text=!!! DEBUG ONLY - COMMENT OUT FOR RELEASE !!!
end
remarked item: Add Text to INSTALL.LOG
  Text=Option = %CMDUPPER%
end
item: Remark
  Text=!!! DEBUG ONLY - COMMENT OUT FOR RELEASE !!!
end
item: Remark
end
item: Set Variable
  Variable=CMDSTART
end
item: Set Variable
  Variable=CMDEND
end
item: Parse String
  Source=%CMDUPPER%
  Pattern=2
  Variable1=CMDSTART
  Variable2=CMDEND
  Flags=00001000
end
item: Remark
end
item: Remark
  Text=Check for /? or /h or -? or -h  - AT THE START OF THE STRING
end
item: If/While Statement
  Variable=CMDSTART
  Value=-H
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=User requested usage -H
end
item: Set Variable
  Variable=SHOW_USAGE
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=CMDSTART
  Value=-?
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=User requested usage -?
end
item: Set Variable
  Variable=SHOW_USAGE
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=CMDSTART
  Value=/H
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=User requested usage /H
end
item: Set Variable
  Variable=SHOW_USAGE
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=CMDSTART
  Value=/?
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=User requested usage /?
end
item: Set Variable
  Variable=SHOW_USAGE
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Silent unattended install
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/S
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=SILENT install selected
end
item: Set Variable
  Variable=UNATTENDED
  Value=1
end
item: Set Variable
  Variable=SILENT
  Value=1
end
item: Remark
  Text=This error return code is only for Silent Mode Install
end
item: Set Variable
  Variable=WISE_ERROR_RTN
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Automatic server install
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/FULL
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=FULL Enabler Server install selected
end
item: Set Variable
  Variable=UNATTENDED
  Value=1
end
item: Set Variable
  Variable=COMPONENTS
  Value=B
end
item: Set Variable
  Variable=APPLICATIONS
  Value=ABCDEF
end
item: If/While Statement
  Variable=CMDLINEUPPER
  Value=/CLIENT
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot use /CLIENT and /FULL together
end
item: Exit Installation
  Flags=1
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Automatic client install
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/CLIENT
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=CLIENT install selected
end
item: Set Variable
  Variable=UNATTENDED
  Value=1
end
item: Set Variable
  Variable=COMPONENTS
  Value=A
end
item: If/While Statement
  Variable=CMDLINEUPPER
  Value=/FULL
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot use /CLIENT and /FULL together
end
item: Exit Installation
  Flags=1
end
item: End Block
end
item: If/While Statement
  Variable=CMDLINEUPPER
  Value=/PASSWORD
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot use /CLIENT and /PASSWORD together
end
item: Exit Installation
  Flags=1
end
item: End Block
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/CLIENT:
  Flags=00000010
end
item: Parse String
  Source=%CMDOPTION%
  Pattern=/CLIENT:
  Variable1=JUNK
  Variable2=SERVER_NAME
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=Enabler Server name has been entered: %SERVER_NAME%
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Get SA password (used for Server installs with pre-existing SQL server)
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/PASSWORD
  Flags=00000010
end
item: Parse String
  Source=%CMDOPTION%
  Pattern=/PASSWORD:
  Variable1=JUNK
  Variable2=SA_PASSWORD
  Flags=00000010
end
item: Set Variable
  Variable=CMDUPPER
  Value=/PASSWORD:*****
end
item: Add Text to INSTALL.LOG
  Text=PASSWORD for SA has been entered
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Get the SQL Instance name
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/INSTANCE
  Flags=00000010
end
item: Parse String
  Source=%CMDOPTION%
  Pattern=/INSTANCE:
  Variable1=JUNK
  Variable2=SQL_INSTANCE
  Flags=00000010
end
item: Set Variable
  Variable=CMDUPPER
  Value=/INSTANCE:*****
end
item: Add Text to INSTALL.LOG
  Text=SQL Named Instance - %SQL_INSTANCE%
end
item: Set Variable
  Variable=CMD_INSTANCE
  Value=1
end
item: Remark
end
item: Remark
  Text=Configure SQL query for the default instance or the instance name passed in the command line
end
item: Set Variable
  Variable=SQLQUERY
  Value=%PC_NAME%\%SQL_INSTANCE%
end
item: End Block
end
item: Remark
end
item: Remark
  Text=The APPS option is no longer supported
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/APPS:
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=The /APPS option was ignored - this option is no longer supported.
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Option to install simulators WITHOUT SDK
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/MPPSIM
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=Install Simulator EXE and DLL
end
item: Set Variable
  Variable=SDK_OPTIONS
  Value=AF
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Option to install but NOT start Enabler services
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/NOSTART
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=Not starting Enabler services - NOSTART was selected.
end
item: Set Variable
  Variable=NOSTART
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Option to install SDK automatically
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/ENABLERSDK
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=Install Full SDK
end
item: Set Variable
  Variable=SDK_OPTIONS
  Value=ABC
end
item: Set Variable
  Variable=SDK
  Value=A
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Rebuild representation of cmdline suitable for logging
end
item: Set Variable
  Variable=CMDLINE_LOG
  Value=%CMDUPPER% 
  Flags=00000001
end
item: Remark
end
item: Remark
  Text=Supplying the parameter /BACKUPDB will initiate a Pre-Upgrade Backup
end
item: If/While Statement
  Variable=CMDUPPER
  Value=/BACKUPDB
  Flags=00000010
end
item: If/While Statement
  Variable=COMPONENTS
  Value=A
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=INFO: /BACKUPDB option ignored. Cannot backup database on a /CLIENT install.
end
item: Else Statement
end
item: Set Variable
  Variable=PRE_UPGRADE_BACKUP
  Value=A
end
item: End Block
end
item: End Block
end
item: Remark
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SHOW_USAGE
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=WARNING: Install stopped to show usage.
end
item: Custom Dialog Set
  Name=Install Usage
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION% - Setup Command-line Options
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE% 
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=421
    Height=356
    Font Name=Helv
    Font Size=8
    item: Push Button
      Rectangle=181 319 223 333
      Action=1
      Create Flags=01010000000000010000000000000001
      Text=&Exit
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Static
      Rectangle=15 6 393 290
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=    /FULL
      Text=Automatically install Enabler Server (and SQL2008 R2 EXPRESS if required). Also installs all applications (see below) and manuals.
      Text=
      Text=    /PASSWORD:<password>
      Text=Please provide the SA password if you know there is no SQL Server pre-installed and you want to install the included SQL Server 2008 R2 Express. This password needs to be a strong one.
      Text=
      Text=    /CLIENT:<servername>
      Text=Automatically install Enabler Client components only. This will not verify the version of any SQL installations or if their are Named Instances
      Text=
      Text=    /S
      Text=This option selects a completely silent installation (must be the first command-line option).
      Text=
      Text=    /BACKUPDB
      Text=Automatically performs a backup of the database before the database is upgraded (using Nightly.bat).
      Text=
      Text=     /INSTANCE:<SQL Named Instance>
      Text=To install Enabler on an existing SQL Name Instance you need to provide the Instance name using this parameter.
      Text=
      Text=     /MPPSIM
      Text=Install The ITL MPP Simulator and driver for test and demo systems.
      Text=
      Text=     /PORT:<port number>
      Text=To set the port number that Enabler Web Server should use. Default value is 8081
      Text=
      Text=     /DOMAIN:<domain name>
      Text=The security domain used by the Enabler Web Server which client browsers use to store login credentials. Default is mydomain.com.
      Text=
      Text=     /NOSTART
      Text=To install Enabler but not start services (PSRVR and ENBWEB). Useful if for installer that do system updates - before starting Enabler. 
      Text=
      Text=EXAMPLE:
      Text=To install The Enabler Server along with a fresh install of the SQL2008 R2 EXPRESS, SA password is required:
      Text=    Enabler4Setup.EXE /FULL /BACKUPDB /PASSWORD:<password>
      Text=
      Text French=Il vous est fortement recommandé de fermer tous les programmes Windows avant d'exécuter le Programme d'Installation.
      Text French=
      Text French=Cliquez sur Annuler pour quitter l'Installation et fermez tous les programmes actuellement utilisés. Cliquez sur Suivant pour continuer l'installation.
      Text French=
      Text French=ATTENTION : Ce programme est protégé par la loi sur les droits d'exploitation et par les traités internationaux.
      Text French=
      Text French=Toute reproduction ou distribution, même partielle, de ce programme qui n'aura pas reçu d'autorisation préalable fera l'objet de poursuites et sera sévèrement sanctionnée par le droit civil et pénal.
      Text German=Wir empfehlen nachdrücklich, vor Ausführen dieses Installationsprogramms alle Windows-Programme zu beenden. 
      Text German=
      Text German=Auf Abbrechen klicken, um die Installation zu beenden und alle laufenden Programme zu schließen. Auf Weiter klicken, um mit dem Installationsprogramm zu beginnen.
      Text German=
      Text German=WARNUNG: Dieses Programm ist urheberrechtlich sowie durch internationale Verträge geschützt. 
      Text German=
      Text German=Die unzulässige Vervielfältigung oder Verbreitung dieses Programms, ob ganz oder auszugsweise, kann schwere zivil- und strafrechtliche Konsequenzen nach sich ziehen und wird unter voller Ausschöpfung der Rechtsmittel geahndet.
      Text Portuguese=Recomenda-se insistentemente que saia de todos os programas do Windows antes de executar este Programa de Configuração.
      Text Portuguese=
      Text Portuguese=Faça um clique sobre Cancelar para sair da Configuração e feche todos os programas que estiver a executar. Faça um clique sobre Próximo para continuar com o programa de configuração
      Text Portuguese=
      Text Portuguese=AVISO: Este programa está protegido pela lei de direitos do autor e tratados internacionais
      Text Portuguese=
      Text Portuguese=A reprodução e a distribuição sem autorização deste programa, ou qualquer parte dele, pode dar lugar à aplicação de severas sanções civis e criminais, e serão perseguidas à extensão máxima permitida pela lei.
      Text Spanish=Se recomienda encarecidamente que salga de todos los programas Windows antes de ejecutar este programa de Configuración.
      Text Spanish=
      Text Spanish=Haga un clic en Cancelar para abandonar la Configuración y cerrar cualquier programa que haya estado ejecutando. Haga un clic en Siguiente para continuar con el programa de Configuración.
      Text Spanish=
      Text Spanish=AVISO: Este programa está protegido por las leyes de derechos de autor y tratados internacionales.
      Text Spanish=
      Text Spanish=La reproducción o distribución no autorizadas de este programa, o cualquier parte de él, podría dar como resultado rigurosas multas civiles y penales, y se entablará la máxima acción judicial que permita la ley.
      Text Italian=Ti consigliamo di uscire da tutti i programmi Windows prima di eseguire questo programma di installazione.
      Text Italian=
      Text Italian=Fai clic su Annulla per uscire dal programma di installazione e chiudi tutti i programmi aperti. Fai clic su Avanti per continuare con il programma di Installazione.
      Text Italian=
      Text Italian=AVVERTENZA: Questo programma è protetto ai sensi delle norme di legge e delle convenzioni internazionali in materia di diritti di copyright.
      Text Italian=
      Text Italian=La riproduzione o la distribuzione totale o parziale non autorizzata di questo programma potrà essere soggetta a penalità civili e penali, e sarà punita con la massima severità possibile a norma di legge.
      Text Danish=Det anbefales kraftigt at afslutte alle Windows programmer, inden man kører dette installationsprogram.
      Text Danish=
      Text Danish=Klik på Annuller for at forlade installationsprogrammet og lukke alle igangværende programmer. Klik på Næste for at fortsætte med installationsprogrammet.
      Text Danish=
      Text Danish=ADVARSEL: Dette program er beskyttet af copyright og internationale traktater. 
      Text Danish=
      Text Danish=Uautoriseret gengivelse eller videresalg af dette program eller dele heraf kan føre til streng civil- og/eller kriminel stra. Retsforfølgning heraf vil finde sted i det videste omfang der hjemles muligt.
      Text Dutch=Het wordt aangeraden om alle Windows programma's af te sluiten voordat u met de installatie van dit programma begint.
      Text Dutch=
      Text Dutch=Klik op Annuleren om de installatie te verlaten en eventueel nog lopende programma's af te sluiten. Klik op Volgende om verder te gaan met het Installatieprogramma.
      Text Dutch=
      Text Dutch=WAARSCHUWING: dit computerprogramma is auteursrechtelijk beschermd.
      Text Dutch=
      Text Dutch=Onrechtmatige verveelvoudiging of distributie van dit programma of een gedeelte ervan is verboden en strafbaar en zal met alle beschikbare juridische middelen worden bestreden.
      Text Norwegian=Det anbefales på det sterkeste at du avslutter alle Windows-programmer før du kjører dette Oppsett-programmet.
      Text Norwegian=
      Text Norwegian=Velg Avbryt for å avbryte Oppsett og lukk alle programmer som er i bruk. Velg Neste for å fortsette med Oppsett-programmet.
      Text Norwegian=
      Text Norwegian=ADVARSEL: Dette programmet er beskyttet i henhold til lover om opphavsrett og internasjonale konvensjoner.
      Text Norwegian=
      Text Norwegian=Uautorisert kopiering eller distribuering av dette programmet eller deler av det, vil resultere i alvorlig sivil og kriminell straff og vil føre til saksmål i høyest mulig utstrekning i henhold til loven. 
      Text Swedish=Du tillråds bestämt att gå ur alla Windows-program innan du kör installationsprogrammet.
      Text Swedish=
      Text Swedish=Klicka på Avbryt för att gå ur installationsprogrammet och stäng eventuella program som du har laddade. Klicka på Nästa för att fortsätta med installationen.
      Text Swedish=
      Text Swedish=VARNING: Detta program är skyddat av upphovsrätten och internationella avtal.
      Text Swedish=
      Text Swedish=Om du utan tillstånd kopierar eller distribuerar detta program eller delar av det kan det bli allvarliga civilrättsliga och brottsrättliga straffpåföljder. Vi beivrar sådana överträdelser i den allra högsta utsträckning som lagen tillåter.
    end
    item: Static
      Rectangle=9 295 401 322
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-12 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Note: Windows login of the admin level is required to install/upgrade the Enabler System.  SQL2008 Express will be installed if no SQL server is pre-installed, a strong SA password is required .
    end
  end
end
item: Exit Installation
  Flags=1
end
item: End Block
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=CMD %CMDLINE_LOG%
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=STARTUP PROCESSING
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=Check if the user is an admin first
end
item: Install File
  Source=v:\IsAdmin.exe
  Destination=%TEMP%\IsAdmin.exe
  Flags=0000000010100010
end
item: Execute Program
  Pathname=%TEMP%\IsAdmin.exe
  Default Directory=%WIN%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Not an Administrator
  Text=You need to be logged in as an adminisitrator to run Enabler Install.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Install stopped - Not an administrator
end
item: Exit Installation
  Flags=17
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=Install autosupport early on so that if an error occurs customers can use it
end
item: Install File
  Source=V:\AutoSupport.exe
  Destination=%MAINDIR%\AutoSupport.exe
  Flags=0000000010100010
end
item: Remark
end
item: Remark
  Text=Needed to view release notes. Maybe a pdf version could be included as well as we have a pdf viewer
end
item: Remark
  Text=IEXPLORE_PATH is used to store the full path and name of the IE executable.
end
item: Set Variable
  Variable=IEXPLORE_PATH
end
item: Get Registry Key Value
  Variable=IEXPLORE_PATH
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\IEXPLORE.EXE
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=IE location %IEXPLORE_PATH%
end
item: Get System Information
  Variable=IEXPLORE_VERSION
  Pathname=%IEXPLORE_PATH%
  Flags=00000101
end
item: Add Text to INSTALL.LOG
  Text=IE Ver %IEXPLORE_VERSION%
end
item: If/While Statement
  Variable=IEXPLORE_VERSION
  Value=5
  Flags=00001000
end
item: Remark
  Text=We require IE 5 or later
end
item: Set Variable
  Variable=SHOW_IE_WARNING
  Value=0
end
item: Check if File/Dir Exists
  Pathname=%INST%\Release Notes.htm
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=WARNING:A newer version of IE is required to display Release Notes
end
item: Set Variable
  Variable=SHOW_IE_WARNING
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=SHOW_IE_WARNING
  Value=1
end
item: If/While Statement
  Variable=UNATTENDED
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=Install stopped - newer version of IE is required
end
item: Exit Installation
  Flags=2
end
item: End Block
end
item: Display Message
  Title=A newer Internet Explorer is Required
  Text=Some components of The Enabler sofware depend on the version of Microsoft Internet Explorer installed on this computer.
  Text=
  Text=Do you want to proceed with installation, or exit to upgrade Internet Explorer to Version 5 or later.
  Flags=00001101
end
item: Add Text to INSTALL.LOG
  Text=User chose to exit install
end
item: Exit Installation
  Flags=2
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Copy readme and release notes files into TEMP folder
end
item: Get Temporary Filename
  Variable=READMEFILE
end
item: Install File
  Source=v:\release.txt
  Destination=%TEMP%\%READMEFILE%
  Flags=0000000000100010
end
item: Check if File/Dir Exists
  Pathname=%INST%\Release Notes.htm
  Flags=00000100
end
item: Set Variable
  Variable=HTML_RELEASE_NOTES
  Value=1
end
item: Else Statement
end
item: Set Variable
  Variable=HTML_RELEASE_NOTES
  Value=0
end
item: End Block
end
item: Remark
end
item: Remark
  Text=If the destination system does not have a writable Windows\System directory, system files will be written to the Windows\ directory
end
item: Check if File/Dir Exists
  Pathname=%SYS%
  Flags=10000100
end
item: Set Variable
  Variable=SYS
  Value=%WIN%
end
item: End Block
end
item: Remark
end
item: Remark
  Text=INST_DRIVE stores the drive letter we are installing from
end
item: Parse String
  Source=%INST%
  Pattern=2
  Variable1=INST_DRIVE
  Flags=00001000
end
item: Add Text to INSTALL.LOG
  Text=Installing from %INST_DRIVE% drive
end
item: Remark
end
item: Remark
  Text=Figure out the Windows OS product type
end
item: Execute Program
  Pathname=%SYS32%\cmd.exe
  Command Line=/c wmic.exe os get producttype > "%TEMP%\WinProductType.txt"
  Default Directory=%MAINDIR%
  Flags=00000110
end
item: Remark
end
item: Find File in Path
  Variable=CMD_PATH
  Pathname List=CMD.EXE
end
item: Remark
end
item: Remark
  Text=USERNAME is the variable that holds the Windows Logon name
end
item: Get System Information
  Variable=USERNAME
  Flags=00010001
end
item: Remark
end
item: Remark
  Text=Decide whether we are installing on a server OS
end
item: Set Variable
  Variable=IS_WINDOWS_SERVER
  Value=0
end
item: Read/Update Text File
  Variable=WIN_PRODUCT_TYPE_LINE
  Pathname=%TEMP%\WinProductType.txt
end
item: If/While Statement
  Variable=WIN_PRODUCT_TYPE_LINE
  Value=1
  Flags=00000010
end
item: Remark
  Text=Workstation Edition of Windows
end
item: Set Variable
  Variable=WIN_PRODUCT_TYPE
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=WIN_PRODUCT_TYPE_LINE
  Value=2
  Flags=00000010
end
item: Remark
  Text=Domain controller
end
item: Set Variable
  Variable=WIN_PRODUCT_TYPE
  Value=2
end
item: Set Variable
  Variable=IS_WINDOWS_SERVER
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=WIN_PRODUCT_TYPE_LINE
  Value=3
  Flags=00000010
end
item: Remark
  Text=Server
end
item: Set Variable
  Variable=WIN_PRODUCT_TYPE
  Value=3
end
item: Set Variable
  Variable=IS_WINDOWS_SERVER
  Value=1
end
item: End Block
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Windows Product Type: %WIN_PRODUCT_TYPE%
end
item: Remark
end
item: Remark
  Text=This IF/THEN/ELSE blocks reads the default Program Files and Common directories from the registry
end
item: Check Configuration
  Flags=10111011
end
item: Get Registry Key Value
  Variable=COMMON
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion
  Default=C:\Program Files\Common Files
  Value Name=CommonFilesDir
  Flags=00000100
end
item: Get Registry Key Value
  Variable=PROGRAM_FILES
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion
  Default=C:\Program Files
  Value Name=ProgramFilesDir
  Flags=00000100
end
item: Set Variable
  Variable=EXPLORER
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
  Text=BRANDING determines if the installation will be branded with a name and company. 
end
item: Check if File/Dir Exists
  Pathname=%INST%\branding\config.ini
  Flags=00000100
end
item: Read INI Value
  Variable=NAME
  Pathname=%INST%\branding\config.ini
  Section=Registration
  Item=Name
end
item: Read INI Value
  Variable=COMPANY
  Pathname=%INST%\branding\config.ini
  Section=Registration
  Item=Company
end
item: Read INI Value
  Variable=LOGO_TYPE
  Pathname=%INST%\branding\config.ini
  Section=Registration
  Item=INSTALL_LOGO
  Default=ITL
end
item: If/While Statement
  Variable=NAME
end
item: Set Variable
  Variable=DOBRAND
  Value=1
end
item: Get System Information
  Variable=NAME
  Flags=00000110
end
item: Get System Information
  Variable=COMPANY
  Flags=00000111
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=See if there is a current Enabler database.
end
item: Check if File/Dir Exists
  Pathname=%DBDIR%\ENBData.dat
  Flags=00000100
end
item: Set Variable
  Variable=PRE_BACKUP
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Initialise COMPONENTS variable depending on windows system type
end
item: Check Configuration
  Flags=10100000
end
item: Remark
  Text=Don't want to overwrite registry variable so if already defined leave variable
end
item: If/While Statement
  Variable=COMPONENTS
end
item: Set Variable
  Variable=COMPONENTS
  Value=B
  Flags=10000000
end
item: End Block
end
item: Else Statement
end
item: Remark
  Text=Cannot install server without NT
end
item: Set Variable
  Variable=COMPONENTS
  Value=A
  Flags=10000000
end
item: Remark
end
item: If/While Statement
  Variable=UNATTENDED
  Value=1
end
item: If/While Statement
  Variable=COMPONENTS
  Value=A
  Flags=00000010
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot install server on this version of Windows
end
item: Exit Installation
  Flags=12
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=SQL SETUP
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=Install batch script to collect instance names
end
item: Install File
  Source=V:\scripts\Instances.bat
  Destination=%MAINDIR%\Instances.bat
  Flags=0000000010100010
end
item: Remark
end
item: Remark
  Text=Some initial checks are required to determine the wizard flow relating to the SQL install
end
item: Find File in Path
  Variable=OSQL_PATH
  Pathname List=osql.exe
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=Location of OSQL.EXE is %OSQL_PATH% (Initial Checks)
end
item: If/While Statement
  Variable=OSQL_PATH
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=DETECT SQL SERVERS AVAILABLE TO INSTALL
end
item: Remark
  Text=====================================================================================
end
item: Set Variable
  Variable=SQL_NEEDED
  Value=1
end
item: Set Variable
  Variable=SQLEXPRESSNAME
end
item: Remark
end
item: Remark
  Text=Try SQL2014 first
end
item: Check if File/Dir Exists
  Pathname=%INST%\SQL2014
  Flags=01000101
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=SQL2014
end
item: Add Text to INSTALL.LOG
  Text=Folder SQL2014 found, so this will be installed.
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=Try SQL2012 next
end
item: Check if File/Dir Exists
  Pathname=%INST%\SQL2012
  Flags=01000101
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=SQL2012
end
item: Add Text to INSTALL.LOG
  Text=Folder SQL2012 found, so this will be installed.
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=Try SQL2008R2 next
end
item: Check if File/Dir Exists
  Pathname=%INST%\SQL2008R2
  Flags=01000101
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=SQL2008R2
end
item: Add Text to INSTALL.LOG
  Text=Folder SQL2008R2 found, so this will be installed.
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=Try SQL2005 next
end
item: Check if File/Dir Exists
  Pathname=%INST%\SQL2005
  Flags=01000101
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=SQL2005
end
item: Add Text to INSTALL.LOG
  Text=Folder SQL2005 found, so this will be installed.
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=Try MSDE finally
end
item: Check if File/Dir Exists
  Pathname=%INST%\MSDE2000
  Flags=01000101
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=MSDE2000
end
item: Add Text to INSTALL.LOG
  Text=Folder MSDE2000 found, so this will be installed.
end
item: Remark
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=ERROR: MSDE not found - cannot install server without SQL (Expected in %INST%\MSDE2000)
end
item: Set Variable
  Variable=SQLEXPRESSNAME
end
item: If/While Statement
  Variable=UNATTENDED
  Value=1
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00000010
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: End Block
end
item: Remark
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=If SQL2014 already detected, then no more additional checks.  Otherwise, check if we can use SQL Server 2016
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2014
  Flags=00000001
end
item: Remark
  Text=If SQL2016 available and 64bit and not Windows 7 then use it instead
end
item: Check if File/Dir Exists
  Pathname=%INST%\SQL2016
  Flags=01000101
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.2
  Flags=00000111
end
item: Set Variable
  Variable=SQLEXPRESSNAME
  Value=SQL2016
end
item: Add Text to INSTALL.LOG
  Text=Folder SQL2016 found, so this will be installed instead.
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=SQL server folders parsed,  SQL server to install=%SQLEXPRESSNAME%,  Architecture=%OS%,  Windows version=%WINDOWS_VERSION%    OS ver=%OPERATING_SYSTEM%
end
item: Remark
end
item: Remark
end
item: Set Variable
  Variable=SQLEXPRESSFULLNAME
  Value=%SQLEXPRESSNAME%
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=MSDE2000
  Flags=00000001
end
item: Set Variable
  Variable=SQLEXPRESSFULLNAME
  Value=%SQLEXPRESSNAME% Express
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=SQLEXPRESSNAME = %SQLEXPRESSNAME%
end
item: Remark
end
item: Remark
  Text=Check if the system needs WIndows updates before runing Enabler install
end
item: Remark
  Text=Windows 8.1 64 bit  & Windows Server 2012 require updates before SQL2016 installed
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.3
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2016
end
item: Add Text to INSTALL.LOG
  Text=Checking SQL2016 requirements for Windows 8.1 or Server 2012  64 bit
end
item: Execute Program
  Pathname=C:\WINDOWS\Sysnative\CMD.EXE
  Command Line=/C  wmic qfe get HotFixId | find "KB2919355"
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Set Variable
  Variable=KB_FIND1
  Value=%INSTALL_RESULT%
end
remarked item: Execute Program
  Pathname=C:\WINDOWS\Sysnative\CMD.EXE
  Command Line=/C  wmic qfe get HotFixId | find "KB2919442"
  Default Directory=%MAINDIR%
  Flags=00001010
end
remarked item: Set Variable
  Variable=KB_FIND2
  Value=%INSTALL_RESULT%
end
item: Add Text to INSTALL.LOG
  Text=Result of Windows update finds %KB_FIND1% 
end
item: If/While Statement
  Value=KB_FIND1=1 
  Flags=00001101
end
item: Display Message
  Title=Requirements for SQL2016 not met
  Text=Your system requires Windows updates before SQL 2016 can be installed. 
  Text=
  Text=Please run Windows Update and retry Enabler installation.
  Text=
  Text=
  Flags=00101000
end
item: Add Text to INSTALL.LOG
  Text=Windows 8.1 or Server 2012 requires system updates to install SQL2016 (KB2919355)
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text===========================================
end
item: Remark
  Text=OSQL has been found, SQL server already installed
end
item: Remark
  Text===========================================
end
item: Set Variable
  Variable=SQL_NEEDED
  Value=0
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Initialising Installer
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=If no instance has been passed by the command line
end
item: If/While Statement
  Variable=CMD_INSTANCE
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=GET LIST OF NAMED INSTANCES
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=Server SQL ettings
end
remarked item: Get Registry Key Value
  Variable=SQL_INSTANCES
  Key=SOFTWARE\Microsoft\Microsoft SQL Server
  Value Name=InstalledInstances
  Flags=00000100
end
remarked item: If/While Statement
  Variable=SQL_INSTANCES
  Flags=00000001
end
item: Get Temporary Filename
  Variable=INSTANCES
end
item: If/While Statement
  Value=OS=64 And OPERATING_SYSTEM >= 6
  Flags=00001101
end
item: Execute Program
  Pathname=C:\WINDOWS\Sysnative\CMD.EXE
  Command Line=/C %MAINDIR%\Instances.bat %TEMP%\%INSTANCES%
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\Instances.bat %TEMP%\%INSTANCES%
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=Unable to get SQL Instance Name registry key. %INSTALL_RESULT%
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=1
end
item: Else Statement
end
item: Set Variable
  Variable=LINE
end
item: Set Variable
  Variable=NAME
end
item: Set Variable
  Variable=SQL_INSTANCES
end
item: Read/Update Text File
  Variable=LINE
  Pathname=%TEMP%\%INSTANCES%
end
remarked item: If/While Statement
  Value=Instr(LINE,"!") Or Instr(Line,"\") Or Line=""
  Flags=00001101
end
remarked item: Else Statement
end
item: Parse String
  Source=%LINE%
  Pattern==
  Variable1=NAME
  Flags=00000001
end
item: If/While Statement
  Value=NAME="MSSQLSERVER" And INSTANCE_NAME_NEEDED=1
  Flags=00001101
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=0
end
item: ElseIf Statement
  Value=NAME="SQLEXPRESS" And NAME="MSSQLSERVER" And INSTANCE_NAME_NEEDED=1
  Flags=00001101
end
item: Set Variable
  Variable=SQL_INSTANCE
  Value=SQLEXPRESS
end
item: Set Variable
  Variable=SQLQUERY
  Value=%PC_NAME%\%SQL_INSTANCE%
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=0
end
item: End Block
end
item: Remark
  Text=Build list of instances names incase they need to be displayed
end
item: Set Variable
  Variable=SQL_INSTANCES
  Value=%NAME%%CRLF%
  Flags=00000001
end
remarked item: End Block
end
item: End Block
end
remarked item: End Block
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=SQL Instance Names found %CRLF%%SQL_INSTANCES%
end
item: Remark
end
item: Remark
  Text=Check if we found a known instance, if we haven't do we have a list of instances
end
item: If/While Statement
  Value=INSTANCE_NAME_NEEDED=1 And Len(RTrim$(SQL_INSTANCES)) > 0
  Flags=00001101
end
item: Remark
  Text=We have fouind instance names, if we haven't found a default one we need to display the list
end
item: Set Variable
  Variable=INSTANCE_NAME_LIST
  Value=1
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=Len(RTrim$(SQL_INSTANCES)) <= 0
  Flags=00001101
end
item: Add Text to INSTALL.LOG
  Text=No SQL Instance names found
end
item: End Block
end
item: Remark
end
item: Remark
  Text=If we found no avaliable instances
end
item: If/While Statement
  Value=INSTANCE_NAME_LIST <> 1 And INSTANCE_NAME_NEEDED = 1
  Flags=00001101
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=OSQL DETECT DEFAULT SQL NAMED INSTANCES
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=Execute the sql to get the verify the instance name of the default instance or the instance name passed by the command line
end
item: Add Text to INSTALL.LOG
  Text=Query database to check instance name %SQLQUERY%
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d master -E -S%SQLQUERY% -Q "select count(*) from sysobjects"
  Flags=00001010
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=%SQLQUERY% database instance does not exisit or the SQL server is not configured correctly the osql query failed
end
item: Remark
end
item: Remark
  Text=Try again with a different Instance name
end
item: Set Variable
  Variable=SQL_INSTANCE
  Value=SQLEXPRESS
end
item: Set Variable
  Variable=SQLQUERY
  Value=%PC_NAME%\%SQL_INSTANCE%
end
item: Add Text to INSTALL.LOG
  Text=Query database to check instance name %SQLQUERY%
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d master -E -S%SQLQUERY% -Q "select count(*) from sysobjects"
  Flags=00001010
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Set Variable
  Variable=SQL_INSTANCE
end
item: Add Text to INSTALL.LOG
  Text=%SQLQUERY% database instance does not exisit or the SQL server is not configured correctly the osql query failed
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=1
end
item: Else Statement
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=0
end
item: End Block
end
item: Else Statement
end
item: Set Variable
  Variable=INSTANCE_NAME_NEEDED
  Value=0
end
item: End Block
end
item: Remark
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=GET AVALIABLE SQL SERVERS FOR CLIENT INSTALL
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=Gets the avaliable SQL Servers. Although for this to work we would have to redistrubute SQLCMD
end
remarked item: Get Temporary Filename
  Variable=SERVERS
end
item: Remark
  Text=-L gives list of servers, c option gives a clean output
end
remarked item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-L c -o %TEMP%\%SERVERS%
  Flags=00001010
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
remarked item: Add Text to INSTALL.LOG
  Text=Unable to get list of SQL Servers
end
remarked item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Initialising Installer
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Check if the source media is located in a network drive
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Flags=00000001
end
item: If/While Statement
  Variable=INST_DRIVE
  Value=\\
end
item: Remark
  Text=If the installer is being run from a network location (UNC name) then we cannot install SQL2005
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Cannot install %SQLEXPRESSNAME% from UNC path
  Text=You are running this install from a network location (%INST%), without mapping a drive letter. This will prevent the %SQLEXPRESSNAME% from being installed.
  Text=
  Text=Please map the network share to a drive letter and run The Enabler Installation again.
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot install %SQLEXPRESSNAME% from UNC path
end
item: Exit Installation
  Flags=3
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=ARE WE RETURNING FROM A RESTART
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=See if we are restarting because of an MSDE or MSI Installer or .NET restart
end
item: Get Registry Key Value
  Variable=RESTART
  Key=SOFTWARE\ITL\Enabler
  Value Name=Restart
  Flags=00000100
end
item: Get Registry Key Value
  Variable=LAST_COMPONENTS
  Key=SOFTWARE\ITL\Enabler
  Value Name=InstallComponents
  Flags=00000100
end
item: If/While Statement
  Variable=RESTART
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=Restarting from previous installation reboot.
end
item: Set Variable
  Variable=PHASE2
  Value=1
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=True
  New Value=
  Value Name=Restart
  Root=194
end
item: Remark
  Text=Load the variables from the registry. Components, SDK and Applications do this already
end
item: Get Registry Key Value
  Variable=PRE_UPGRADE_BACKUP
  Key=SOFTWARE\ITL\Enabler
  Value Name=Backup
  Flags=00000100
end
item: Get Registry Key Value
  Variable=SA_PASSWORD
  Key=SOFTWARE\ITL\Enabler
  Value Name=SA
  Flags=00000100
end
item: Get Registry Key Value
  Variable=UNATTENDED
  Key=SOFTWARE\ITL\Enabler
  Value Name=UnattendedInstall
  Flags=00000100
end
item: Get Registry Key Value
  Variable=SQL_INSTANCE
  Key=SOFTWARE\ITL\Enabler
  Value Name=InstanceName
  Flags=00000100
end
item: ElseIf Statement
  Variable=LAST_COMPONENTS
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=Restarting from MSDE 2000 reboot.
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=COMPONENTS
  Value Name=InstallComponents
  Root=194
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=1
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Could not locate MSDE
  Text=A previous Enabler installation attempted to install MSDE, and after rebooting required MSDE files could not be located.
  Text=
  Text=Please try running the Enabler Installation again.
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR:Continuing a previous install - MSDE was not located
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: Set Variable
  Variable=PHASE2
  Value=1
end
item: Set Variable
  Variable=COMPONENTS
  Value=%LAST_COMPONENTS%
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=%APPTITLE% - Continuing Install
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=The MSDE Install has rebooted your Computer.
  Variable Value7=
  Variable Value7=%APPTITLE% components previously selected will now be installed.
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Continuing Install
end
item: Custom Script Item
  Filename=Pause.wse
  Variable Name1=_PAUSE_TIME_
  Variable Value1=5000
  Variable Name2=HELPFILE
  Variable Value2=C:\Program Files\Wise Installation System\Help\Wise.hlp
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=The SDK option is avaliable if the SDK folder is present
end
item: Check if File/Dir Exists
  Pathname=%INST%\SDK
  Flags=01000101
end
item: Set Variable
  Variable=SDK_APPS
  Value=1
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=====================================================================================
end
item: Remark
  Text=INSTALL WIZARD LOOP
end
item: Remark
  Text=====================================================================================
end
item: If/While Statement
  Value=PHASE2=0 And UNATTENDED=0
  Flags=00001101
end
item: Remark
  Text=The Wizard Loop contains the dialog screens that the user sees in the installation
end
item: Remark
  Text=If you would like to change the graphic on the dialog boxes, you need to change it by double-clicking on the Wizard Loop line and change the bitmap path.
end
item: Remark
  Text=NOTE: The wizard loop runs once per dialog that is displayed
end
item: Wizard Block
  Direction Variable=DIRECTION
  Display Variable=DISPLAY
  Bitmap Pathname=%_WISE_%\Dialogs\Template\TopImage.bmp
  X Position=0
  Y Position=0
  Filler Color=16777215
  Flags=00000001
end
remarked item: Add Text to INSTALL.LOG
  Text=Wizard Loop
end
remarked item: Add Text to INSTALL.LOG
  Text= SQL_NEEDED = %SQL_NEEDED%
end
remarked item: Add Text to INSTALL.LOG
  Text= SQLEXPRESSNAME = %SQLEXPRESSNAME%
end
remarked item: Add Text to INSTALL.LOG
  Text= INSTANCE_NAME_LIST = %INSTANCE_NAME_LIST%
end
remarked item: Add Text to INSTALL.LOG
  Text= INSTANCE_NAME_NEEDED= %INSTANCE_NAME_NEEDED%
end
remarked item: Add Text to INSTALL.LOG
  Text= COMPONENTS = %COMPONENTS%
end
remarked item: Add Text to INSTALL.LOG
  Text= CMD_INSTANCE = %CMD_INSTANCE%
end
item: Remark
end
item: Remark
  Text=If you need to change the size of your Custom Dialogs, you need only change the "Welcome" screen.  
end
item: Remark
  Text=It's size is the template for all following dialogs within the Wizard Loop.
end
item: Custom Dialog Set
  Name=Welcome
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE% 
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Push Button
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=10 5 241 39
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Welcome to %APPTITLE% Setup program. 
      Text=This program will install %APPTITLE% on your computer.
      Text French=Bienvenue sur le programme d'installation %APPTITLE%. Ce programme va installer %APPTITLE% sur votre ordinateur.
      Text German=Willkommen im Installationsprogramm für %APPTITLE%. Dieses Programm installiert  %APPTITLE% auf Ihrem Computer.
      Text Portuguese=Bem-vindo ao programa de configuração %APPTITLE%. Este programa instalará %APPTITLE% no seu computador
      Text Spanish=Bienvenido al programa de Configuración %APPTITLE%. Este programa instalará %APPTITLE en su ordenador
      Text Italian=Benvenuto nel programma di installazione di %APPTITLE%. Con questo programma puoi installare %APPTITLE% sul tuo computer.
      Text Danish=Velkommen til %APPTITLE% installationsprogrammet. Dette program installerer %APPTITLE% på computeren.
      Text Dutch=Welkom bij het %APPTITLE% installatieprogramma. Dit programma installeert %APPTITLE% op uw computer.
      Text Norwegian=Velkommen til %APPTITLE% Oppsett-program. Dette programmet vil installere %APPTITLE% på datamaskinen din.
      Text Swedish=Välkommen till installationsprogrammet för %APPTITLE%. Detta program installerar %APPTITLE% på din dator.
    end
    item: Static
      Rectangle=105 50 253 180
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=We recommend that you exit all Windows programs before running this Setup Program.
      Text=
      Text=Click Cancel to quit Setup and close any programs you have running.  Click Next to continue with the Setup program.
      Text=
      Text=WARNING: This program is protected by copyright law and international treaties.
      Text=
      Text=Unauthorized reproduction or distribution of this program, or any portion of it, may result in severe civil and criminal penalties, and will be prosecuted to the maximum extent possible under law.
      Text French=Il vous est fortement recommandé de fermer tous les programmes Windows avant d'exécuter le Programme d'Installation.
      Text French=
      Text French=Cliquez sur Annuler pour quitter l'Installation et fermez tous les programmes actuellement utilisés. Cliquez sur Suivant pour continuer l'installation.
      Text French=
      Text French=ATTENTION : Ce programme est protégé par la loi sur les droits d'exploitation et par les traités internationaux.
      Text French=
      Text French=Toute reproduction ou distribution, même partielle, de ce programme qui n'aura pas reçu d'autorisation préalable fera l'objet de poursuites et sera sévèrement sanctionnée par le droit civil et pénal.
      Text German=Wir empfehlen nachdrücklich, vor Ausführen dieses Installationsprogramms alle Windows-Programme zu beenden. 
      Text German=
      Text German=Auf Abbrechen klicken, um die Installation zu beenden und alle laufenden Programme zu schließen. Auf Weiter klicken, um mit dem Installationsprogramm zu beginnen.
      Text German=
      Text German=WARNUNG: Dieses Programm ist urheberrechtlich sowie durch internationale Verträge geschützt. 
      Text German=
      Text German=Die unzulässige Vervielfältigung oder Verbreitung dieses Programms, ob ganz oder auszugsweise, kann schwere zivil- und strafrechtliche Konsequenzen nach sich ziehen und wird unter voller Ausschöpfung der Rechtsmittel geahndet.
      Text Portuguese=Recomenda-se insistentemente que saia de todos os programas do Windows antes de executar este Programa de Configuração.
      Text Portuguese=
      Text Portuguese=Faça um clique sobre Cancelar para sair da Configuração e feche todos os programas que estiver a executar. Faça um clique sobre Próximo para continuar com o programa de configuração
      Text Portuguese=
      Text Portuguese=AVISO: Este programa está protegido pela lei de direitos do autor e tratados internacionais
      Text Portuguese=
      Text Portuguese=A reprodução e a distribuição sem autorização deste programa, ou qualquer parte dele, pode dar lugar à aplicação de severas sanções civis e criminais, e serão perseguidas à extensão máxima permitida pela lei.
      Text Spanish=Se recomienda encarecidamente que salga de todos los programas Windows antes de ejecutar este programa de Configuración.
      Text Spanish=
      Text Spanish=Haga un clic en Cancelar para abandonar la Configuración y cerrar cualquier programa que haya estado ejecutando. Haga un clic en Siguiente para continuar con el programa de Configuración.
      Text Spanish=
      Text Spanish=AVISO: Este programa está protegido por las leyes de derechos de autor y tratados internacionales.
      Text Spanish=
      Text Spanish=La reproducción o distribución no autorizadas de este programa, o cualquier parte de él, podría dar como resultado rigurosas multas civiles y penales, y se entablará la máxima acción judicial que permita la ley.
      Text Italian=Ti consigliamo di uscire da tutti i programmi Windows prima di eseguire questo programma di installazione.
      Text Italian=
      Text Italian=Fai clic su Annulla per uscire dal programma di installazione e chiudi tutti i programmi aperti. Fai clic su Avanti per continuare con il programma di Installazione.
      Text Italian=
      Text Italian=AVVERTENZA: Questo programma è protetto ai sensi delle norme di legge e delle convenzioni internazionali in materia di diritti di copyright.
      Text Italian=
      Text Italian=La riproduzione o la distribuzione totale o parziale non autorizzata di questo programma potrà essere soggetta a penalità civili e penali, e sarà punita con la massima severità possibile a norma di legge.
      Text Danish=Det anbefales kraftigt at afslutte alle Windows programmer, inden man kører dette installationsprogram.
      Text Danish=
      Text Danish=Klik på Annuller for at forlade installationsprogrammet og lukke alle igangværende programmer. Klik på Næste for at fortsætte med installationsprogrammet.
      Text Danish=
      Text Danish=ADVARSEL: Dette program er beskyttet af copyright og internationale traktater. 
      Text Danish=
      Text Danish=Uautoriseret gengivelse eller videresalg af dette program eller dele heraf kan føre til streng civil- og/eller kriminel stra. Retsforfølgning heraf vil finde sted i det videste omfang der hjemles muligt.
      Text Dutch=Het wordt aangeraden om alle Windows programma's af te sluiten voordat u met de installatie van dit programma begint.
      Text Dutch=
      Text Dutch=Klik op Annuleren om de installatie te verlaten en eventueel nog lopende programma's af te sluiten. Klik op Volgende om verder te gaan met het Installatieprogramma.
      Text Dutch=
      Text Dutch=WAARSCHUWING: dit computerprogramma is auteursrechtelijk beschermd.
      Text Dutch=
      Text Dutch=Onrechtmatige verveelvoudiging of distributie van dit programma of een gedeelte ervan is verboden en strafbaar en zal met alle beschikbare juridische middelen worden bestreden.
      Text Norwegian=Det anbefales på det sterkeste at du avslutter alle Windows-programmer før du kjører dette Oppsett-programmet.
      Text Norwegian=
      Text Norwegian=Velg Avbryt for å avbryte Oppsett og lukk alle programmer som er i bruk. Velg Neste for å fortsette med Oppsett-programmet.
      Text Norwegian=
      Text Norwegian=ADVARSEL: Dette programmet er beskyttet i henhold til lover om opphavsrett og internasjonale konvensjoner.
      Text Norwegian=
      Text Norwegian=Uautorisert kopiering eller distribuering av dette programmet eller deler av det, vil resultere i alvorlig sivil og kriminell straff og vil føre til saksmål i høyest mulig utstrekning i henhold til loven. 
      Text Swedish=Du tillråds bestämt att gå ur alla Windows-program innan du kör installationsprogrammet.
      Text Swedish=
      Text Swedish=Klicka på Avbryt för att gå ur installationsprogrammet och stäng eventuella program som du har laddade. Klicka på Nästa för att fortsätta med installationen.
      Text Swedish=
      Text Swedish=VARNING: Detta program är skyddat av upphovsrätten och internationella avtal.
      Text Swedish=
      Text Swedish=Om du utan tillstånd kopierar eller distribuerar detta program eller delar av det kan det bli allvarliga civilrättsliga och brottsrättliga straffpåföljder. Vi beivrar sådana överträdelser i den allra högsta utsträckning som lagen tillåter.
    end
    item: Static
      Control Name=LogoGeneric
      Rectangle=22 73 79 150
      Action=2
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000001011
      Pathname=v:\logo-generic.bmp
    end
    item: Static
      Rectangle=0 193 285 194
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Control Name=LogoITL
      Rectangle=10 49 93 140
      Action=2
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000001011
      Pathname=V:\logo-itl.bmp
    end
    item: Set Control Attribute
      Control Name=LogoITL
      Operation=2
    end
    item: Set Control Attribute
      Control Name=LogoGeneric
      Operation=2
    end
    item: If/While Statement
      Variable=LOGO_TYPE
      Value=ITL
    end
    item: Set Control Attribute
      Control Name=LogoITL
    end
    item: Else Statement
    end
    item: Set Control Attribute
      Control Name=LogoGeneric
    end
    item: End Block
    end
  end
end
item: Custom Dialog Set
  Name=Display ReadMe
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE%
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Push Button
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Slet
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Editbox
      Rectangle=10 50 275 182
      Help Context=16711681
      Create Flags=01010000101000000000100000000100
      Text=Enabler V%ENB_VERSION%
      Text=
      Text=1) If you are upgrading from an Enabler version prior to V3.4x, we suggest you remove the previous installation using Add/Remove Programs before installing this software.
      Text=
      Text=2) The installation will now automatically install the SQL Server Express Edition when installing on systems without an SQL Server installed.
      Text=
      Text=3) Check for newer pump drivers on our website http://www.integration.co.nz/
      Text=
      Text=4) Where possible we have documented known issues in the Release Notes document.
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Back
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=10 5 235 14
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=ReadMe File
      Text French=Fichier Lisez-moi
      Text German=Liesmich-Datei
      Text Portuguese=Ficheiro Leia-me
      Text Spanish=Archivo Léeme
      Text Italian=File Leggimi  
      Text Danish=Vigtigt fil
      Text Dutch=Leesmij-bestand
      Text Norwegian=Informasjonsfil
      Text Swedish=Läs mig-fil
    end
    item: Push Button
      Control Name=ViewReleaseNotesButton
      Rectangle=10 200 89 214
      Alternate=0%IEXPLORE_PATH%"file:%INST%\Release Notes.htm"
      Action=6
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000000
      Text=View Release Notes
    end
    item: Set Control Attribute
      Control Name=ViewReleaseNotesButton
      Operation=2
    end
    item: Check if File/Dir Exists
      Pathname=%IEXPLORE_PATH%
      Flags=00000100
    end
    item: If/While Statement
      Variable=IEXPLORE_VERSION
      Value=5
      Flags=00000111
    end
    item: If/While Statement
      Variable=HTML_RELEASE_NOTES
      Value=1
    end
    item: Set Control Attribute
      Control Name=ViewReleaseNotesButton
    end
    item: End Block
    end
    item: End Block
    end
    item: End Block
    end
  end
end
item: Remark
  Text=Select Server or Client install
end
item: Custom Dialog Set
  Name=Select Components
  Display Variable=DISPLAY
  Flags=00000001
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE%
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Push Button
      Control Name=NextButton
      Rectangle=183 200 225 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=141 200 183 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=234 200 276 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=11 50 80 182
      Destination Dialog=4
      Create Flags=01010000000000000000000000000000
      Text=Select the type of install you would like from the radio buttons.  SDK is optional.
      Text French=Dans la liste d'options suivante, veuillez sélectionner les cases des options que vous désirez installer. Le champ d'espace disque indique les conditions requises pour les options choisies
      Text German=Wählen Sie in der Optionenliste unten die Kontrollkästchen für diejenigen Optionen, die Sie installieren möchten. Die Speicherfelder zeigen die benötigte Speicherkapazität für die gewählten Optionen an.
      Text Portuguese=Na lista de opções abaixo, seleccione as caixas de verificação para as opções que gostaria de ter instalado. Os campos de espaço de disco reflectem os requerimentos das opções que seleccionou.
      Text Spanish=En la lista de opciones que se ofrece a continuación, seleccione las casillas de comprobación para las opciones que desea instalar. Los campos del espacio en el disco reflejan los requerimientos de las opciones que ha seleccionado.
      Text Italian=Nellelenco delle opzioni sotto, marca le caselle di controllo delle opzioni che vuoi installare. I campi dello spazio sul disco riflettono i requisiti delle opzioni selezionate.
      Text Danish=Marker afkrydsningsfelterne for de komponenter, der skal installeres, på listen herunder. Diskpladsfelterne angiver pladskravene for de valgte komponenter.
      Text Dutch=Kruis in de onderstaande lijst het vakje aan naast de opties die u wilt installeren. Achter elke optie staat de benodigde schijfruimte vermeld.
      Text Norwegian=I listen over alternativer nedenfor, klikk i kontrollrutene for de alternativene du ønsker å installere. Diskplassfeltene gjenspeiler kravene for de alternativene du har valgt.
      Text Swedish=Kryssa för i rutorna nedan vilka alternativ du vill få installerade. I diskutrymmesfälten anges utrymmesbehoven för de alternativ du väljer.
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=10 5 235 20
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Select Installation Type
      Text French=Sélectionner les éléments
      Text German=Komponenten auswählen
      Text Portuguese=Seleccionar Componentes
      Text Spanish=Seleccione los Componentes
      Text Italian=Seleziona Componenti
      Text Danish=Vælg komponenter
      Text Dutch=Selecteer onderdelen
      Text Norwegian=Velg komponenter
      Text Swedish=Välj komponenter
    end
    item: Static
      Rectangle=89 44 271 173
      Action=1
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000111
    end
    item: Radio Button
      Rectangle=94 36 235 124
      Variable=COMPONENTS
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000001001
      Text=Client Install
      Text=Server Install (Computer with Enabler card)
      Text=
    end
    item: Static
      Rectangle=99 66 267 98
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Install the Enabler Client components to connect to an Enabler Server: Enabler Server Desktop or Enabler Embedded.
    end
    item: Static
      Rectangle=99 109 267 141
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Install the Enabler Server Desktop - Enabler Card REQUIRED. SQL Server will be installed if none found.
    end
    item: Checkbox
      Control Name=SDK_Check
      Rectangle=94 129 154 146
      Variable=SDK
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=SDK Add-ons
      Text=
      Text French=Component A
      Text French=Component B
      Text French=
      Text German=Component A
      Text German=Component B
      Text German=
      Text Spanish=Component A
      Text Spanish=Component B
      Text Spanish=
      Text Italian=Component A
      Text Italian=Component B
      Text Italian=
    end
    item: Static
      Control Name=SDK_Check_Text
      Rectangle=99 145 267 177
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Install the Enabler SDK Documents, Tools (MPPSim, PumpDemo, etc). If UNTICKED, previous SDK will be removed.
    end
    item: Set Variable
      Variable=CHECKED
      Value=A
    end
    item: If/While Statement
      Variable=SDK_APPS
      Value=1
    end
    item: Set Control Attribute
      Control Name=SDK_Check
    end
    item: Set Control Attribute
      Control Name=SDK_Check_Text
    end
    item: Else Statement
    end
    item: Set Control Attribute
      Control Name=SDK_Check
      Operation=2
    end
    item: Set Control Attribute
      Control Name=SDK_Check_Text
      Operation=2
    end
    item: End Block
    end
    item: If/While Statement
      Variable=DLG_EVENT_TYPE
      Value=VERIFY
    end
    item: If/While Statement
      Variable=APPLICATIONS
    end
    item: Remark
      Text=Set default applications
    end
    item: If/While Statement
      Variable=COMPONENTS
      Value=A
      Flags=00001010
    end
    item: Set Variable
      Variable=APPLICATIONS
      Value=B
    end
    item: Else Statement
    end
    item: Set Variable
      Variable=APPLICATIONS
      Value=ABCDE
    end
    item: End Block
    end
    item: End Block
    end
    item: End Block
    end
  end
end
item: Remark
end
item: Remark
  Text=!!! ACHTUNG! NOTE! WARNING! I have reverted to using IF statements here because the wizard loop conditions seem to be broken on Chinese Editions of Windows !!!
end
item: If/While Statement
  Value=NOT( Instr(COMPONENTS,"A") Or SQL_NEEDED=1 Or INSTANCE_NAME_NEEDED=1)
  Flags=00001101
end
item: Custom Dialog Set
  Name=SQL Server Already Installed
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 238 38
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Use the Microsoft SQL Server already installed?
    end
    item: Static
      Rectangle=13 50 263 134
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Click 'Next' to install %APPTITLE% using your existing Microsoft SQL Database Server.
      Text=
      Text=You have selected an installation including %APPTITLE% Server, which requires an SQL Database.
      Text=
      Text=Click 'Cancel' if you do not want %APPTITLE% to use this Database Server. In this case you need to exit the install and remove the existing Database Server. After this the %APPTITLE% setup will install a new SQL Server for you.
      Text=
      Text=The Microsoft SQL Server was found in:
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=16 135 268 159
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Terminal
      Font Style=-12 0 0 0 400 0 0 0 255 1 2 1 49
      Text=%OSQL_PATH%
    end
  end
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=NOT( Instr(COMPONENTS,"A") Or SQL_NEEDED=1 Or INSTANCE_NAME_NEEDED=0 Or INSTANCE_NAME_LIST=0 )
  Flags=00001101
end
item: Custom Dialog Set
  Name=SQL Named Instance list
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 238 38
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Select an SQL instance name to install on
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=10 42 70 53
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=SQL Instance Name:
    end
    item: Listbox
      Rectangle=10 55 277 180
      Variable=SQL_INSTANCE
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000101000010001000101000001
      Flags=0000010000000000
      Text=%SQL_INSTANCES%
      Text=
    end
  end
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=NOT( Instr(COMPONENTS,"A") Or SQL_NEEDED=1 Or INSTANCE_NAME_NEEDED=0 Or INSTANCE_NAME_LIST=1)
  Flags=00001101
end
item: Custom Dialog Set
  Name=SQL Named Instance needed
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 238 38
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Enter the SQL instance name
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=11 94 71 105
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=SQL Instance Name:
    end
    item: Editbox
      Rectangle=71 90 270 105
      Variable=SQL_INSTANCE
      Help Context=16711680
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000000000
      Text=%SQL_INSTANCE%
    end
    item: Static
      Rectangle=70 68 212 83
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Enter the SQL instance name to install Enabler on.
    end
  end
end
item: End Block
end
item: Remark
end
item: Remark
  Text=This screen is used if there is no SQL Server, and none available to the installer
end
item: If/While Statement
  Value=Instr(COMPONENTS,"B") AND SQL_NEEDED=1 AND Len(SQLEXPRESSNAME) < 1
  Flags=00001101
end
item: Add Text to INSTALL.LOG
  Text=Cannot continue MSDE2000, SQL2005, SQL2008R2, SQL2012, SQL2014 or SQL2016 installation folder not found
end
item: Custom Dialog Set
  Name=Cannot Continue
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 224 38
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=The installer cannot continue - Contact Support
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=20 50 260 176
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Installation of The Enabler Server requires a Microsoft SQL Database to install, but 
      Text=
      Text=Cannot find an existing SQL Server installation
      Text=
      Text=    AND
      Text=
      Text=Cannot find the files required to install the default database. The database install files should be in a folder located in:
      Text=         %INST% 
      Text=
      Text=If you want to install the Enabler Client files, go back and uncheck the Server Files in the Select Components page.
    end
  end
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=Instr(COMPONENTS,"B") AND SQL_NEEDED=1 AND Len(SQLEXPRESSNAME) > 1
  Flags=00001101
end
item: Add Text to INSTALL.LOG
  Text=Install Default %SQLEXPRESSFULLNAME% Server
end
item: Custom Dialog Set
  Name=Install Default SQL Server
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 224 40
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=No Microsoft SQL Server is Installed. 
      Text=Install the Default SQL Server (%SQLEXPRESSFULLNAME%)? 
    end
    item: Static
      Rectangle=20 50 260 129
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Your install selection of %APPTITLE% Server, requires an SQL Database.
      Text=
      Text=If you continue, the Default SQL Server (%SQLEXPRESSFULLNAME%) will be installed before installing %APPTITLE% software.  
      Text=
      Text=
      Text=If you do not want %APPTITLE% to use the %SQLEXPRESSFULLNAME% Database Server, you MUST exit now and and install the Microsoft Database Server before re-running this setup.
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Control Name=RebootWarning
      Rectangle=31 137 241 180
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=In order to complete the install of this database a Reboot of Windows  may be required. The install should continue automatically after Windows restarts; if it does not you need to re-run the Enabler Install program.
    end
    item: If/While Statement
      Variable=SQLEXPRESSNAME
      Value=SQL2008R2
    end
    item: Set Control Attribute
      Control Name=RebootWarning
    end
    item: Else Statement
    end
    item: Set Control Attribute
      Control Name=RebootWarning
      Operation=2
    end
    item: End Block
    end
  end
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Get the SQL SA Password.
end
item: If/While Statement
  Value=NOT( Instr(COMPONENTS,"A") Or SQL_NEEDED=0 Or SQLEXPRESSNAME="MSDE2000" )
  Flags=00001101
end
item: Custom Dialog Set
  Name=SA Password Required
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 4 220 39
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=To install the SQL Server %SQLEXPRESSFULLNAME%, SA password is required.  Please choose a strong password and keep it for future reference.
    end
    item: Push Button
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Editbox
      Rectangle=93 56 144 69
      Variable=PASSWORD_1
      Help Context=16711681
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000100000
    end
    item: Static
      Rectangle=21 58 89 73
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=SA Password
    end
    item: Editbox
      Rectangle=93 79 144 92
      Variable=PASSWORD_2
      Help Context=16711681
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000100000
    end
    item: Static
      Rectangle=21 80 89 95
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=Please re-enter
    end
    item: If/While Statement
      Variable=DLG_EVENT_TYPE
      Value=VERIFY
    end
    item: If/While Statement
      Variable=PASSWORD_1
      Value=%PASSWORD_2%
      Flags=00000001
    end
    item: Display Message
      Title=Passwords mismatch
      Text=Please re-enter the passwords.
      Flags=00100000
    end
    item: Set Variable
      Variable=DLG_EVENT_TYPE
    end
    item: Else Statement
    end
    item: Set Variable
      Variable=SA_PASSWORD
      Value=%PASSWORD_1%
    end
    item: End Block
    end
    item: End Block
    end
  end
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=Instr(COMPONENTS,"B")
  Flags=00001101
end
item: Remark
  Text=Confirm EnbWeb settings
end
item: Custom Dialog Set
  Name=Confirm Web Port and Domain
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 8 220 39
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Confirm the Network Port and Domain for the Enabler Web Server.
    end
    item: Push Button
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Editbox
      Rectangle=78 56 129 69
      Variable=ENBWEB_PORT
      Help Context=16711681
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000000000
      Text=%ENBWEB_PORT%
    end
    item: Static
      Rectangle=6 58 74 73
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=Port
    end
    item: Editbox
      Rectangle=78 79 129 92
      Variable=ENBWEB_DOMAIN
      Help Context=16711681
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000000000
      Text=%ENBWEB_DOMAIN%
    end
    item: Static
      Rectangle=6 80 74 95
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=Network domain
    end
    item: Static
      Rectangle=136 60 210 74
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=(default is 8081)
    end
    item: Static
      Rectangle=136 78 278 93
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=(Use your local network domain if you have one)
    end
    item: Static
      Rectangle=34 101 244 170
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Depending on your network and firewall configuration, you may need to change the Port number here to ensure Enabler Web Server uses an available port.
      Text=
      Text=NOTE: Refer to the install instructions for information about firewall configuration.
    end
    item: If/While Statement
      Variable=DLG_EVENT_TYPE
      Value=VERIFY
    end
    item: End Block
    end
  end
end
item: Else Statement
end
item: Remark
  Text=This is a client install...
end
item: Custom Dialog Set
  Name=Enter Enabler Server Name
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 230 32
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Enter the Name or IP Address of the Enabler Server System
    end
    item: Static
      Rectangle=20 50 260 111
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=The Enabler Client you are installing will access an Enabler Server (Enabler Server Desktop or Enabler Embedded) during operation.
      Text=
      Text=Please enter the name or IP address of the Enabler Server System this Client should connect to. 
      Text=
      Text=Tick Embedded if the Enabler Server is an Enabler Embedded system.
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Editbox
      Rectangle=97 116 181 131
      Variable=SERVER_NAME
      Help Context=1966080
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000001000
      Text=%SERVER_NAME%
    end
    item: Static
      Rectangle=26 119 93 133
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=Enabler Server Name
    end
    item: Static
      Rectangle=21 145 248 168
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=This can be left blank. But refer to the Enabler documentation on how to change the Enabler Server System Name or IP Address setting later.
    end
    item: Checkbox
      Control Name=CLIENTEMBEDDED_Check
      Rectangle=198 116 246 130
      Variable=CLIENTEMBEDDED
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=Embedded
      Text=
    end
  end
  item: Dialog
    Title=Select SQL Server Computer Name
    Width=153
    Height=156
    Font Name=Helv
    Font Size=8
    item: Push Button
      Rectangle=64 120 99 135
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=Cancel
    end
    item: Push Button
      Control Name=OKBUTTON
      Rectangle=107 120 142 135
      Variable=OKBUTTON
      Value=1
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000000
      Text=OK
    end
    item: Listbox
      Rectangle=5 5 142 113
      Variable=SERVER_NAME_SAVE
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000101000010001000101000001
      Flags=0000010000000000
      Text=%SERVERS%
      Text=
    end
    item: If/While Statement
      Variable=OKBUTTON
      Value=1
    end
    item: Set Variable
      Variable=SERVER_NAME
      Value=%SERVER_NAME_SAVE%
    end
    item: Set Variable
      Variable=OKBUTTON
    end
    item: End Block
    end
  end
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Value=Instr(COMPONENTS,"A") Or CMD_INSTANCE=1
  Flags=00001101
end
item: Remark
  Text=Client Install to Enabler Desktop (NOT Embedded)
end
item: If/While Statement
  Variable=CLIENTEMBEDDED
  Value=A
  Flags=00000011
end
item: Custom Dialog Set
  Name=Enter Instance Name
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Static
      Control Name=Prompt
      Rectangle=10 5 230 32
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Enabler Server SQL Instance Name
    end
    item: Static
      Rectangle=20 50 260 74
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=For Enabler installations using a non-default SQL Server instance name, please enter the Instance Name below, otherwise leave the field blank and select Next. 
    end
    item: Push Button
      Control Name=Next
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Next >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Flags=0000000000000001
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Editbox
      Control Name=Instance_Name
      Rectangle=88 91 172 106
      Variable=CLIENT_SQL_INSTANCE
      Help Context=1966080
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000100000010000000000001000
      Text= 
    end
    item: Static
      Rectangle=14 94 81 108
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000010
      Text=Instance Name
    end
    item: If/While Statement
      Variable=DLG_EVENT_TYPE
      Value=INIT
    end
    item: If/While Statement
      Value=CMD_INSTANCE=0
      Flags=00001101
    end
    item: Set Control Text
      Control Name=Instance_Name
    end
    item: Else Statement
    end
    item: Set Variable
      Variable=CLIENT_SQL_INSTANCE
      Value=%SQL_INSTANCE%
    end
    item: Set Control Text
      Control Name=Instance_Name
      Control Text=%CLIENT_SQL_INSTANCE%
    end
    item: End Block
    end
    item: End Block
    end
  end
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Custom Dialog Set
  Name=Start Installation
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE% V%ENB_VERSION%
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE%
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    item: Push Button
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Install >
      Text French=&Suivant>
      Text German=&Weiter>
      Text Portuguese=&Próximo>
      Text Spanish=&Siguiente >
      Text Italian=&Avanti >
      Text Danish=&Næste>
      Text Dutch=&Volgende>
      Text Norwegian=&Neste>
      Text Swedish=&Nästa >
    end
    item: Push Button
      Control Name=BACK_BUTTON
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Push Button
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=71 191 286 192
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=20 49 260 114
      Destination Dialog=4
      Create Flags=01010000000000000000000000000000
      Text=You are now ready to install %APPTITLE%%SQLTITLE%.
      Text=
      Text=Click the Install button to begin the installation or the Back button to change your installation options.
      Text=
      Text=If you have an existing Enabler installation you can select the database backup check box below to back up Enabler as part of the Installation
      Text French=Vous êtes maintenant prêt à installer %APPTITLE%.
      Text French=
      Text French=Cliquez sur Suivant pour commencer l'installation ou Retour pour entrer à nouveau les informations d'installation.
      Text German=Sie sind jetzt zur Installation von %APPTITLE% bereit.
      Text German=
      Text German=Auf die Schaltfläche Weiter klicken, um mit dem Start der Installation zu beginnen, oder auf die Schaltfläche Zurück, um die Installationsinformationen nochmals aufzurufen.
      Text Portuguese=Está agora pronto para instalar %APPTITLE%
      Text Portuguese=
      Text Portuguese=Pressione o botão Próximo para começar a instalação ou o botão Retornar para introduzir novamente a informação sobre a instalação
      Text Spanish=Ahora estará listo para instalar %APPTITLE%.
      Text Spanish=
      Text Spanish=Pulse el botón de Siguiente para comenzar la instalación o el botón Retroceder para volver a introducir la información sobre la instalación.
      Text Italian=Sei pronto ad installare %APPTITLE%.
      Text Italian=
      Text Italian=Premi il tasto Avanti per iniziare linstallazione o il tasto Indietro per rientrare nuovamente nei dati sullinstallazione
      Text Danish=Du er nu klar til at installere %APPTITLE%.
      Text Danish=
      Text Danish=Klik på Næste for at starte installationen eller på Tilbage for at ændre installationsoplysningerne.
      Text Dutch=U bent nu klaar om %APPTITLE% te installeren.
      Text Dutch=
      Text Dutch=Druk op Volgende om met de installatie te beginnen of op Terug om de installatie-informatie opnieuw in te voeren.
      Text Norwegian=Du er nå klar til å installere %APPTITLE%
      Text Norwegian=
      Text Norwegian=Trykk på Neste-tasten for å starte installeringen, eller Tilbake-tasten for å taste inn installasjonsinformasjonen på nytt.
      Text Swedish=Du är nu redo att installera %APPTITLE%.
      Text Swedish=
      Text Swedish=Tryck på Nästa för att starta installationen eller på Tillbaka för att skriva in installationsinformationen på nytt.
    end
    item: Static
      Rectangle=0 187 71 195
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Wise Installation Wizard®
    end
    item: Static
      Rectangle=10 5 235 14
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=Start Installation
      Text French=Commencer l'installation
      Text German=Installation beginnen
      Text Portuguese=Iniciar Instalação
      Text Spanish=Comenzar la Instalación
      Text Italian=Avvia Installazione
      Text Danish=Start installationen
      Text Dutch=Start de installatie
      Text Norwegian=Start installeringen
      Text Swedish=Starta installationen
    end
    item: Static
      Rectangle=0 0 285 39
      Action=2
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000001011
      Pathname=%_WISE_%\Dialogs\Template\TopImage.bmp
    end
    item: Checkbox
      Control Name=PreUpgradeBackupCheckBox
      Rectangle=20 158 145 174
      Variable=PRE_UPGRADE_BACKUP
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=Backup Database Before Upgrade
      Text=
    end
    item: If/While Statement
      Variable=SQL_NEEDED
      Value=1
    end
    item: If/While Statement
      Variable=COMPONENTS
      Value=B
      Flags=00001010
    end
    item: If/While Statement
      Variable=SQLEXPRESSNAME
      Value=SQL2005
    end
    item: Set Variable
      Variable=SQLTITLE
      Value= and the SQL Server 2005 Express
    end
    item: End Block
    end
    item: If/While Statement
      Variable=SQLEXPRESSNAME
      Value=SQL2008R2
    end
    item: Set Variable
      Variable=SQLTITLE
      Value= and SQL Server 2008 Express
    end
    item: End Block
    end
    item: End Block
    end
    item: Else Statement
    end
    item: End Block
    end
    item: If/While Statement
      Value=Instr(COMPONENTS,"B") And PRE_BACKUP=1
      Flags=00001101
    end
    item: Set Control Attribute
      Control Name=PreUpgradeBackupCheckBox
    end
    item: Else Statement
    end
    item: Set Control Attribute
      Control Name=PreUpgradeBackupCheckBox
      Operation=2
    end
    item: End Block
    end
  end
end
item: Remark
end
item: Remark
  Text=Wizard loop end
end
item: End Block
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Unattended (%UNATTENDED%) Install or reboot from previous installation Phase2 (%PHASE2%)
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=========================================
end
item: Remark
  Text=Get File system value
end
item: Remark
  Text=========================================
end
item: Remark
end
item: Get Registry Key Value
  Variable=FILE_SYSTEM
  Key=SYSTEM\CurrentControlSet\Control\FileSystem\
  Value Name=NtfsDisable8dot3NameCreation
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=File system is %FILE_SYSTEM%
end
item: If/While Statement
  Variable=FILE_SYSTEM
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=ERROR: 8dot3 name creation is disabled on all volumes on the system
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Installation Failed. Error Code: 25
  Text=Windows file system has 8.3 file name creation disabled.
  Text=
  Text=Please refer to the Installation Instructions and re-run the Enabler Installer again.
  Flags=00010000
end
item: End Block
end
item: Exit Installation
  Flags=25
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=CHECK DISK SPACE REQUIREMENTS
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Hardcoded to 800MB plus the COMPONENTS. 800MB is to cover space for - Applications, SDK doc, SDK app, SQL Server, MIS, .NET
end
item: Remark
  Text=SQL 2016 - 1480MB for enginel
end
item: Remark
  Text=SQL 2008/2012/2014 - 820MB for engine 3.8GB for complete install
end
item: Remark
  Text=SQL 2005 - 280MB for engine, 2.0GB for complete install
end
item: Remark
  Text=SQL 2000 - 270MB (obsolete)
end
item: Remark
  Text=MPPSim - 192KB
end
item: Remark
  Text=Pumpdemo - 200KB
end
item: Remark
  Text=.NET 3.5 - 30MB
end
item: Remark
  Text=MSI 4.5 - 3MB - based on installer size
end
item: Remark
  Text=SDK Docs - 2.08MB
end
item: Remark
  Text=Sample Apps - 8.55MB
end
item: Remark
  Text=Documentation - 5.2MB
end
item: Remark
end
item: Get System Information
  Variable=DISK_SPACE
  Pathname=%MAINDIR%
  Flags=00010101
end
item: If/While Statement
  Variable=DISK_SPACE
  Value=1480000
  Flags=00001000
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Installation failed
  Text=There is not enough free disk space to install Enabler on this system
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Not enough free disk space
end
item: Exit Installation
  Flags=20
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SAVE CONFIGURATION SETTINGS INCASE OF REBOOT
end
item: Remark
  Text===========================================
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=9
  item: Key
    Key=Software\ITL\Enabler
    New Value=%COMPONENTS%
    New Value=
    Value Name=Components
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%APPLICATIONS%
    New Value=
    Value Name=Applications
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SA_PASSWORD%
    New Value=
    Value Name=SA
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%PRE_UPGRADE_BACKUP%
    New Value=
    Value Name=Backup
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SDK%
    New Value=
    Value Name=SDK
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%UNATTENDED%
    New Value=
    Value Name=UnattendedInstall
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%ENBWEB_PORT%
    Value Name=EnbWebPort
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%ENBWEB_DOMAIN%
    Value Name=EnbWebDomain
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SQL_INSTANCE%
    Value Name=InstanceName
    Root=2
  end
end
item: Open/Close INSTALL.LOG
end
item: Remark
end
item: Remark
end
item: Remark
  Text=Set Client install varaible
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Server was chosen
end
item: Remark
  Text=Checking to see if the C: drive is compressed. SQL server doesn't like the EnablerDB files in a compressed location
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=5.1
  Flags=00000111
end
item: Install File
  Source=V:\bin\DriveCompressed.exe
  Destination=%MAINDIR%\bin\DriveCompressed.exe
  Flags=0000000010100010
end
item: If/While Statement
  Value=OS=64 And OPERATING_SYSTEM >= 6
  Flags=00001101
end
item: Execute Program
  Pathname=C:\WINDOWS\Sysnative\CMD.EXE
  Command Line=/C %MAINDIR%\bin\DriveCompressed.exe
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\bin\DriveCompressed.exe
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: End Block
end
item: Remark
  Text=A 0 means it is not compressed, 1 is compressed, -1 is an error occured during the application
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000110
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=C: drive compressed
  Text=C: drive is configured to be compressed.
  Text=The SQL database does not allow the Enabler database files to be installed to a compressed folder
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=C: drive is compressed, which is not supported
end
item: Exit Installation
  Flags=21
end
item: ElseIf Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00001000
end
item: Add Text to INSTALL.LOG
  Text=Error running DriveCompressed utility, continuing install
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=C: drive is not compressed
end
item: End Block
end
item: End Block
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Client was chosen
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=MSI4.5 Install
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=0
  Flags=00000001
end
item: Remark
  Text=Check the version of MSI installed - .NET3.5 requires 4.5
end
item: Get System Information
  Variable=MSI_VERSION
  Pathname=%SYS32%\MSI.DLL
  Flags=00000101
end
item: If/While Statement
  Variable=MSI_VERSION
  Value=4.5
  Flags=00001000
end
item: Add Text to INSTALL.LOG
  Text=SQL2008R2 requires MSI 4.5 and .NET 3.5 SP1 - MSI will be installed and will require a reboot.
end
item: Remark
  Text=Check if we need to install the latest MSI 4.5 Installer 
end
item: Remark
end
item: Check if File/Dir Exists
  Pathname=%INST%\Win\MSI\4.5\WindowsXP-KB942288-v3-x86.exe
  Flags=00000101
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=MSI 4.5 Installer Failed
  Text=Missing %INST_DRIVE%\Win\MSI\4.5\WindowsXP-KB942288-v3-x86.exe
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Missing MSI 4.5 Installer
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing MSI 4.5 Installer
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Installing MSI 4.5
end
item: Remark
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=5.1
end
item: Remark
  Text=NOTE: 5.1 = Windows XP
end
item: If/While Statement
  Variable=OS
  Value=32
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\WindowsXP-KB942288-v3-x86.exe"" /quiet /passive /norestart 
  Flags=00001010
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\WindowsServer2003-KB942288-v4-x64.exe"" /quiet /passive /norestart 
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=5.2
end
item: Remark
  Text=NOTE: 5.2 = Windows 2003
end
item: If/While Statement
  Variable=OS
  Value=32
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\WindowsServer2003-KB942288-v4-x86.exe"" /quiet /passive /norestart 
  Flags=00001010
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\WindowsServer2003-KB942288-v4-x64.exe"" /quiet /passive /norestart 
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.0
end
item: Remark
  Text=NOTE: 6.0 = Windows Vista or Windows Server 2008
end
item: Remark
  Text=NOTE: msu files do not support the /passive switch
end
item: If/While Statement
  Variable=OS
  Value=32
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\Windows6.0-KB942288-v2-x86.msu"" /quiet /norestart
  Flags=00001010
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\4.5\Windows6.0-KB942288-v2-x64.msu"" /quiet /norestart
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.1
  Flags=00000111
end
item: Remark
  Text=NOTE: 6.1 = Windows 7 and Windows 2008 R2
end
item: Add Text to INSTALL.LOG
  Text=Found either Windows 7, Windows Server 2008 or Later Windows - so don't need a newer version of MSI installed
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
end
item: Add Text to INSTALL.LOG
  Text=Could not determine OS current version, so that we can install the correct edition of MSI 4.5
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Exiting
  Text=Could not determine OS current version, so that we can install the correct edition of MSI 4.5
  Flags=00100100
end
item: End Block
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=MSI 4.5 Already Installed
end
item: Else Statement
end
item: Remark
  Text=3010 means Reboot is required. Set Runonce to Enabler Installer
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Rebooting
  Text=Windows MSI 4.5 Installer has completed, and your computer should now reboot automatically.
  Flags=00100100
end
item: End Block
end
item: Remark
  Text=Add Registry Keys before rebooting
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=True
  New Value=
  Value Name=Restart
  Root=2
end
item: Remark
  Text=Stop adding this entry to the Log file. This stops this being doing on uninstall.
end
item: Remark
  Text=If the RunOnce key is deleted on uninstall and then Enabler is reinstalled the driver will fail its install
end
item: Remark
  Text=As windows requires the runonce key to be present to install drivers
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value="%INST%\Enabler4Setup.exe"
  New Value=
  Value Name=Enabler Install
  Root=2
end
item: Open/Close INSTALL.LOG
end
item: Add Text to INSTALL.LOG
  Text=MSI 4.5 installed - reboot pending
end
item: Custom Script Item
  Filename=Reboot System.wse
  Variable Name1=HELPFILE
  Variable Value1=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name2=_REBOOT_TYPE_
  Variable Value2=B
end
item: Exit Installation
  Flags=6
end
item: End Block
end
item: Remark
  Text=1603 means Windows OS platform is not supported.
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=1603
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=MSI 4.5 Installer Failed
  Text=Windows OS %WINDOWS_VERSION% Platform NOT supported.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=MSI 4.5 Installation Failed - Windows OS Platform not supported.
end
item: Exit Installation
  Flags=12
end
item: Else Statement
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=MSI 4.5 Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=MSI 4.5 Installion Failed
end
item: End Block
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=The version of MSI is OK - %MSI_VERSION%
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=.NET 3.5 SP1
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Check the version of .NET installed
end
item: Get Registry Key Value
  Variable=NET2_0_INSTALLED
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727
  Default=0
  Value Name=Install
  Flags=00000100
end
item: Get Registry Key Value
  Variable=NET3_0_INSTALLED
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.0
  Default=0
  Value Name=Install
  Flags=00000100
end
item: Get Registry Key Value
  Variable=NET3_5_INSTALLED
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5
  Default=0
  Value Name=Install
  Flags=00000100
end
item: Get Registry Key Value
  Variable=NET4_INSTALLED
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full
  Default=0
  Value Name=Install
  Flags=00000100
end
item: Get Registry Key Value
  Variable=NET4_6_INSTALLED
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v4.6\Full
  Default=0
  Value Name=Install
  Flags=00000100
end
item: Remark
end
item: Set Variable
  Variable=DOTNET_VERSION
  Value=0
end
item: Set Variable
  Variable=DOTNET350_SP
  Value=0
end
item: Remark
end
item: If/While Statement
  Variable=NET3_5_INSTALLED
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=Found .NET v3.5 runtime
end
item: Set Variable
  Variable=DOTNET_VERSION
  Value=350
end
item: Get Registry Key Value
  Variable=DOTNET350_SP
  Key=SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5\
  Default=0
  Value Name=SP
  Flags=00000100
end
item: ElseIf Statement
  Variable=NET3_0_INSTALLED
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=Found .NET v3.0 runtime
end
item: Set Variable
  Variable=DOTNET_VERSION
  Value=300
end
item: ElseIf Statement
  Variable=NET2_0_INSTALLED
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=Found .NET v2.0 runtime
end
item: Set Variable
  Variable=DOTNET_VERSION
  Value=200
end
item: End Block
end
item: Remark
end
item: Remark
  Text=We actually require .NET 3.5 SP 1 to run (see EP-1146)
end
item: Set Variable
  Variable=DOTNET_RUNTIME_REQUIRED
  Value=0
end
item: If/While Statement
  Variable=DOTNET_VERSION
  Value=350
  Flags=00001000
end
item: Set Variable
  Variable=DOTNET_RUNTIME_REQUIRED
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=DOTNET350_SP
  Value=0
end
item: Set Variable
  Variable=DOTNET_RUNTIME_REQUIRED
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=DOTNET_RUNTIME_REQUIRED
  Value=1
end
item: Check if File/Dir Exists
  Pathname=%INST%\Win\DotNetFX\3.5\dotNetFx35setup.exe
  Flags=00000101
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 3.5 Framework Installer Failed
  Text=Missing %INST_DRIVE%\Win\DotNetFX\3.5\dotNetFx35setup.exe
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Missing .NET 3.5 Framework Installer
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing .NET 3.5 Framework
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=On Windows Server 2008 the runtime has to be installed using the server manager tool, so if we get here we can't continue
end
item: Set Variable
  Variable=WIN2008_SERVER
  Value=0
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.0
  Flags=00000100
end
item: Set Variable
  Variable=WIN2008_SERVER
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.1
  Flags=00000100
end
item: Set Variable
  Variable=WIN2008_SERVER
  Value=1
end
item: End Block
end
item: If/While Statement
  Variable=WIN2008_SERVER
  Value=1
end
item: If/While Statement
  Variable=IS_WINDOWS_SERVER
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=INFO: Cannot use dotNetFx installer on Windows Server 2008 
end
item: Add Text to INSTALL.LOG
  Text=INFO: .NET Runtime must be installed before Enabler using Administrative Tools - Server Manager.
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 3.5 Runtime Required
  Text=The Enabler requires the .NET 3.5 runtime to be installed.
  Text=
  Text=On Windows Server 2008 this must be installed manually using:
  Text=  Administrative Tools - Server Manager
  Text=
  Text=You must do this before running the Enabler installer.
  Flags=00100100
end
item: End Block
end
item: Exit Installation
  Flags=23
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=.NET 3.5 will auto-reboot therefore better write RunOnce to the registry
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=True
  New Value=
  Value Name=Restart
  Root=2
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value="%INST%\Enabler4Setup.exe"
  New Value=
  Value Name=Enabler Install
  Root=2
end
item: Open/Close INSTALL.LOG
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Installing .NET 3.5 Framework
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\DotNetFX\3.5\dotNetFx35setup.exe"" /Q
  Flags=00001010
end
item: Remark
  Text=3010 means already installed.
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3010
end
item: Add Text to INSTALL.LOG
  Text=INFO: .NET 3.5 Framework Already Installed
end
item: Else Statement
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Remark
  Text=4121 means MSI is required - should not happen because we install this automatically.
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=4121
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 3.5 Framework Installer Failed
  Text=MSI 4.5 required
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=.NET 3.5 requires MSI 4.5
end
item: Else Statement
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 3.5 Framework Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=.NET 3.5 Framework Installation Failed
end
item: End Block
end
item: Remark
  Text=Remove the registry keys added by MSI reboot
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=%UNATTENDED%
  Value Name=UnattendedInstall
  Root=130
end
item: Remark
  Text=Removed exit !!!!!!!!!!!!!!!!!!!!!!!
end
item: End Block
end
item: End Block
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=REMOVE Installing .NET 3.5 Framework
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove the registry keys added by any restart in the previous sections
end
item: Edit Registry
  Total Keys=5
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SA_PASSWORD%
    New Value=
    Value Name=SA
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%PRE_UPGRADE_BACKUP%
    New Value=
    Value Name=Backup
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%UNATTENDED%
    New Value=
    Value Name=UnattendedInstall
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    Value Name=Restart
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    Value Name=InstanceName
    Root=194
  end
end
item: Remark
  Text=Remove the one once key if still present.
end
item: Remark
  Text=This happens if 3.5 is installed and doesn't reboot
end
item: Remark
  Text=And then the driver install on XP will execute the runonce key causing the install to start again
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value="%INST%\Enabler4Setup.exe"
  New Value=
  Value Name=Enabler Install
  Root=194
end
item: Remark
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Check if .Net 4 needs to be installed - SQL2014 only
end
item: Remark
  Text===========================================
end
item: Add Text to INSTALL.LOG
  Text=Check Net 4 install slqexpressname = %SQLEXPRESSNAME%, net 4 installed = %NET4_INSTALLED%
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2014
end
item: If/While Statement
  Variable=NET4_INSTALLED
  Value=1
  Flags=00000001
end
item: Check if File/Dir Exists
  Pathname=%INST%\Win\DotNetFX\4\dotNetFx40_Full_x86_x64.exe
  Flags=00000101
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 4 Framework Installer Failed
  Text=Missing %INST_DRIVE%\Win\DotNetFX\3.5\dotNetFx40_Full_x86_x64.exe
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Missing .NET 4 Framework Installer
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing .NET 4 Framework
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files (x86)\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=.Net 4 install will fail if windows update is running so stop duing install - Error 80240016
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""net stop WuAuServ"" 
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Stopping Windows update before installing .NET 4 Framework
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Installing .NET 4 Framework
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\DotNetFX\4\dotNetFx40_Full_x86_x64.exe"" /norestart /Q
  Flags=00001010
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Restarting Windows update before installing .NET 4 Framework
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""net start WuAuServ"" 
  Flags=00001010
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=.NET 4 Framework Installation return 1, Ok but reboot required
end
item: ElseIf Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=.NET 4 Framework Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=.NET 4 Framework Installation Failed, ERRORLEVEL = %INSTALL_RESULT%
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files (x86)\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=.NET 4 Framework already installed
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Checking installed Service Pack for Vista /Server 2008 when installing SQL 2012 only
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=1
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2012
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.0
end
item: Remark
end
item: Get Registry Key Value
  Variable=VISTASP
  Key=Software\Microsoft\Windows NT\CurrentVersion
  Value Name=CSDBuildNumber
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=Vista Build Number is %VISTASP%
end
item: Remark
  Text=NOTE: 6.0 = Windows Vista or Windows Server 2008
end
item: Remark
  Text=NOTE: msu files do not support the /passive switch
end
item: If/While Statement
  Variable=VISTASP
  Value=2
end
item: Remark
  Text=No SP installed
end
item: Remark
  Text=Installing SP1
end
item: Display Message
  Title=SQL2012 prerequisites not met
  Text=SQL2012 can not install in Vista without preinstalled Service Pack 1 & 2. Please install Service Packs first and retry Enabler installation.
  Flags=00000100
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Vista has no required Service Packs installed, exiting installation
end
item: Exit Installation
end
item: Remark
end
item: ElseIf Statement
  Variable=VISTASP
  Value=1616
end
item: Remark
  Text=No SP2 installed
end
item: Display Message
  Title=SQL2012 prerequisites not met
  Text=SQL2012 can not install in Vista without preinstalled Service Pack 2. Please install Service Pack 2 first and retry Enabler installation.
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Vista does not have required Service Pack 2 installed, exiting installation
end
item: Exit Installation
end
item: End Block
end
item: Remark
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL SERVER COMPONENTS
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=0
end
item: Remark
end
item: Set Variable
  Variable=SQLQUERY
  Value=%PC_NAME%\%SQL_INSTANCE%
end
item: Add Text to INSTALL.LOG
  Text=SQLQUERY = %SQLQUERY%
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=TRUSTED CONNECTION
end
item: Remark
  Text===========================================
end
item: Set Variable
  Variable=TRUSTED_CONNECTION
  Value=1
end
item: Add Text to INSTALL.LOG
  Text=About to query sysobjects %OSQL_PATH% with Trusted Connection
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d master -E -S%SQLQUERY% -Q "select count(*) from sysobjects"
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C osql -b -d master -E -S%SQLQUERY% -Q "select count(*) from sysobjects"
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=Trusted Connection Succeed !!!
end
item: Else Statement
end
item: Set Variable
  Variable=TRUSTED_CONNECTION
  Value=0
end
item: End Block
end
item: Else Statement
end
item: Set Variable
  Variable=TRUSTED_CONNECTION
  Value=0
end
item: End Block
end
item: If/While Statement
  Variable=TRUSTED_CONNECTION
  Value=0
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Installation failed
  Text=Unable to make a trusted connection to the SQL Server.
  Text=
  Text=Possible Causes:
  Text=
  Text=The database is installed with out allowing trusted connections.
  Text=
  Text=The SQL instance name is not correct. If the default instance is not installed you need to enter the name of the installed instance to install on.
  Text=
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Trusted Connection Failed ! SQL server might not have installed correctly. Or the Named instance was incorrect rc=%INSTALL_RESULT%
end
item: Exit Installation
  Flags=11
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=DETECT VERSION OF SQL SERVERS INSTALLED
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Make sure OSQL_PATH does not end in \
end
item: Set Variable
  Variable=OSQL_PATH
  Value=%OSQL_PATH%
  Flags=00001100
end
item: Remark
end
item: Remark
  Text=Find out the version of SQL installed.
end
item: Remark
  Text=SQL 2000 and newer support the following method of getting the version
end
item: Remark
  Text=Older versions do not. The Microsoft documentation for this method is at the link below
end
item: Remark
  Text=http://support.microsoft.com/default.aspx?scid=kb;en-us;321185#3
end
item: Remark
end
item: Remark
  Text=Create a temporary file to store the SQL results in.
end
item: Get Temporary Filename
  Variable=SQLINFO
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=SQL Version
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Determining pre installed SQL Server version
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Execute the sql to get the SQL version of a default instance or the instance name passed by the command line
end
item: Add Text to INSTALL.LOG
  Text=Query database for version using server and instance name %SQLQUERY%
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -E -S%SQLQUERY% -dmaster -h-1 -Q"select SERVERPROPERTY('productversion')" -o %TEMP%\%SQLINFO%
  Flags=00001010
end
item: Remark
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=SQL Version
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Determining pre installed SQL Server version
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: Display Message
  Title=OSQL failed to Execute
  Text=Unable to make a trusted connection to the SQL Server.
  Text=
  Text=Possible Causes:
  Text=
  Text=The database is installed with out allowing trusted connections.
  Text=
  Text=The SQL instance name is not correct. If the default instance is not installed you need to enter the name of the installed instance to install on.
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=%SQLQUERY% SQL server is not configured correctly the osql query failed
end
item: Exit Installation
  Flags=19
end
item: End Block
end
item: Remark
end
item: Set Variable
  Variable=LINE
end
item: Remark
  Text=Read each line of the SQL query results
end
item: Read/Update Text File
  Variable=LINE
  Pathname=%TEMP%\%SQLINFO%
end
item: If/While Statement
  Variable=SQLVER_MAJOR
end
item: Parse String
  Source=%LINE%
  Pattern=.
  Variable1=SQLVER_MAJOR
  Flags=00000001
end
item: End Block
end
item: End Block
end
item: Remark
  Text=Is SQL Server major revision greator than or equal to the number 8 (version 2000)
end
item: If/While Statement
  Variable=SQLVER_MAJOR
  Value=8
  Flags=00000111
end
item: Add Text to INSTALL.LOG
  Text=SQL Version found %SQLVER_MAJOR%
end
item: Else Statement
end
item: Remark
  Text=If the line read is greator than or equal to the number it is 2000 or newe
end
item: If/While Statement
  Variable=LINE
  Value=8.00.0000.00
  Flags=00000111
end
item: Add Text to INSTALL.LOG
  Text=SQL Version found %LINE%
end
item: Else Statement
end
item: Remark
  Text=Display the message to exit
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=A newer SQL Server is Required
  Text=Enabler requires a version of SQL Server greater than the one currently installed on this system.
  Text=
  Text=If you uninstall the currently installed SQL Server database Enabler can install a newer version of SQL Server
  Flags=00110000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Exiting installation as Enabler requires newer version than %SQLVER_MAJOR% of SQL Server
end
item: Exit Installation
  Flags=18
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=SQL Version
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Determining pre installed SQL Server version
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=IS THERE AN EXISTING ENABLER INSTALL
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Does the enabler database already exist?
end
item: If/While Statement
  Variable=PRE_UPGRADE_BACKUP
  Value=A
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-d EnablerDB -E -S%SQLQUERY% -Q "select count(*) from global_settings" -b
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=Preupgrade backup check for Enabler DB: Database FOUND
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Preupgrade backup check for Enabler DB: Database NOT found
end
item: Set Variable
  Variable=PRE_UPGRADE_BACKUP
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL SERVER IS REQUIRED
end
item: Remark
  Text===========================================
end
item: Remark
  Text=We know what if SQLServer is required and what version will be installed, so that optionally install MSI 4.5 and .NET
end
item: Remark
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2005 PREREQUISITES
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2005
end
item: Add Text to INSTALL.LOG
  Text=SQLServer2005 Express will be installed
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Check SQL EXPRESS 2005 required components before SQL installation
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Fetch MSI version, .NET version information and MDAC version
end
item: Get System Information
  Variable=MSI_VERSION
  Pathname=%SYS32%\MSI.DLL
  Flags=00000101
end
item: Get Registry Key Value
  Variable=DOTNET_VERSION
  Key=SOFTWARE\Microsoft\.NETFramework\policy\v2.0\
  Value Name=50727
  Flags=00000100
end
item: Get Registry Key Value
  Variable=MDAC_VERSION
  Key=SOFTWARE\Microsoft\DataAccess
  Value Name=FullInstallVer
  Flags=00000100
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=MDAC 2.8?
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=MDAC_VERSION
  Value=2.80.1022.3
  Flags=00001000
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=MDAC 2.8 Required by SQL2005
  Text=Microsoft Data Access Components (MDAC)  %MDAC_VERSION% Found. Please download MDAC 2.8 from www.microsoft.com and Install.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=MDAC 2.8 Required for SQL2005 Express
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=IE6 SP1?
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=IEXPLORE_VERSION
  Value=6.0.2800.1106
  Flags=00001000
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=IE 6.0 Service Pack 1 Required by SQL2005
  Text=Internet Explorer (IE) %IEXPLORE_VERSION% Found. Please download IE 6.0 SP1 from www.microsoft.com and Install.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=IE 6.0 SP1 Required for SQL2005 Express
end
item: Exit Installation
  Flags=2
end
item: End Block
end
item: Remark
end
remarked item: Remark
  Text===========================================
end
remarked item: Remark
  Text=MSI 3.1?
end
remarked item: Remark
  Text===========================================
end
remarked item: If/While Statement
  Variable=MSI_VERSION
  Value=3.1.400.2435
  Flags=00001000
end
remarked item: Check if File/Dir Exists
  Pathname=%INST%\Win\MSI\3.1\WindowsInstaller-KB893803-v2-x86.exe
  Flags=00000101
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=MSI 3.1 Installer Failed
  Text=Missing %INST_DRIVE%\Win\MSI\3.1\WindowsInstaller-KB893803-v2-x86.exe.
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=Missing MSI 3.1 Installer
end
remarked item: Exit Installation
  Flags=4
end
remarked item: End Block
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing MSI 3.1 Installer
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=Installing MSI 3.1
end
remarked item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\MSI\3.1\WindowsInstaller-KB893803-v2-x86.exe"" /quiet /passive /norestart 
  Flags=00001010
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
remarked item: Add Text to INSTALL.LOG
  Text=MSI 3.1 Already Installed
end
remarked item: Else Statement
end
remarked item: Remark
  Text=3010 means Reboot is required. Set Runonce to Enabler Installer
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3010
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=Rebooting
  Text=Windows MSI 3.1 Installer has completed, and your computer should now reboot automatically.
  Flags=00100100
end
remarked item: End Block
end
remarked item: Remark
  Text=Add Registry Keys before rebooting
end
remarked item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=%UNATTENDED%
  Value Name=UnattendedInstall
  Root=2
end
remarked item: Remark
  Text=Stop adding this entry to the Log file. This stops this being doing on uninstall.
end
remarked item: Remark
  Text=If the RunOnce key is deleted on uninstall and then Enabler is reinstalled the driver will fail its install
end
remarked item: Remark
  Text=As windows requires the runonce key to be present to install drivers
end
remarked item: Open/Close INSTALL.LOG
  Flags=00000001
end
remarked item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value=%INST%\Enabler4Setup.exe
  New Value=
  Value Name=Enabler Install
  Root=2
end
remarked item: Open/Close INSTALL.LOG
end
remarked item: Add Text to INSTALL.LOG
  Text=MSI 3.1 installed - reboot pending
end
remarked item: Exit Installation
  Flags=6
end
remarked item: End Block
end
remarked item: Remark
  Text=1603 means Windows OS platform is not supported.
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=1603
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=MSI 3.1 Installer Failed
  Text=Windows OS %WINDOWS_VERSION% Platform NOT supported.
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=MSI 3.1 Installation Failed - Windows OS Platform not supported.
end
remarked item: Exit Installation
  Flags=12
end
remarked item: Else Statement
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=MSI 3.1 Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=MSI 3.1 Installion Failed
end
remarked item: End Block
end
remarked item: Exit Installation
  Flags=7
end
remarked item: End Block
end
remarked item: End Block
end
item: Remark
end
remarked item: Remark
  Text===========================================
end
remarked item: Remark
  Text=.NET 2.0 Framework? no longer require since we now install 3.5 by default
end
remarked item: Remark
  Text===========================================
end
remarked item: If/While Statement
  Variable=DOTNET_VERSION
end
remarked item: Check if File/Dir Exists
  Pathname=%INST%\Win\DotNetFX\2.0\install.exe
  Flags=00000101
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=.NET 2.0 Framework Installer Failed
  Text=Missing %INST_DRIVE%\Win\DotNetFX\2.0\install.exe
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=Missing .NET 2.0 Framework Installer
end
remarked item: Remark
  Text=Remove the registry keys added by MSI reboot
end
remarked item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=%UNATTENDED%
  Value Name=UnattendedInstall
  Root=130
end
remarked item: Exit Installation
  Flags=4
end
remarked item: End Block
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing .NET 2.0 Framework
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=Installing .NET 2.0 Framework
end
remarked item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C ""%INST%\Win\DotNetFX\2.0\install.exe"" /Q
  Flags=00001010
end
remarked item: Remark
  Text=3010 means already installed.
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3010
end
remarked item: Add Text to INSTALL.LOG
  Text=.NET 2.0 Framework Already Installed
end
remarked item: Else Statement
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
remarked item: Remark
  Text=4121 means MSI is required
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=4121
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=.NET 2.0 Framework Installer Failed
  Text=MSI 3.1 required
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=.NET 2.0 requires MSI 3.1
end
remarked item: Else Statement
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=.NET 2.0 Framework Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=.NET 2.0 Framework Installation Failed
end
remarked item: End Block
end
remarked item: Remark
  Text=Remove the registry keys added by MSI reboot
end
remarked item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=%UNATTENDED%
  Value Name=UnattendedInstall
  Root=130
end
remarked item: Exit Installation
  Flags=7
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: End Block
end
item: Remark
  Text=End SQL2005 Block Prerequisites
end
item: End Block
end
item: End Block
end
item: Remark
  Text=End Server not needed
end
item: End Block
end
item: Remark
  Text=End Server install
end
item: Else Statement
end
item: Remark
  Text=Client Install make sure SQL Instance variable is set
end
item: Set Variable
  Variable=SQL_INSTANCE
  Value=%CLIENT_SQL_INSTANCE%
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Blank Password checks for SQL2005, SQL2008, SQL2012, SQL2014 and SQL2016
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=1
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=MSDE2000
  Flags=00000001
end
item: If/While Statement
  Variable=SA_PASSWORD
  Value=0
  Flags=00001100
end
item: Add Text to INSTALL.LOG
  Text=Blank passwords not allowed for %SQLEXPRESSFULLNAME%
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Passwords blank
  Text=Blank passwords not allowed for for %SQLEXPRESSFULLNAME%. Please re-enter the passwords.
  Flags=00100000
end
item: End Block
end
item: Exit Installation
  Flags=5
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL SQL SERVER or CHECK SA LOGIN
end
item: Remark
  Text===========================================
end
item: Remark
  Text=The Server Component requires either a preinstalled DB Server, or to install our own
end
item: Remark
  Text=If enabler server install selected
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=SQL_NEEDED
  Value=1
end
item: Set Variable
  Variable=INST_DRIVE
end
item: Parse String
  Source=%INST%
  Pattern=:
  Variable1=INST_DRIVE
end
item: Set Variable
  Variable=INST_DRIVE
  Value=:
  Flags=00000001
end
item: Create Directory
  Pathname=%MAINDIR%
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=MSDE2000
end
item: Remark
  Text===========================================
end
item: Remark
  Text=MSDE2000 Installation
end
item: Remark
  Text===========================================
end
item: Install File
  Source=V:\scripts\MSDEInstall.bat
  Destination=%MAINDIR%\MSDEInstall.bat
  Flags=0000000010100010
end
item: Remark
  Text=Install MSDE2000 now
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing SQL Server (MSDE2000)
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Starting MSDE2000 install from %INST%\MSDE2000...
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\MSDEInstall.bat %INST_DRIVE% "%INST%\MSDE2000" "%SA_PASSWORD%"
  Flags=00001010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\MSDE_REBOOT_PENDING
  Flags=00000100
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Rebooting
  Text=MSDE Install
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=MSDE installed - reboot pending
end
item: Exit Installation
  Flags=6
end
item: End Block
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2016 / 2014 / 2012 / 2008 /2005
end
item: Remark
  Text===========================================
end
item: Get Environment Variable
  Variable=USER_DOMAIN
  Environment=USERDOMAIN
end
item: Get Environment Variable
  Variable=USER_NAME
  Environment=USERNAME
end
item: Set Variable
  Variable=SQL_SYSADMIN_USER
  Value=%USER_DOMAIN%
end
item: Set Variable
  Variable=SQL_SYSADMIN_USER
  Value=\
  Flags=00000001
end
item: Set Variable
  Variable=SQL_SYSADMIN_USER
  Value=%USER_NAME%
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=Assigning system administrator privileges to %SQL_SYSADMIN_USER%
end
item: Remark
end
item: Remark
  Text=Install the SQLInstall batch file.
end
item: Install File
  Source=V:\scripts\SQLInstall.bat
  Destination=%MAINDIR%\SQLInstall.bat
  Flags=0000000010100010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing SQL Server (%SQLEXPRESSNAME%)
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files (x86)\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a few minutes. Please wait...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Starting %SQLEXPRESSNAME% install from %INST%\%SQLEXPRESSNAME%...
end
item: Remark
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2016
end
item: Remark
  Text=Extra checks for SQL2016 - Must be 64 bit and Windows greater than Windows 7
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.2
  Flags=00001000
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%SQLEXPRESSFULLNAME% Install
  Text=%SQLEXPRESSFULLNAME% Not supported on Windows 7 or earlier
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: %SQLEXPRESSFULLNAME% not supported on Windows 7 or earlier
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: If/While Statement
  Variable=OS
  Value=64
  Flags=00000101
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%SQLEXPRESSFULLNAME% Install
  Text=%SQLEXPRESSFULLNAME% Not supported on 32 bit installs
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: %SQLEXPRESSFULLNAME% not supported on 32 bit installs
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2016 Express Install
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Path to setup exe depends on whether 32 or 64 bit OS is found ( Only 64 bit for SQL2016)
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2016\%OS%" "%SA_PASSWORD%" "%SQL_SYSADMIN_USER%" SQL2016
  Flags=00001010
end
item: Remark
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2014
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2014 Express Install
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Path to setup exe depends on whether 32 or 64 bit OS is found
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2014\%OS%" "%SA_PASSWORD%" "%SQL_SYSADMIN_USER%" SQL2014
  Flags=00001010
end
item: Remark
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2012
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2012 Express Install
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Path to setup exe depends on whether 32 or 64 bit OS is found
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2012\%OS%" "%SA_PASSWORD%" "%SQL_SYSADMIN_USER%" SQL2012
  Flags=00001010
end
item: Remark
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2008R2
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2008 Express Install
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Path to setup exe depends on whether 32 or 64 bit OS is found
end
remarked item: Add Text to INSTALL.LOG
  Text=About to issue command: /C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2008R2\%OS%" "%SA_PASSWORD%" "%SQL_SYSADMIN_USER%"
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2008R2\%OS%" "%SA_PASSWORD%" "%SQL_SYSADMIN_USER%"
  Flags=00001010
end
item: Else Statement
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SQL2005 Express Install
end
item: Remark
  Text===========================================
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SQLInstall.bat %INST_DRIVE% "%INST%\SQL2005" "%SA_PASSWORD%"
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Result of SqlInstall  %INSTALL_RESULT%
end
item: Remark
end
item: Remark
  Text=Error 1 - Password not strong
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=1
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%SQLEXPRESSFULLNAME% Install
  Text=%SQLEXPRESSFULLNAME% Installation Failed
  Text=
  Text=The SA password used is not strong enough
  Text=
  Text=Retry the Enabler Installtion with a stronger password
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: %SQLEXPRESSFULLNAME% install failed due to  SQL password not strong
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Make sure the SQL Server doesn't need a reboot
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=2
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Reboot required
  Text=SQL Server install requires rebooting.
  Text=
  Text=The Enabler Installer will restart to complete the installation once the system has been rebooted.
  Flags=00100100
end
item: End Block
end
item: Remark
  Text=Add Registry Keys before rebooting
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=True
  New Value=
  Value Name=Restart
  Root=2
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value="%INST%\Enabler4Setup.exe"
  New Value=
  Value Name=Enabler Install
  Root=2
end
item: Open/Close INSTALL.LOG
end
item: Add Text to INSTALL.LOG
  Text=%SQLEXPRESSFULLNAME% installed - reboot pending
end
item: Custom Script Item
  Filename=Reboot System.wse
  Variable Name1=HELPFILE
  Variable Value1=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name2=_REBOOT_TYPE_
  Variable Value2=B
end
item: Exit Installation
  Flags=6
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Error 3 - Updates required
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%SQLEXPRESSFULLNAME% Install
  Text=%SQLEXPRESSFULLNAME% Installation Failed
  Text=
  Text=The SQL Server requires updates to the system before the installtion can start.
  Text=
  Text=Please install all Windows Updates and then retry the Enabler Installtion.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: %SQLEXPRESSFULLNAME% install failed, updates are required
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Error 4 or any other error -  Failed Intall
end
item: Remark
  Text=Make sure the SQL Server was installed
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%SQLEXPRESSFULLNAME% Install
  Text=%SQLEXPRESSFULLNAME% Installation Failed
  Text=
  Text=
  Text=# Check that you have used a strong SA password.
  Text=
  Text=# Check the latest Windows Updates have been appllied to system.
  Text=
  Text=# Reboot system
  Text=
  Text=Then retry the Enabler Installtion.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: %SQLEXPRESSFULLNAME% install failed
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Make sure the SQL Server engine is running
end
item: Start/Stop Service
  Service Name=mssqlserver
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Set up Registry Key for SQL version client Setup
end
item: Set Variable
  Variable=REG_KEY_IN
end
item: If/While Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2016
end
item: Set Variable
  Variable=REG_KEY_IN
  Value=SOFTWARE\\Microsoft\\Microsoft SQL Server\\130\\Tools\\ClientSetup
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2014
end
item: Set Variable
  Variable=REG_KEY_IN
  Value=SOFTWARE\\Microsoft\\Microsoft SQL Server\\120\\Tools\\ClientSetup
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2012
end
item: Set Variable
  Variable=REG_KEY_IN
  Value=SOFTWARE\\Microsoft\\Microsoft SQL Server\\110\\Tools\\ClientSetup
end
item: ElseIf Statement
  Variable=SQLEXPRESSNAME
  Value=SQL2008R2
end
item: Set Variable
  Variable=REG_KEY_IN
  Value=SOFTWARE\\Microsoft\\Microsoft SQL Server\\100\\Tools\\ClientSetup
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=If we get here must send the full path to OSQL.EXE to DBInstall to make sure it can run properly
end
item: If/While Statement
  Variable=REG_KEY_IN
  Flags=00000001
end
item: Remark
  Text=Locate OSQL for 2008R2, 2012, 2014, 2016 
end
item: Remark
  Text===============================================================================================================
end
item: Remark
  Text=== We are using a custom built DLL to get the registry key value from the windows registry
end
item: Remark
  Text=== if installing on a 64-bit OS the DLL will get the key from the 64-bit side of the registry.
end
item: Remark
  Text=== This is required because this installer (which is a 32-bit app) would otherwise incorrectly retrieve keys from the 32-bit side of the registry)
end
item: Remark
  Text=== FYI - - - On a 64-bit system there would be a \Program Files\ folder for 64-bit apps
end
item: Remark
  Text=== FYI - - - ...and a \Program Files (x86)\ folder for 32-bit apps
end
item: Remark
  Text===============================================================================================================
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Set Variable
  Variable=SUB_KEY_IN
  Value=Path
end
item: Add Text to INSTALL.LOG
  Text=64-bit OS therefore copying EnablerInstall.dll to Installation folder
end
item: Install File
  Source=v:\bin\enablerinstall.dll
  Destination=%Maindir%\bin\EnablerInstall.dll
  Flags=0000000010100010
end
item: Set Variable
  Variable=REGKEY
end
item: Call DLL Function
  Pathname=%MAINDIR%\bin\EnablerInstall.dll
  Function Name=GetRegKeyValue
  Argument List=y0ÑÿREGKEY
  Argument List=01400
  Argument List=y0ÑÿSUB_KEY_IN
  Argument List=y0ÑÿREG_KEY_IN
  Return Variable=0REGKEY_STRING
  Flags=00100000
end
item: Add Text to INSTALL.LOG
  Text=The path to OSQL.EXE for this 64-bit install of SQL Server is: %REGKEY%
end
item: Set Variable
  Variable=OSQL_PATH
  Value=%REGKEY%
end
item: Add Text to INSTALL.LOG
  Text=OSQL_PATH is currently set to %OSQL_PATH%
end
item: ElseIf Statement
  Variable=OS
  Value=32
end
item: Add Text to INSTALL.LOG
  Text=32-bit OS therefore will use standard WISE way to get key from registry
end
item: Get Registry Key Value
  Variable=OSQL_PATH
  Key=%REG_KEY_IN%
  Value Name=Path
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=OSQL_PATH is %OSQL_PATH%
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Processor bit size (e.g. 32/64 bit), the variable OS is %OS%
end
item: Else Statement
end
item: Remark
  Text=Locate OSQL for SQL2005 and MSDE2000 
end
item: Get Registry Key Value
  Variable=POSQL_PATH
  Key=Software\Microsoft\Windows\CurrentVersion
  Value Name=ProgramFilesDir
  Flags=00000100
end
item: Set Variable
  Variable=POSQL_PATH
  Value=%POSQL_PATH%
  Flags=00001100
end
item: Remark
  Text=Try SQL2005 Path first
end
item: Set Variable
  Variable=OSQL_PATH
  Value=%POSQL_PATH%\Microsoft SQL Server\90\Tools\Binn
  Flags=00001100
end
item: Check if File/Dir Exists
  Pathname=%OSQL_PATH%\OSQL.EXE
  Flags=00000101
end
item: Remark
  Text=Try MSDE Path second
end
item: Set Variable
  Variable=OSQL_PATH
  Value=%POSQL_PATH%\Microsoft SQL Server\80\Tools\Binn
  Flags=00001100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Location of OSQL.EXE is %OSQL_PATH% (SQL2005 Installation in progress)
end
item: End Block
end
item: Remark
end
item: Remark
  Text=In case we can't find OSQL.EXE anywhere
end
item: Check if File/Dir Exists
  Pathname=%OSQL_PATH%\OSQL.EXE
  Flags=00000101
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot find OSQL.EXE
end
item: Exit Installation
  Flags=7
end
item: End Block
end
item: Remark
end
item: Remark
  Text=oSQL should work now, we will test it now to make sure.
end
item: Add Text to INSTALL.LOG
  Text=Making sure that OSQL works %OSQL_PATH%
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d master -E -S%SQLQUERY% -Q "select count(*) from sysobjects"
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Remark
  Text=Ok we can run oSQL properly now, so remove Registry entries to restart after reboot
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=
  New Value=
  Value Name=InstallComponents
  Root=194
end
item: Edit Registry
  Total Keys=1
  Key=Software\ITL\Enabler
  New Value=
  New Value=
  Value Name=UnattendedInstall
  Root=194
end
item: Remark
  Text=Stop adding this entry to the Log file. This stops this being doing on uninstall.
end
item: Remark
  Text=If the RunOnce key is deleted on uninstall and then Enabler is reinstalled the driver will fail its install
end
item: Remark
  Text=As windows requires the runonce key to be present to install drivers
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  New Value=
  New Value=
  Value Name=Enabler Install
  Root=194
end
item: Open/Close INSTALL.LOG
end
item: Add Text to INSTALL.LOG
  Text=OSQL working OK!
end
item: Else Statement
end
item: Remark
  Text=We cannot continue with install now because oSQL is not working correctly, a reboot is required...
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=%APPTITLE%
  Text=The MSDE has been installed, but now requires a reboot.
  Text=
  Text=%APPTITLE% Installation should automatically restart after you have rebooted.  If it does not you can complete the install by running %APPTITLE% Setup program again.
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=OSQL not working, rebooting...
end
item: Custom Script Item
  Filename=Reboot System.wse
  Variable Name1=HELPFILE
  Variable Value1=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name2=_REBOOT_TYPE_
  Variable Value2=B
end
item: Exit Installation
  Flags=8
end
item: End Block
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=If a SQL already installed
end
item: Remark
  Text=Make sure the SQL server is running
end
item: If/While Statement
  Variable=SQL_INSTANCE
end
item: Start/Stop Service
  Service Name=MSSQLSERVER
end
item: Else Statement
end
item: Start/Stop Service
  Service Name=%SQL_INSTANCE%
end
item: End Block
end
item: Remark
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL WINDOWS DRIVER FOR ENABLER
end
item: Remark
  Text===========================================
end
item: Check if File/Dir Exists
  Pathname=%INST%\Driver
  Flags=00000100
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Installing Enabler Drivers
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
  Text=Delete All Drivers before copy the latest
end
item: Delete File
  Pathname=%MAINDIR%\Driver\*
  Flags=00001100
end
item: Remark
  Text=Copy Installation files across
end
item: Copy Local File
  Source=%INST%\Driver\DriverInstaller.exe
  Destination=%MAINDIR%\Driver\DriverInstaller.exe
  Flags=0000000011100010
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Copy Local File
  Source=%INST%\Driver\x64\EnablerPCI.inf
  Destination=%MAINDIR%\Driver\EnablerPCI.inf
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\Enbx64.sys
  Destination=%MAINDIR%\Driver\Enbx64.sys
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\enbamd64.cat
  Destination=%MAINDIR%\Driver\enbamd64.cat
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\DPInst.exe
  Destination=%MAINDIR%\Driver\DPInst.exe
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\DPInst.xml
  Destination=%MAINDIR%\Driver\DPInst.xml
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\enablerexpressamd64.cat
  Destination=%MAINDIR%\Driver\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\enablerexpressamd64.cat
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\EnablerExpressx64.inf
  Destination=%MAINDIR%\Driver\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\EnablerExpressx64.inf
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x64\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\EnablerExpressx64.sys
  Destination=%MAINDIR%\Driver\d5c4eb30-04db-4831-9b5c-6b4c1bfdd34c\EnablerExpressx64.sys
  Flags=0000000011100010
end
item: Else Statement
end
item: Copy Local File
  Source=%INST%\Driver\x86\EnablerPCI.inf
  Destination=%MAINDIR%\Driver\EnablerPCI.inf
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\Enbx32.sys
  Destination=%MAINDIR%\Driver\Enbx32.sys
  Flags=0000000111100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\enbx86.cat
  Destination=%MAINDIR%\Driver\enbx86.cat
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\DPInst.xml
  Destination=%MAINDIR%\Driver\DPInst.xml
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\DPInst.exe
  Destination=%MAINDIR%\Driver\DPInst.exe
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\dd6f1c9a-e12e-4635-ad02-38e3553533bf\enablerexpressx86.cat
  Destination=%MAINDIR%\Driver\dd6f1c9a-e12e-4635-ad02-38e3553533bf\enablerexpressx86.cat
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\dd6f1c9a-e12e-4635-ad02-38e3553533bf\EnablerExpressx32.inf
  Destination=%MAINDIR%\Driver\dd6f1c9a-e12e-4635-ad02-38e3553533bf\EnablerExpressx32.inf
  Flags=0000000011100010
end
item: Copy Local File
  Source=%INST%\Driver\x86\dd6f1c9a-e12e-4635-ad02-38e3553533bf\EnablerExpressx32.sys
  Destination=%MAINDIR%\Driver\dd6f1c9a-e12e-4635-ad02-38e3553533bf\EnablerExpressx32.sys
  Flags=0000000011100010
end
item: End Block
end
item: Remark
  Text=Check that the RunOnce Key is present and create it if it doesn't
end
item: Edit Registry
  Total Keys=1
  Key=SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
  Root=2
  Data Type=5
end
item: Remark
end
item: Remark
  Text=Installs the Driver calling an application that returns a success or not
end
item: Execute Program
  Pathname=%MAINDIR%\Driver\DriverInstaller.exe
  Default Directory=%MAINDIR%\Driver
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Driver Installer return code %INSTALL_RESULT%
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=1
end
item: Remark
  Text=Requires Reboot
end
item: Set Variable
  Variable=DRIVERCODE
  Value=1
end
item: ElseIf Statement
  Variable=INSTALL_RESULT
  Value=2
end
item: Remark
  Text=Failed Install
end
item: Set Variable
  Variable=DRIVERCODE
  Value=2
end
item: ElseIf Statement
  Variable=INSTALL_RESULT
  Value=3
end
item: Remark
  Text=No device present
end
item: Set Variable
  Variable=DRIVERCODE
  Value=3
end
item: Else Statement
end
item: Remark
  Text=Successful Install
end
item: Set Variable
  Variable=DRIVERCODE
  Value=0
end
item: End Block
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Install Enabler Drivers
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Else Statement
end
item: Display Message
  Title=Unable to Install Driver
  Text=The Driver Package is not present.
  Text=The Driver has not been installed
  Text=Installation of Enabler will continue and the driver will need to be installed manually.
  Flags=00000100
end
item: End Block
end
item: Remark
  Text=End Installing Server components
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Install VS 2008 SP1 C++ Redistributables - Used by Enabler v4 Psvr and EnbSessionX2
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing VS C++ 2008 SP1 Redistributables
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Install File
  Source=V:\MsiQueryProduct.exe
  Destination=%MAINDIR%\MsiQueryProduct.exe
  Flags=0000000010100010
end
item: Execute Program
  Pathname=%MAINDIR%\MsiQueryProduct.exe
  Command Line={9A25302D-30C0-39D9-BD6F-21E6EC160475}
  Variables Added=VC2008RUNTIME_STATUS
  Flags=00001010
end
item: If/While Statement
  Variable=VC2008RUNTIME_STATUS
  Value=5
end
item: Add Text to INSTALL.LOG
  Text=INFO: Skipping VS C++ 2008 SP1 runtime - already installed
end
item: Else Statement
end
item: Remark
end
item: Remark
  Text=Ok now we try to install the runtime
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\vcredist_x86.exe
  Flags=00000101
end
item: Add Text to INSTALL.LOG
  Text=Installing VS C++ 2008 SP1 Redistributables
end
item: Install File
  Source=V:\Extra\vcredist_x86.exe
  Destination=%MAINDIR%\vcredist_x86.exe
  Flags=0000000010100010
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\vcredist_x86.exe /q
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=3010
  Flags=00000001
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=VS C++ 2008 SP1 Redistributables Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: VS C++ 2008 SP1 Redistributables Installation Failed
end
item: Exit Installation
  Flags=22
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=INFO: VS C++ 2008 SP1 Redistributables Installation reported error 3010, Reboot pending
end
item: End Block
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
remarked item: Remark
  Text===========================================
end
remarked item: Remark
  Text=Install VS 2015 C++ Redistributables - Used by Enabler PCI/PCIe Driver
end
remarked item: Remark
  Text===========================================
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing VS C++ 2015 Redistributables
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
remarked item: End Block
end
remarked item: Remark
end
remarked item: Install File
  Source=V:\MsiQueryProduct.exe
  Destination=%MAINDIR%\MsiQueryProduct.exe
  Flags=0000000010100010
end
remarked item: Execute Program
  Pathname=%MAINDIR%\MsiQueryProduct.exe
  Command Line={9A25302D-30C0-39D9-BD6F-21E6EC160475}
  Variables Added=VC2015RUNTIME_STATUS
  Flags=00001010
end
remarked item: If/While Statement
  Variable=VC2015RUNTIME_STATUS
  Value=5
end
remarked item: Add Text to INSTALL.LOG
  Text=INFO: Skipping VS C++ 2015 runtime - already installed
end
remarked item: Else Statement
end
remarked item: Remark
end
remarked item: Remark
  Text=Ok now we try to install the runtime
end
remarked item: Set Variable
  Variable=VC2015REDIST_FOUND
  Value=0
end
remarked item: If/While Statement
  Value=OPERATING_SYSTEM >= 6
  Flags=00001101
end
remarked item: If/While Statement
  Value=OS=64
  Flags=00001101
end
remarked item: Check if File/Dir Exists
  Pathname=%MAINDIR%\vc2015redist_x64.exe
  Flags=00000101
end
remarked item: Check if File/Dir Exists
  Pathname=V:\Extra\vc2015_redist.x64.exe
  Flags=00000100
end
remarked item: Set Variable
  Variable=VC2015REDIST_FOUND
  Value=1
end
remarked item: Add Text to INSTALL.LOG
  Text=INFO: Installing VS C++ 2015 SP1 Redistributables (64-bit)
end
remarked item: Install File
  Source=V:\Extra\vc2015_redist.x64.exe
  Destination=%MAINDIR%\vc2015redist_x64.exe
  Flags=0000000010100010
end
remarked item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\vc2015redist_x64.exe /q
  Flags=00001010
end
remarked item: Else Statement
end
remarked item: Add Text to INSTALL.LOG
  Text=INFO: Skipped C++ 2015 SP1 Redistributables - not included in install package
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: Else Statement
end
remarked item: Remark
  Text=BUG: ? shouldn't we always install the 32-bit runtime if the reason we're adding this runtime is in general preparation for applications using it?
end
remarked item: Check if File/Dir Exists
  Pathname=%MAINDIR%\vc2015redist_x86.exe
  Flags=00000101
end
remarked item: Check if File/Dir Exists
  Pathname=V:\Extra\vc2015_redist.x86.exe
  Flags=00000100
end
remarked item: Set Variable
  Variable=VC2015REDIST_FOUND
  Value=2
end
remarked item: Add Text to INSTALL.LOG
  Text=INFO: Installing VS C++ 2015 SP1 Redistributables (32-bit)
end
remarked item: Install File
  Source=V:\Extra\vc2015_redist.x86.exe
  Destination=%MAINDIR%\vc2015redist_x86.exe
  Flags=0000000010100010
end
remarked item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\vc2015redist_x86.exe /q
  Flags=00001010
end
remarked item: Else Statement
end
remarked item: Add Text to INSTALL.LOG
  Text=INFO: Skipped C++ 2015 SP1 Redistributables - not included in install package
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: If/While Statement
  Variable=VC2015REDIST_FOUND
  Value=0
  Flags=00000110
end
remarked item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Display Message
  Title=VS C++ 2015 Redistributables Installer Failed
  Text=ERRORLEVEL = %INSTALL_RESULT%
  Flags=00100100
end
remarked item: End Block
end
remarked item: Add Text to INSTALL.LOG
  Text=ERROR: VS C++ 2015 Redistributables Installation Failed
end
remarked item: Exit Installation
  Flags=22
end
remarked item: End Block
end
remarked item: If/While Statement
  Variable=SILENT
  Value=0
end
remarked item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Installing VS C++ 2015 Redistributables
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=This may take a couple of minutes. Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: End Block
end
remarked item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Initialising Installer
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Remove variables saved in the Windows Registry
end
item: Remark
  Text===========================================
end
item: Open/Close INSTALL.LOG
  Flags=00000001
end
item: Edit Registry
  Total Keys=6
  item: Key
    Key=Software\ITL\Enabler
    New Value=%COMPONENTS%
    New Value=
    Value Name=Components
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%APPLICATIONS%
    New Value=
    Value Name=Applications
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SA_PASSWORD%
    New Value=
    Value Name=SA
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%PRE_UPGRADE_BACKUP%
    New Value=
    Value Name=Backup
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SDK%
    New Value=
    Value Name=SDK
    Root=194
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%UNATTENDED%
    New Value=
    Value Name=UnattendedInstall
    Root=194
  end
end
item: Open/Close INSTALL.LOG
end
item: Remark
end
item: Remark
  Text=When the BACKUP feature is enabled, the BACKUPDIR is initialized
end
item: If/While Statement
  Variable=DOBACKUP
  Value=A
end
item: Set Variable
  Variable=BACKUPDIR
  Value=%BACKUP%
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Check free disk space calculates free disk space as well as component sizes.
end
item: Remark
  Text=It should be located before all Install File actions.
end
item: Check Disk Space
  Component=COMPONENTS
end
item: Remark
end
item: Remark
  Text=This include script allows uninstall support
end
item: Include Script
  Pathname=%_WISE_%\INCLUDE\uninstal.wse
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Remove ATL.DLL hook if preset to prevent automatic activation of MSDE setup - See http://support.microsoft.com/kb/889289 
end
item: Remark
  Text===========================================
end
item: Edit Registry
  Total Keys=1
  Key=CLSID\{44EC053A-400F-11D0-9DCD-00A0C90391D3}\InprocServer32
  New Value=)1pFEf=hI=DBiz@GgPxz>w.'b9VZqf(g6u.Q(31aR
  New Value=
  Value Name=InprocServer32
  Root=192
  Data Type=2
end
item: Add Text to INSTALL.LOG
  Text=Removing ATL.DLL hook MSDN KB:889289
end
item: Remark
end
item: Remark
  Text=First we create the log directory - even clients need this
end
item: Create Directory
  Pathname=%MAINDIR%\Log
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL ENABLER FILES
end
item: Remark
  Text===========================================
end
item: Remark
end
item: Remark
  Text=Load registry settings required to Add start menu items
end
item: Check Configuration
  Flags=10111011
end
item: Get Registry Key Value
  Variable=STARTUPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%WIN%\Start Menu\Programs\StartUp
  Value Name=StartUp
  Flags=00000010
end
item: Get Registry Key Value
  Variable=DESKTOPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%WIN%\Desktop
  Value Name=Desktop
  Flags=00000010
end
item: Get Registry Key Value
  Variable=STARTMENUDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%WIN%\Start Menu
  Value Name=Start Menu
  Flags=00000010
end
item: Get Registry Key Value
  Variable=GROUPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%WIN%\Start Menu\Programs
  Value Name=Programs
  Flags=00000010
end
item: Get Registry Key Value
  Variable=CSTARTUPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%STARTUPDIR%
  Value Name=Common Startup
  Flags=00000100
end
item: Get Registry Key Value
  Variable=CDESKTOPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%DESKTOPDIR%
  Value Name=Common Desktop
  Flags=00000100
end
item: Get Registry Key Value
  Variable=CSTARTMENUDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%STARTMENUDIR%
  Value Name=Common Start Menu
  Flags=00000100
end
item: Get Registry Key Value
  Variable=CGROUPDIR
  Key=Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  Default=%GROUPDIR%
  Value Name=Common Programs
  Flags=00000100
end
item: Set Variable
  Variable=CGROUP_SAVE
  Value=%GROUP%
end
item: Set Variable
  Variable=DESKTOPDIR
  Value=%CDESKTOPDIR%
end
item: Set Variable
  Variable=GROUP
  Value=%CGROUPDIR%\%GROUP%
end
item: Else Statement
end
item: Remark
  Text=Just being paranoid really - we should never get here because we check the OS Version earlier on
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Cannot add Start menu items
end
item: Exit Installation
  Flags=4
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Install File
  Source=v:\bin\scutil.exe
  Destination=%MAINDIR%\scutil.exe
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\psrvr4.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\scutil.exe
  Command Line=/STOP psrvr
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not stop PSRVR (rc=%INSTALL_RESULT%)
end
item: End Block
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\psrvr4.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\scutil.exe
  Command Line=/STOP psrvr
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not stop PSRVR (rc=%INSTALL_RESULT%)
end
item: End Block
end
item: Else Statement
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\psrvr.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\scutil.exe
  Command Line=/STOP psrvr
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not stop PSRVR (rc=%INSTALL_RESULT%)
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\WebHost.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\scutil.exe
  Command Line=/STOP WebHost
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not stop Enabler Web (rc=%INSTALL_RESULT%)
end
item: End Block
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\EnbWeb.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\scutil.exe
  Command Line=/STOP EnbWeb
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not stop Enabler Web (rc=%INSTALL_RESULT%)
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Create License.xml for licensed v4.0 Beta customers
end
item: Remark
  Text===========================================
end
item: Add Text to INSTALL.LOG
  Text=Check for V4 Beta License 
end
item: Install File
  Source=V:\ConvertV4BetaLicense.exe
  Destination=%MAINDIR%\ConvertV4BetaLicense.exe
  Flags=0000000010000010
end
item: Execute Program
  Pathname=%MAINDIR%\ConvertV4BetaLicense.exe
  Command Line=/c
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=v4.0 Beta License converted
end
item: End Block
end
item: Remark
end
item: Remark
  Text=SETUP ENVIRONMENT VARIABLES AND REGISTRY KEYS
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Install File
  Source=v:\bin\setx64.exe
  Destination=%MAINDIR%\bin\setx64.exe
  Flags=0000000010000010
end
item: Set Variable
  Variable=SETX_PATH
  Value=%MAINDIR%\bin\setx64.exe
end
item: Else Statement
end
item: Install File
  Source=v:\bin\setx32.exe
  Destination=%MAINDIR%\bin\setx32.exe
  Flags=0000000010000010
end
item: Set Variable
  Variable=SETX_PATH
  Value=%MAINDIR%\bin\setx32.exe
end
item: End Block
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_ROOT %MAINDIR% -M
  Flags=00001010
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_LOG %MAINDIR%\Log -M
  Flags=00001010
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_DB_INSTANCE_NAME "%SQL_INSTANCE%" -M
  Flags=00001010
end
item: Edit Registry
  Total Keys=6
  item: Key
    Key=Software
    Root=2
  end
  item: Key
    Key=Software\ITL
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%MAINDIR%
    Value Name=Root
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%MAINDIR%\Log
    Value Name=Enabler_Log
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SQL_INSTANCE%
    Value Name=DatabaseInstanceName
    Root=2
  end
end
item: Remark
end
item: Remark
  Text=And now the files
end
item: If/While Statement
  Variable=WINDOWS_VERSION
  Value=5
  Flags=00001000
end
item: Remark
  Text=Should we install these into the SYSTEM32 folder?
end
item: Add Text to INSTALL.LOG
  Text=Installing on Windows %WINDOWS_VERSION% installing extra DLLs
end
item: Install File
  Source=V:\Extra\ATL.DLL
  Destination=%MAINDIR%\ATL.DLL
  Flags=0001000010000010
end
item: Install File
  Source=v:\extra\mfc42.dll
  Destination=%MAINDIR%\mfc42.dll
  Flags=0000000010000010
end
item: Install File
  Source=v:\extra\mfc42u.dll
  Destination=%MAINDIR%\mfc42u.dll
  Flags=0000000010000010
end
item: End Block
end
item: Delete File
  Pathname=%MAINDIR%\Release Notes.html
end
item: Check if File/Dir Exists
  Pathname=V:\Release Notes.htm
  Flags=00000100
end
item: Install File
  Source=V:\Release Notes.htm
  Destination=%MAINDIR%\Release Notes.htm
  Flags=0000000000100010
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=V:\Update\PumpUpdate.htm
  Flags=00000100
end
item: Install File
  Source=V:\Update\PumpUpdate.htm
  Destination=%MAINDIR%\PumpUpdate.htm
  Flags=0000000000100010
end
item: End Block
end
item: Install File
  Source=v:\bin\atutil.exe
  Destination=%MAINDIR%\atutil.exe
  Flags=0000000010000010
end
item: Install File
  Source=v:\bin\odbcnfg.exe
  Destination=%MAINDIR%\bin\odbcnfg.exe
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\ODBCnfg64.exe
  Destination=%MAINDIR%\bin\odbcnfg64.exe
  Flags=0000000010000010
end
item: Install File
  Source=V:\EnbKick.exe
  Destination=%MAINDIR%\EnbKick.exe
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=API ASSEMBLIES - perhaps some of these should be optional install components
end
item: Remark
  Text===========================================
end
item: Remark
end
remarked item: Install File
  Source=v:\API\ActiveX\EnbSessionX.ocx
  Destination=%MAINDIR%\EnbSessionX.ocx
  Flags=0001000010000010
end
remarked item: Install File
  Source=v:\API\ActiveX\EnbOPTX.ocx
  Destination=%MAINDIR%\EnbOPTX.ocx
  Flags=0001000010000010
end
remarked item: Install File
  Source=v:\API\ActiveX\EnbPumpX.ocx
  Destination=%MAINDIR%\EnbPumpX.ocx
  Flags=0001000010000010
end
remarked item: Install File
  Source=v:\API\ActiveX\EnbAttendantX.ocx
  Destination=%MAINDIR%\EnbAttendantX.ocx
  Flags=0001000010000010
end
item: Remark
  Text=Only include ActiveX2 controls if they're in the source directory
end
item: Install File
  Source=v:\API\ActiveX\EnbPumpX2.ocx
  Destination=%MAINDIR%\EnbPumpX2.ocx
  Flags=0001000010000010
end
item: Install File
  Source=v:\API\ActiveX\EnbSessionX2.ocx
  Destination=%MAINDIR%\EnbSessionX2.ocx
  Flags=0001000010000010
end
item: Install File
  Source=v:\API\ActiveX\EnbAttendantX2.ocx
  Destination=%MAINDIR%\EnbAttendantX2.ocx
  Flags=0001000010000010
end
item: Install File
  Source=v:\EnablerSoundEvents.reg
  Destination=%MAINDIR%\EnablerSoundEvents.reg
  Flags=0000000010000010
end
item: Remark
  Text=Include EnbConfigX if available
end
item: Compiler Variable If
  Value=v:\API\EnbConfigX.ocx
  Flags=00000011
end
item: Install File
  Source=v:\API\ActiveX\EnbConfigX.ocx
  Destination=%MAINDIR%\EnbConfigX.ocx
  Flags=0001000010000010
end
item: Compiler Variable End
end
item: Remark
  Text=Java Assemblies
end
item: Install File
  Source=V:\API\Java\enabler-api-1.0.jar
  Destination=%MAINDIR%\enabler-api-1.0.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\Extra\joda-time-2.0.jar
  Destination=%MAINDIR%\joda-time-2.0.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\Extra\joda-time-NOTICE.txt
  Destination=%MAINDIR%\joda-time-NOTICE.txt
  Flags=0000000010000010
end
item: Install File
  Source=v:\Extra\joda-time-LICENSE.txt
  Destination=%MAINDIR%\joda-time-LICENSE.txt
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Enabler 4 .NET API assembly self installing package
end
item: Remark
  Text=TODO: update this MSI to install to different locations.
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\InstallEnablerAPI.msi
  Flags=00000100
end
item: Remark
  Text=Uninstall the previous version before installing the new one.
end
item: Execute Program
  Pathname=%SYS32%\msiexec.exe
  Command Line=/quiet /L+* %MAINDIR%\log\APIInstall.log /uninstall {30876486-DB1A-41CE-95D0-58F1EEA13AE8}
  Default Directory=%MAINDIR%
  Flags=00000110
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not uninstall existing Enabler API - ERRORLEVEL = %INSTALL_RESULT%
end
item: End Block
end
item: End Block
end
item: Install File
  Source=V:\API\NET\InstallEnablerAPI.msi
  Destination=%MAINDIR%\InstallEnablerAPI.msi
  Flags=0000000010000010
end
item: Execute Program
  Pathname=%SYS32%\msiexec.exe
  Command Line=/quiet /L+* %MAINDIR%\log\APIInstall.log /package %MAINDIR%\InstallEnablerAPI.msi
  Default Directory=%MAINDIR%
  Flags=00000110
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
  Flags=00000001
end
item: Add Text to INSTALL.LOG
  Text=INFO: Could not install Enabler API - ERRORLEVEL = %INSTALL_RESULT%
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Enabler API
  Text=Enabler API msi installer has failed to install
  Flags=00100100
end
item: End Block
end
item: Exit Installation
  Flags=24
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Enabler 4 WPF Controls for .NET API
end
item: Install File
  Source=V:\API\NET\ITL.Enabler.WPFControls.dll
  Destination=%MAINDIR%\ITL.Enabler.WPFControls.dll
  Flags=0000000010000011
end
item: Install File
  Source=V:\API\NET\System.Windows.Controls.DataVisualization.Toolkit.dll
  Destination=%MAINDIR%\System.Windows.Controls.DataVisualization.Toolkit.dll
  Flags=0000000010000011
end
item: Install File
  Source=V:\API\NET\WPFToolkit.dll
  Destination=%MAINDIR%\WPFToolkit.dll
  Flags=0000000010000011
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=SECURITY COMPONENTS - ALWAYS INSTALLED
end
item: Remark
  Text===========================================
end
item: Compiler Variable If
  Value=v:\EnbSecurityController.exe
  Flags=00000011
end
item: Install File
  Source=v:\EnbSecurityController.exe
  Destination=%MAINDIR%\EnbSecurityController.exe
  Flags=0001000010000010
end
item: Compiler Variable End
end
item: Compiler Variable If
  Value=v:\SecurityModule.dll
  Flags=00000011
end
item: Install File
  Source=v:\SecurityModule.dll
  Destination=%MAINDIR%\SecurityModule.dll
  Flags=0001000010000010
end
item: Compiler Variable End
end
item: Remark
  Text=Security components always get installed
end
item: Compiler Variable If
  Value=v:\AuditTrail.dll
  Flags=00000011
end
item: Install File
  Source=v:\AuditTrail.dll
  Destination=%MAINDIR%\AuditTrail.dll
  Flags=0000000010000010
end
item: Compiler Variable End
end
item: Remark
end
item: Remark
  Text=Icon for Add/Remove programs
end
item: Install File
  Source=v:\itl.ico
  Destination=%MAINDIR%\itl.ico
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=THIRD PARTY DLL & OCX FILES FOR VB6 APPS (e.g. MPPSIM)
end
item: Remark
  Text===========================================
end
item: Install File
  Source=v:\Extra\Mscomm32.ocx
  Destination=%MAINDIR%\Mscomm32.ocx
  Flags=0001000010000011
end
item: Install File
  Source=v:\Extra\Comdlg32.ocx
  Destination=%MAINDIR%\Comdlg32.ocx
  Flags=0001000010000011
end
item: Install File
  Source=v:\Extra\Comctl32.ocx
  Destination=%MAINDIR%\Comctl32.ocx
  Flags=0001000010000011
end
item: Install File
  Source=v:\Extra\Comct232.ocx
  Destination=%MAINDIR%\Comct232.ocx
  Flags=0001000010000011
end
item: Remark
  Text=MsFlxGrd required for VB6 PumpDemo
end
item: Install File
  Source=v:\Extra\Msflxgrd.ocx
  Destination=%MAINDIR%\Msflxgrd.ocx
  Flags=0001000010000011
end
item: Install File
  Source=v:\Extra\Msvcp60.dll
  Destination=%MAINDIR%\Msvcp60.dll
  Flags=0000000010000011
end
item: Install File
  Source=v:\Extra\Msrdo20.dll
  Destination=%MAINDIR%\Msrdo20.dll
  Flags=0001000010000011
end
item: Install File
  Source=v:\Extra\Msrdc20.ocx
  Destination=%MAINDIR%\Msrdc20.ocx
  Flags=0001000010000011
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL SERVER FILES 
end
item: Remark
  Text===========================================
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Remark
end
item: Remark
  Text=Environment and Registry variables
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_SERVER %ENV_COMPUTERNAME% -M
  Flags=00001010
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_WEB "%MAINDIR%\www" -M
  Flags=00001010
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_BIN "%MAINDIR%\bin" -M
  Flags=00001010
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_DB "%DBDIR%" -M
  Flags=00001010
end
item: Edit Registry
  Total Keys=8
  item: Key
    Key=Software
    Root=2
  end
  item: Key
    Key=Software\ITL
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%MAINDIR%\www
    Value Name=Web
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%MAINDIR%\bin
    Value Name=Bin
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%ENV_COMPUTERNAME%
    New Value=
    Value Name=ServerName
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=C:\EnablerDB
    Value Name=DatabasePath
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=enablerdb
    Value Name=Database
    Root=2
  end
end
item: Remark
end
item: Remark
  Text=Enabler Database scripts and batch files
end
item: Install File
  Source=v:\scripts\DBInstall.bat
  Destination=%MAINDIR%\DBInstall.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\DBUpgrade.bat
  Destination=%MAINDIR%\DBUpgrade.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\AfterRestore.sql
  Destination=%MAINDIR%\AfterRestore.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\attach.sql
  Destination=%MAINDIR%\attach.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\checkdb.sql
  Destination=%MAINDIR%\checkdb.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\config70.sql
  Destination=%MAINDIR%\config70.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\DefaultData.sql
  Destination=%MAINDIR%\DefaultData.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\enabler.sql
  Destination=%MAINDIR%\enabler.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\eic.sql
  Destination=%MAINDIR%\eic.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\Load.sql
  Destination=%MAINDIR%\Load.sql
  Flags=0000000010000010
end
item: Compiler Variable If
  Value=v:\scripts\AuditTriggers.sql
  Flags=00000011
end
remarked item: Install File
  Source=v:\scripts\AuditTriggers.sql
  Destination=%MAINDIR%\AuditTriggers.sql
  Flags=0000000010000010
end
item: Compiler Variable End
end
item: Install File
  Source=v:\scripts\MkUpgrade.sql
  Destination=%MAINDIR%\MkUpgrade.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\populate.sql
  Destination=%MAINDIR%\populate.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\LOADEnbConfigX.SQL
  Destination=%MAINDIR%\LOADEnbConfigX.SQL
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=v:\scripts\dbfix.sql
  Destination=%MAINDIR%\dbfix.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\drop.sql
  Destination=%MAINDIR%\drop.sql
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\nightly70.bat
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\nightly70.bat
end
item: Remark
  Text=Remove any schedule entry for the nightly backup (just in case the server software was previous installed)
end
item: Execute Program
  Pathname=%MAINDIR%\atutil.exe
  Command Line=/d \Enabler\nightly
  Flags=00000110
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\nightly.bat
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\nightly.bat
end
item: Remark
  Text=Remove any schedule entry for the nightly backup (just in case the server software was previous installed)
end
item: Execute Program
  Pathname=%MAINDIR%\atutil.exe
  Command Line=/d %MAINDIR%\bin\nightly
  Flags=00000110
end
item: End Block
end
item: Install File
  Source=v:\scripts\Nightly.bat
  Destination=%MAINDIR%\Nightly.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\Nightly.sql
  Destination=%MAINDIR%\Nightly.sql
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\EnablerRestore.bat
  Destination=%MAINDIR%\EnablerRestore.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\sql70.bat
  Destination=%MAINDIR%\sql70.bat
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Enabler Server Executables
end
item: Install File
  Source=v:\bin\ExpressUpdate.exe
  Destination=%MAINDIR%\ExpressUpdate.exe
  Flags=0000000010000010
end
item: If/While Statement
  Value=OS=64 And OPERATING_SYSTEM >= 6
  Flags=00001101
end
item: Install File
  Source=v:\bin\ExpressUpdatex64.exe
  Destination=%MAINDIR%\ExpressUpdatex64.exe
  Flags=0000000010000010
end
item: End Block
end
item: Install File
  Source=V:\bin\PCIUpdate.exe
  Destination=%MAINDIR%\PCIUpdate.exe
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\Install.exe
  Flags=00000100
end
item: Remark
  Text=Remove the older install.exe application which has been renamed to PCIUpdate
end
item: Delete File
  Pathname=%MAINDIR%\Install.exe
end
item: End Block
end
item: Install File
  Source=v:\bin\psrvr4.exe
  Destination=%MAINDIR%\bin\psrvr4.exe
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\vsql.exe
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\vsql.exe
end
item: End Block
end
remarked item: Install File
  Source=v:\windrvr.sys
  Destination=%MAINDIR%\windrvr.sys
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Now the batch files...
end
item: Install File
  Source=v:\scripts\onmains.bat
  Destination=%MAINDIR%\onmains.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\onbatt.bat
  Destination=%MAINDIR%\onbatt.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\CommsLst.bat
  Destination=%MAINDIR%\CommsLst.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\CommsEst.bat
  Destination=%MAINDIR%\CommsEst.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\ComLstBt.bat
  Destination=%MAINDIR%\ComLstBt.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\BattLow.bat
  Destination=%MAINDIR%\BattLow.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\BattGood.bat
  Destination=%MAINDIR%\BattGood.bat
  Flags=0000000010000010
end
item: Install File
  Source=v:\scripts\BattFlat.bat
  Destination=%MAINDIR%\BattFlat.bat
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Copy version EIC.INF file - for USB connection to new hardware
end
item: Install File
  Source=V:\EicGX.inf
  Destination=%MAINDIR%\EicGX.inf
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Install Enabler E firmware
end
item: Install File
  Source=V:\EicMain2.hex
  Destination=%MAINDIR%\EicMain2.hex
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Customer or integrator branding; customer configurable files
end
item: Check if File/Dir Exists
  Pathname=%INST%\branding\integrator.xml
  Flags=00000100
end
item: Copy Local File
  Source=%INST%\branding\integrator.xml
  Destination=%MAINDIR%\integrator\integrator.xml
  Description=Content for web welcome page
  Flags=0000000011010010
end
item: Else Statement
end
item: Delete File
  Pathname=%MAINDIR%\integrator\integrator.xml
end
item: End Block
end
item: Remark
end
item: Remark
  Text=These are now combined into the EnbWeb/WebPages assembly by the obsfucator. Delete these files if they exists!
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\DataAccess.dll
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\DataAccess.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\DataEntity.dll
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\DataEntity.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\DataModules.dll
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\DataModules.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\DataValidation.dll
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\DataValidation.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\WebData.dll
  Flags=00000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\WebData.dll
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Web Server files and assemblies
end
item: Install File
  Source=V:\bin\OpenNETCF.SSL.dll
  Destination=%MAINDIR%\bin\OpenNETCF.SSL.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\OpenNETCF.Web.dll
  Destination=%MAINDIR%\bin\OpenNETCF.Web.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\OpenNETCF.Web.Html.dll
  Destination=%MAINDIR%\bin\OpenNETCF.Web.Html.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\Utilities.dll
  Destination=%MAINDIR%\bin\Utilities.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\Newtonsoft.Json.dll
  Destination=%MAINDIR%\bin\Newtonsoft.Json.dll
  Flags=0000000010000010
end
item: Remark
  Text=SSL files
end
item: Install File
  Source=V:\bin\openssl.exe
  Destination=%MAINDIR%\bin\openssl.exe
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\libeay32.dll
  Destination=%MAINDIR%\bin\libeay32.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\ssleay32.dll
  Destination=%MAINDIR%\bin\ssleay32.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\openssl.cnf
  Destination=%MAINDIR%\bin\openssl.cnf
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\OpenSSL-License.txt
  Destination=%MAINDIR%\bin\OpenSSL-License.txt
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\SecureBlackbox.dll
  Destination=%MAINDIR%\bin\SecureBlackbox.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\SecureBlackbox.SSLCommon.dll
  Destination=%MAINDIR%\bin\SecureBlackbox.SSLCommon.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\SecureBlackbox.SSLServer.dll
  Destination=%MAINDIR%\bin\SecureBlackbox.SSLServer.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\SecureBlackbox.Mail.dll
  Destination=%MAINDIR%\bin\SecureBlackbox.Mail.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\SecureBlackbox.MIME.dll
  Destination=%MAINDIR%\bin\SecureBlackbox.MIME.dll
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\webhost.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\bin\webhost.exe
  Command Line=/uninstall
  Flags=00000110
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\enbweb.exe
  Flags=00000100
end
item: Execute Program
  Pathname=%MAINDIR%\bin\enbweb.exe
  Command Line=/stop
  Flags=00000110
end
item: Execute Program
  Pathname=%MAINDIR%\bin\enbweb.exe
  Command Line=/uninstall
  Flags=00000110
end
item: End Block
end
item: Install File
  Source=V:\bin\EnbWeb.exe
  Destination=%MAINDIR%\bin\EnbWeb.exe
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\EnbWeb.exe.config
  Destination=%MAINDIR%\bin\EnbWeb.exe.config
  Flags=0000000010000010
end
item: Insert Line into Text File
  Pathname=%MAINDIR%\bin\EnbWeb.exe.config
  New Text=DefaultPort="%ENBWEB_PORT%"
  Search Text=DefaultPort="8081"
  Line Number=0
  Flags=00101010
end
item: Insert Line into Text File
  Pathname=%MAINDIR%\EnbWeb.exe.config
  New Text=Domain="%ENBWEB_DOMAIN%"
  Search Text=Domain="integration.local"
  Line Number=0
  Flags=00101010
end
item: Delete File
  Pathname=%MAINDIR%\WebHost.exe.config
end
item: Delete File
  Pathname=%MAINDIR%\WebHost.exe
end
item: Remark
end
item: Remark
  Text=Assembly containing English resource strings
end
item: Install File
  Source=V:\www\bin\WebPages.dll
  Destination=%MAINDIR%\www\bin\WebPages.dll
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Assembly containing RestData API
end
item: Install File
  Source=V:\bin\RESTData.dll
  Destination=%MAINDIR%\bin\RESTData.dll
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Assembly containing English resource strings
end
item: Install File
  Source=V:\bin\PageResources.dll
  Destination=%MAINDIR%\bin\PageResources.dll
  Flags=0000000010000010
end
item: Remark
  Text=Satellite assemblies for specific languages
end
item: Install File
  Source=V:\bin\es\PageResources.resources.dll
  Destination=%MAINDIR%\bin\es\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\fr\PageResources.resources.dll
  Destination=%MAINDIR%\bin\fr\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\id\PageResources.resources.dll
  Destination=%MAINDIR%\bin\id\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\it-IT\PageResources.resources.dll
  Destination=%MAINDIR%\bin\it-IT\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\pt-BR\PageResources.resources.dll
  Destination=%MAINDIR%\bin\pt-BR\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\ru\PageResources.resources.dll
  Destination=%MAINDIR%\bin\ru\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\sl\PageResources.resources.dll
  Destination=%MAINDIR%\bin\sl\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\th\PageResources.resources.dll
  Destination=%MAINDIR%\bin\th\PageResources.resources.dll
  Flags=0000000010000010
end
item: Install File
  Source=V:\bin\zh-CHS\PageResources.resources.dll
  Destination=%MAINDIR%\bin\zh-CHS\PageResources.resources.dll
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Web files
end
item: Install File
  Source=V:\www\css\Enabler.css
  Destination=%MAINDIR%\www\css\Enabler.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\EnablerPrintReport.css
  Destination=%MAINDIR%\www\css\EnablerPrintReport.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\EnablerReport.css
  Destination=%MAINDIR%\www\css\EnablerReport.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\EnablerSiteMonitor.css
  Destination=%MAINDIR%\www\css\EnablerSiteMonitor.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\EnablerTable.css
  Destination=%MAINDIR%\www\css\EnablerTable.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\Login.css
  Destination=%MAINDIR%\www\css\Login.css
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\css\menu.css
  Destination=%MAINDIR%\www\css\menu.css
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\images\bluecircle.png
  Destination=%MAINDIR%\www\images\bluecircle.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\down.png
  Destination=%MAINDIR%\www\images\down.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ar.jpg
  Destination=%MAINDIR%\www\images\flag_ar.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_au.jpg
  Destination=%MAINDIR%\www\images\flag_au.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_bo.jpg
  Destination=%MAINDIR%\www\images\flag_bo.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_br.jpg
  Destination=%MAINDIR%\www\images\flag_br.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ca.jpg
  Destination=%MAINDIR%\www\images\flag_ca.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_cl.jpg
  Destination=%MAINDIR%\www\images\flag_cl.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_cn.jpg
  Destination=%MAINDIR%\www\images\flag_cn.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_el.jpg
  Destination=%MAINDIR%\www\images\flag_el.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_es.jpg
  Destination=%MAINDIR%\www\images\flag_es.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_fi.jpg
  Destination=%MAINDIR%\www\images\flag_fi.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_fr.jpg
  Destination=%MAINDIR%\www\images\flag_fr.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_gb.jpg
  Destination=%MAINDIR%\www\images\flag_gb.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_gu.jpg
  Destination=%MAINDIR%\www\images\flag_gu.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_hk.jpg
  Destination=%MAINDIR%\www\images\flag_hk.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_id.jpg
  Destination=%MAINDIR%\www\images\flag_id.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_in.jpg
  Destination=%MAINDIR%\www\images\flag_in.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ir.jpg
  Destination=%MAINDIR%\www\images\flag_ir.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_it.jpg
  Destination=%MAINDIR%\www\images\flag_it.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ml.jpg
  Destination=%MAINDIR%\www\images\flag_ml.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_mx.jpg
  Destination=%MAINDIR%\www\images\flag_mx.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_nz.jpg
  Destination=%MAINDIR%\www\images\flag_nz.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_om.jpg
  Destination=%MAINDIR%\www\images\flag_om.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_pe.jpg
  Destination=%MAINDIR%\www\images\flag_pe.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ph.jpg
  Destination=%MAINDIR%\www\images\flag_ph.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_pk.jpg
  Destination=%MAINDIR%\www\images\flag_pk.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_ru.jpg
  Destination=%MAINDIR%\www\images\flag_ru.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_si.jpg
  Destination=%MAINDIR%\www\images\flag_si.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_th.jpg
  Destination=%MAINDIR%\www\images\flag_th.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_us.jpg
  Destination=%MAINDIR%\www\images\flag_us.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\flag_za.jpg
  Destination=%MAINDIR%\www\images\flag_za.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\folder.gif
  Destination=%MAINDIR%\www\images\folder.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\greenarrow.png
  Destination=%MAINDIR%\www\images\GreenArrow.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\greentick.png
  Destination=%MAINDIR%\www\images\GreenTick.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\greenticksmall.png
  Destination=%MAINDIR%\www\images\GreenTickSmall.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\IncompleteSmall.png
  Destination=%MAINDIR%\www\images\IncompleteSmall.png
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%INST%\branding\logo-web.png
  Flags=00000100
end
item: Copy Local File
  Source=%INST%\branding\logo-web.png
  Destination=%MAINDIR%\www\images\logo.png
  Flags=0000000011000010
end
item: Else Statement
end
item: Install File
  Source=V:\www\images\logo.png
  Destination=%MAINDIR%\www\images\logo.png
  Flags=0000000010000010
end
item: End Block
end
item: Install File
  Source=V:\www\images\pumpx-animate.gif
  Destination=%MAINDIR%\www\images\pumpx-animate.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\RedCross.png
  Destination=%MAINDIR%\www\images\RedCross.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\RedCrossSmall.png
  Destination=%MAINDIR%\www\images\RedCrossSmall.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tools32.PNG
  Destination=%MAINDIR%\www\images\tools32.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tableft.gif
  Destination=%MAINDIR%\www\images\tableft.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tableft.jpg
  Destination=%MAINDIR%\www\images\TabLeft.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tableftactive.gif
  Destination=%MAINDIR%\www\images\tableftactive.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\TabLeftActive.jpg
  Destination=%MAINDIR%\www\images\TabLeftActive.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tabright.gif
  Destination=%MAINDIR%\www\images\tabright.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\TabRight.jpg
  Destination=%MAINDIR%\www\images\TabRight.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tabrightactive.gif
  Destination=%MAINDIR%\www\images\tabrightactive.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\TabRightActive.jpg
  Destination=%MAINDIR%\www\images\TabRightActive.jpg
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\text.gif
  Destination=%MAINDIR%\www\images\text.gif
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\textfolder.gif
  Destination=%MAINDIR%\www\images\textfolder.gif
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\images\icons\critical.PNG
  Destination=%MAINDIR%\www\images\icons\critical.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\icons\error.PNG
  Destination=%MAINDIR%\www\images\icons\error.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\icons\information.PNG
  Destination=%MAINDIR%\www\images\icons\information.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\icons\warning.PNG
  Destination=%MAINDIR%\www\images\icons\warning.PNG
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\images\pump\authed.png
  Destination=%MAINDIR%\www\images\pump\authed.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\AuthedDisabled.png
  Destination=%MAINDIR%\www\images\pump\AuthedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\calling.png
  Destination=%MAINDIR%\www\images\pump\calling.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\calling1.png
  Destination=%MAINDIR%\www\images\pump\calling1.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\CallingDisabled.png
  Destination=%MAINDIR%\www\images\pump\CallingDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\DeliveringDisabled.png
  Destination=%MAINDIR%\www\images\pump\DeliveringDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\deliverying.png
  Destination=%MAINDIR%\www\images\pump\deliverying.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\error.png
  Destination=%MAINDIR%\www\images\pump\error.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\errordelivery.png
  Destination=%MAINDIR%\www\images\pump\errordelivery.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\invalidprice.png
  Destination=%MAINDIR%\www\images\pump\invalidprice.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\MECHANICAL.png
  Destination=%MAINDIR%\www\images\pump\MECHANICAL.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\notinstalled.png
  Destination=%MAINDIR%\www\images\pump\notinstalled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\nozout.png
  Destination=%MAINDIR%\www\images\pump\nozout.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\nozzle.png
  Destination=%MAINDIR%\www\images\pump\nozzle.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\NozzleDisabled.png
  Destination=%MAINDIR%\www\images\pump\NozzleDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\NozzleOutDisabled1.png
  Destination=%MAINDIR%\www\images\pump\NozzleOutDisabled1.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\NozzleOutDisabled2.png
  Destination=%MAINDIR%\www\images\pump\NozzleOutDisabled2.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PREAUTHAUTH.png
  Destination=%MAINDIR%\www\images\pump\PREAUTHAUTH.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PreauthAuthedDisabled.png
  Destination=%MAINDIR%\www\images\pump\PreauthAuthedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PREAUTHDEL.png
  Destination=%MAINDIR%\www\images\pump\PREAUTHDEL.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PreauthDeliveringDisabled.png
  Destination=%MAINDIR%\www\images\pump\PreauthDeliveringDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PREAUTHRES.png
  Destination=%MAINDIR%\www\images\pump\PREAUTHRES.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PreauthReservedDisabled.png
  Destination=%MAINDIR%\www\images\pump\PreauthReservedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\prepayauth.png
  Destination=%MAINDIR%\www\images\pump\prepayauth.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PrepayAuthedDisabled.png
  Destination=%MAINDIR%\www\images\pump\PrepayAuthedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PREPAYDEL.png
  Destination=%MAINDIR%\www\images\pump\PREPAYDEL.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PrepayDeliveringDisabled.png
  Destination=%MAINDIR%\www\images\pump\PrepayDeliveringDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\prepayres.png
  Destination=%MAINDIR%\www\images\pump\prepayres.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\PrepayReservedDisabled.png
  Destination=%MAINDIR%\www\images\pump\PrepayReservedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\pricechange.png
  Destination=%MAINDIR%\www\images\pump\pricechange.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\pumpbusy.png
  Destination=%MAINDIR%\www\images\pump\pumpbusy.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\refundlost.png
  Destination=%MAINDIR%\www\images\pump\refundlost.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\RefundLostDisabled.png
  Destination=%MAINDIR%\www\images\pump\RefundLostDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\stopped.png
  Destination=%MAINDIR%\www\images\pump\stopped.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\stopped1.png
  Destination=%MAINDIR%\www\images\pump\stopped1.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\Stopped1Disabled.png
  Destination=%MAINDIR%\www\images\pump\Stopped1Disabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\stopped2.png
  Destination=%MAINDIR%\www\images\pump\stopped2.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\Stopped2Disabled.png
  Destination=%MAINDIR%\www\images\pump\Stopped2Disabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\StoppedDisabled.png
  Destination=%MAINDIR%\www\images\pump\StoppedDisabled.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\TotalsLost.png
  Destination=%MAINDIR%\www\images\pump\TotalsLost.png
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\pump\undefinederror.png
  Destination=%MAINDIR%\www\images\pump\undefinederror.png
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\images\tankgauge\capacity.PNG
  Destination=%MAINDIR%\www\images\tankgauge\capacity.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tankgauge\ullage.PNG
  Destination=%MAINDIR%\www\images\tankgauge\ullage.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tankgauge\volume.PNG
  Destination=%MAINDIR%\www\images\tankgauge\volume.PNG
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\images\tankgauge\water.PNG
  Destination=%MAINDIR%\www\images\tankgauge\water.PNG
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\reports\DailyTankReport.xsl
  Destination=%MAINDIR%\www\reports\DailyTankReport.xsl
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\scripts\ActivationScripts.js
  Destination=%MAINDIR%\www\scripts\ActivationScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\AttendantTotalsScripts.js
  Destination=%MAINDIR%\www\scripts\AttendantTotalsScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\BlockingScripts.js
  Destination=%MAINDIR%\www\scripts\BlockingScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\CommonScripts.js
  Destination=%MAINDIR%\www\scripts\CommonScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\datepicker.js
  Destination=%MAINDIR%\www\scripts\datepicker.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\EventReportScripts.js
  Destination=%MAINDIR%\www\scripts\EventReportScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\FuelReconDataScripts.js
  Destination=%MAINDIR%\www\scripts\FuelReconDataScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\FuelReconMeter.js
  Destination=%MAINDIR%\www\scripts\FuelReconMeter.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\FuelTransactionScripts.js
  Destination=%MAINDIR%\www\scripts\FuelTransactionScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\GradesScripts.js
  Destination=%MAINDIR%\www\scripts\GradesScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\GridSelector.js
  Destination=%MAINDIR%\www\scripts\GridSelector.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\jquery.js
  Destination=%MAINDIR%\www\scripts\jquery.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\PortScripts.js
  Destination=%MAINDIR%\www\scripts\PortScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\PumpScripts.js
  Destination=%MAINDIR%\www\scripts\PumpScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\PumpTotalsScripts.js
  Destination=%MAINDIR%\www\scripts\PumpTotalsScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\SiteConfigurationScripts.js
  Destination=%MAINDIR%\www\scripts\SiteConfigurationScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\SiteModesScripts.js
  Destination=%MAINDIR%\www\scripts\SiteModesScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\sitemonitor.js
  Destination=%MAINDIR%\www\scripts\sitemonitor.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\TagControllersScripts.js
  Destination=%MAINDIR%\www\scripts\TagControllersScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\TankGaugeScripts.js
  Destination=%MAINDIR%\www\scripts\TankGaugeScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\TankScripts.js
  Destination=%MAINDIR%\www\scripts\TankScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\TankTotalsScripts.js
  Destination=%MAINDIR%\www\scripts\TankTotalsScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\TerminalScripts.js
  Destination=%MAINDIR%\www\scripts\TerminalScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\UsersScripts.js
  Destination=%MAINDIR%\www\scripts\UsersScripts.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\WetstockPumpData.js
  Destination=%MAINDIR%\www\scripts\WetstockPumpData.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\WetstockTankData.js
  Destination=%MAINDIR%\www\scripts\WetstockTankData.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\FuelReconDips.js
  Destination=%MAINDIR%\www\scripts\FuelReconDips.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\GradePrices.js
  Destination=%MAINDIR%\www\scripts\GradePrices.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\FuelReconMovements.js
  Destination=%MAINDIR%\www\scripts\FuelReconMovements.js
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\scripts\AttendantScripts.js
  Destination=%MAINDIR%\www\scripts\AttendantScripts.js
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\favicon.ico
  Destination=%MAINDIR%\www\favicon.ico
  Flags=0000000010000010
end
item: Remark
end
item: Install File
  Source=V:\www\Activate.aspx
  Destination=%MAINDIR%\www\Activate.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Attendants.aspx
  Destination=%MAINDIR%\www\Attendants.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\AttendantTotals.aspx
  Destination=%MAINDIR%\www\AttendantTotals.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Blocking.aspx
  Destination=%MAINDIR%\www\Blocking.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\BlockingStatus.aspx
  Destination=%MAINDIR%\www\BlockingStatus.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Cards.aspx
  Destination=%MAINDIR%\www\Cards.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Contacts.aspx
  Destination=%MAINDIR%\www\Contacts.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\DeliveryHistory.aspx
  Destination=%MAINDIR%\www\DeliveryHistory.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Events.aspx
  Destination=%MAINDIR%\www\Events.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Fallback.aspx
  Destination=%MAINDIR%\www\Fallback.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\FuelReconData.aspx
  Destination=%MAINDIR%\www\FuelReconData.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\FuelReconDips.aspx
  Destination=%MAINDIR%\www\FuelReconDips.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\FuelReconMeters.aspx
  Destination=%MAINDIR%\www\FuelReconMeters.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\FuelReconMovements.aspx
  Destination=%MAINDIR%\www\FuelReconMovements.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\FuelTransactionHistory.aspx
  Destination=%MAINDIR%\www\FuelTransactionHistory.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\GradePricesScheduled.aspx
  Destination=%MAINDIR%\www\GradePricesScheduled.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\GradePrices.aspx
  Destination=%MAINDIR%\www\GradePrices.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Grades.aspx
  Destination=%MAINDIR%\www\Grades.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Language.aspx
  Destination=%MAINDIR%\www\Language.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Login.aspx
  Destination=%MAINDIR%\www\Login.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Logoff.aspx
  Destination=%MAINDIR%\www\Logoff.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\MonitorState.aspx
  Destination=%MAINDIR%\www\MonitorState.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Ports.aspx
  Destination=%MAINDIR%\www\Ports.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Pumps.aspx
  Destination=%MAINDIR%\www\Pumps.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\PumpTotals.aspx
  Destination=%MAINDIR%\www\PumpTotals.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SiteConfiguration.aspx
  Destination=%MAINDIR%\www\SiteConfiguration.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SiteModes.aspx
  Destination=%MAINDIR%\www\SiteModes.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SiteModeChange.aspx
  Destination=%MAINDIR%\www\SiteModeChange.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SiteMonitor.aspx
  Destination=%MAINDIR%\www\SiteMonitor.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SiteSettings.aspx
  Destination=%MAINDIR%\www\SiteSettings.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\SystemStatus.aspx
  Destination=%MAINDIR%\www\SystemStatus.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Tags.aspx
  Destination=%MAINDIR%\www\Tags.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\TagControllers.aspx
  Destination=%MAINDIR%\www\TagControllers.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\TankGauges.aspx
  Destination=%MAINDIR%\www\TankGauges.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\TankTotals.aspx
  Destination=%MAINDIR%\www\TankTotals.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Tanks.aspx
  Destination=%MAINDIR%\www\Tanks.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Terminals.aspx
  Destination=%MAINDIR%\www\Terminals.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\Users.aspx
  Destination=%MAINDIR%\www\Users.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\WetstockPumpData.aspx
  Destination=%MAINDIR%\www\WetstockPumpData.aspx
  Flags=0000000010000010
end
item: Install File
  Source=V:\www\WetstockTankData.aspx
  Destination=%MAINDIR%\www\WetstockTankData.aspx
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Add firewall rules for Enabler Pump Server and EnbWeb
end
item: Remark
  Text=NOTE: 5.1 = Windows XP
end
item: Remark
  Text=NOTE: 5.2 = Windows 2003
end
item: Remark
  Text=NOTE: 6.0 = Windows Vista or Windows Server 2008
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Adding Windows Firewall Rules...
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=Please wait...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: If/While Statement
  Variable=OPERATING_SYSTEM
  Value=6.0
  Flags=00000111
end
item: Add Text to INSTALL.LOG
  Text=Updating Windows Advanced Firewall Rules
end
item: Remark
  Text=New Advanced Firewall (Vista and later) - need to delete previous rules to avoid duplicates.
end
item: Execute Program
  Pathname=netsh
  Command Line=advfirewall firewall delete rule name="Enabler Web Server" program=%MAINDIR%\bin\enbweb.exe
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Removed old Firewall rule for Web Server (%INSTALL_RESULT%)
end
item: Execute Program
  Pathname=netsh
  Command Line=advfirewall firewall delete rule name="Enabler Pump Server" program=%MAINDIR%\bin\psrvr4.exe
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Removed old Firewall rule for Pump Server (%INSTALL_RESULT%)
end
item: Execute Program
  Pathname=netsh
  Command Line=advfirewall firewall add rule name="Enabler Web Server" dir=in action=allow program=%MAINDIR%\bin\enbweb.exe enable=yes
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Added Firewall rule for Web Server (%INSTALL_RESULT%)
end
item: Execute Program
  Pathname=netsh
  Command Line=advfirewall firewall add rule name="Enabler Pump Server" dir=in action=allow program=%MAINDIR%\bin\psrvr4.exe enable=yes
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Added Firewall rule for Pump Server (%INSTALL_RESULT%)
end
item: Else Statement
end
item: Remark
  Text=Windows XP style firewall
end
item: Add Text to INSTALL.LOG
  Text=Updating Windows Firewall Rules
end
item: Execute Program
  Pathname=netsh
  Command Line=firewall set allowedprogram program=%MAINDIR%\bin\enbweb.exe name="Enabler Web Server" mode=enable
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Updated Firewall rule for Web Server (%INSTALL_RESULT%)
end
item: Execute Program
  Pathname=netsh
  Command Line=firewall set allowedprogram program=%MAINDIR%\bin\psrvr4.exe name="Enabler Pump Server" mode=enable
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Updated Firewall rule for Pump Server (%INSTALL_RESULT%)
end
item: End Block
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Initialising Installer
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Obsolete or renamed files
end
item: Delete File
  Pathname=%MAINDIR%\www\Welcome.aspx
end
item: Remark
end
item: Remark
  Text=Pump Update install - to run
end
item: Install File
  Source=V:\update\PumpUpdate.exe
  Destination=%MAINDIR%\PumpUpdate.exe
  Flags=0000000010000010
end
item: Remark
  Text=Blank file - is not easy to get Wise Installer to create a blank file.
end
item: Install File
  Source=V:\update\PumpUpdate.ini
  Destination=%MAINDIR%\PumpUpdate.ini
  Flags=0000010010010010
end
item: Else Statement
end
item: Remark
  Text=Corresponding registry keys for client installs
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_SERVER %SERVER_NAME% -M
  Flags=00001010
end
item: Edit Registry
  Total Keys=4
  item: Key
    Key=Software
    Root=2
  end
  item: Key
    Key=Software\ITL
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SERVER_NAME%
    Value Name=ServerName
    Root=2
  end
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Install the DLL that contains the message ids for the Enabler Windows custom log
end
item: Install File
  Source=V:\bin\EnablerEvent.dll
  Destination=%MAINDIR%\bin\EnablerEvent.dll
  Flags=0000000010000010
end
item: Remark
  Text=These files are needed later so install them here
end
item: Install File
  Source=V:\bin\subinacl.exe
  Destination=%MAINDIR%\bin\subinacl.exe
  Flags=0000000010000010
end
item: Install File
  Source=V:\CreateRegKeyEvent.bat
  Destination=%MAINDIR%\CreateRegKeyEvent.bat
  Flags=0000000010000010
end
item: Remark
end
item: Add Text to INSTALL.LOG
  Text=Group Path %GROUP%
end
item: Add Text to INSTALL.LOG
  Text=Group Directory %GROUPDIR%
end
item: Add Text to INSTALL.LOG
  Text=Desktop Path %DESKTOPDIR%
end
item: Add Text to INSTALL.LOG
  Text=Start Menu Path %STARTMENUDIR%
end
item: Remark
end
item: Remark
  Text=Delete any Start menu links
end
item: Delete File
  Pathname=%GROUP%\*
  Flags=00001100
end
item: Delete File
  Pathname=%GROUPDIR%\The Enabler\*
end
item: Remark
end
item: Remark
  Text=Create shortcut to web apps
end
item: If/While Statement
  Variable=SERVER_NAME
end
item: Create Shortcut
  Source=http://localhost:%ENBWEB_PORT%
  Destination=%GROUP%\Enabler Web.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=http://localhost:%ENBWEB_PORT%/WetstockTankData.aspx
  Destination=%GROUP%\Wet Stock Management.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=http://localhost:%ENBWEB_PORT%/GradePricesScheduled.aspx
  Destination=%GROUP%\Grade Pricing.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=http://localhost:%ENBWEB_PORT%/SiteMonitor.aspx
  Destination=%GROUP%\Site Monitor.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Else Statement
end
item: If/While Statement
  Variable=CLIENTEMBEDDED
  Value=A
  Flags=00000011
end
item: Remark
  Text=Default Server Desktop Web Port to :8081
end
item: Set Variable
  Variable=ENBWEB_PORT_STR
  Value=:8081
end
item: Create Shortcut
  Source=http://%SERVER_NAME%%ENBWEB_PORT_STR%/WetstockTankData.aspx
  Destination=%GROUP%\Wet Stock Management.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Else Statement
end
item: Remark
  Text=Embedded uses Default port (80) - so no port required
end
item: Set Variable
  Variable=ENBWEB_PORT_STR
end
item: End Block
end
item: Create Shortcut
  Source=http://%SERVER_NAME%%ENBWEB_PORT_STR%
  Destination=%GROUP%\Enabler Web.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=http://%SERVER_NAME%%ENBWEB_PORT_STR%/GradePricesScheduled.aspx
  Destination=%GROUP%\Grade Pricing.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=http://%SERVER_NAME%%ENBWEB_PORT_STR%/SiteMonitor.aspx
  Destination=%GROUP%\Site Monitor.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\itl.ico
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove old EXE applications (if they are present)
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\EnbConfig.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\EnbConfig.exe
end
item: Delete File
  Pathname=%DESKTOPDIR%\Enabler Configuration.Ink
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\enbmaint.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\EnbMaint.exe
end
item: Delete File
  Pathname=%DESKTOPDIR%\Enabler Management.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\EnbBlockMgr.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\EnbBlockMgr.exe
end
item: Delete File
  Pathname=%DESKTOPDIR%\Enabler Block Manager.lnk
  Flags=00001000
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\FCMan.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\FCMan.exe
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\FuelReconReport.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\FuelReconReport.exe
  Flags=00001000
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\FuelRecon.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\FuelRecon.exe
  Flags=00001000
end
item: Delete File
  Pathname=%DESKTOPDIR%\Fuel Reconciliation.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\wetstk.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\wetstk.exe
end
item: Delete File
  Pathname=%DESKTOPDIR%\Wetstock Maintenance.lnk
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Create a variable to determine if the pdf reader needs associating
end
item: Install File
  Source=v:\Extra\PDFViewer.exe
  Destination=%MAINDIR%\bin\PDFViewer.exe
  Flags=0000000010000010
end
item: Remark
end
item: Remark
  Text=Set the SDK_OPTIONS variable
end
item: Remark
  Text=Set this varible Below to the applications you would like installed when SDK is checked,  both Client & Server versions now
end
item: Remark
  Text=A - MPPSim
end
item: Remark
  Text=B - Pumpdemo
end
item: Remark
  Text=C - Documents (This includes all SDK documents and sample code)
end
item: If/While Statement
  Variable=SDK
  Value=A
  Flags=00000010
end
item: Set Variable
  Variable=SDK_OPTIONS
  Value=ABC
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: If/While Statement
  Variable=ICONS
  Value=B
  Flags=00000010
end
item: If/While Statement
  Variable=OS
  Value=32
end
item: Create Shortcut
  Source=%MAINDIR%\ExpressUpdate.exe
  Destination=%GROUP%\Tools\Firmware Update for Express.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\ExpressUpdate.exe
  Key Type=1536
  Flags=00000001
end
item: Else Statement
end
item: Create Shortcut
  Source=%MAINDIR%\ExpressUpdatex64.exe
  Destination=%GROUP%\Tools\Firmware Update for Express-x64.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\ExpressUpdatex64.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Create Shortcut
  Source=%MAINDIR%\PCIUpdate.exe
  Destination=%GROUP%\Tools\Firmware Update for PCI.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\PCIUpdate.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: If/While Statement
  Variable=ICONS
  Value=A
  Flags=00000010
end
item: If/While Statement
  Variable=OS
  Value=32
end
item: Create Shortcut
  Source=%MAINDIR%\ExpressUpdate.exe
  Destination=%DESKTOPDIR%\Firmware Update for Express.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\ExpressUpdate.exe
  Key Type=1536
  Flags=00000001
end
item: Else Statement
end
item: Create Shortcut
  Source=%MAINDIR%\ExpressUpdatex64.exe
  Destination=%DESKTOPDIR%\Tools\Firmware Update for Express-x64.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\ExpressUpdatex64.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Create Shortcut
  Source=%MAINDIR%\PCIUpdate.exe
  Destination=%DESKTOPDIR%\Firmware Update for PCI.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\PCIUpdate.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Install the SDK applications (based on client/server install)
end
item: Remark
  Text=Install MPPSIM and Driver DLL
end
item: If/While Statement
  Variable=SDK_OPTIONS
  Value=A
  Flags=00000010
end
item: Install File
  Source=v:\MPPSim.exe
  Destination=%MAINDIR%\MPPSim.exe
  Flags=0000000010000010
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Install File
  Source=v:\ITLMPPSim.dll
  Destination=%MAINDIR%\ITLMPPSim.dll
  Flags=0001000010100010
end
item: End Block
end
item: Delete File
  Pathname=%GROUP%\MPPSim.lnk
end
item: Delete File
  Pathname=%GROUP%\Pump Simulator.lnk
end
item: If/While Statement
  Variable=ICONS
  Value=B
  Flags=00000010
end
item: Create Shortcut
  Source=%MAINDIR%\MPPSim.exe
  Destination=%GROUP%\Pump Simulator.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\MPPSim.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: If/While Statement
  Variable=ICONS
  Value=A
  Flags=00000010
end
item: Create Shortcut
  Source=%MAINDIR%\MPPSim.exe
  Destination=%DESKTOPDIR%\Pump Simulator.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\MPPSim.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Else Statement
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\ITLMPPSim.dll
  Flags=01000100
end
item: Execute Program
  Pathname=regsvr32
  Command Line=/u /s %MAINDIR%\ITLMPPSim.dll
  Flags=00001010
end
item: Delete File
  Pathname=%MAINDIR%\ITLMPPSim.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\ITLMPPSim.dll
  Flags=01000100
end
item: Execute Program
  Pathname=regsvr32
  Command Line=/u /s %MAINDIR%\bin\ITLMPPSim.dll
  Flags=00001010
end
item: Delete File
  Pathname=%MAINDIR%\bin\ITLMPPSim.dll
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\MPPSim.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\MPPSim.exe
end
item: Delete File
  Pathname=%GROUP%\MPPSim.lnk
end
item: Delete File
  Pathname=%GROUP%\Pump Simulator.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\MPPSim.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\Pump Simulator.lnk
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Install Pumpdemo
end
item: If/While Statement
  Variable=SDK_OPTIONS
  Value=B
  Flags=00000010
end
item: Install File
  Source=v:\pumpdemo.exe
  Destination=%MAINDIR%\pumpdemo.exe
  Flags=0000000010000010
end
item: Delete File
  Pathname=%GROUP%\Pump Demo.lnk
end
item: Remark
  Text=Enabler 4 pump demo
end
item: Install File
  Source=v:\PumpDemoWPF.exe
  Destination=%MAINDIR%\PumpDemoWPF.exe
  Flags=0000000010000010
end
item: Install File
  Source=v:\SampleCom.exe
  Destination=%MAINDIR%\SampleCom.exe
  Flags=0000000010000010
end
item: Remark
  Text=Enabler 4 pump demo Java - including dependencies
end
item: Install File
  Source=v:\pumpdemo.jar
  Destination=%MAINDIR%\pumpdemo.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\enabler-pmp-ctrl-1.0.jar
  Destination=%MAINDIR%\enabler-pmp-ctrl-1.0.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\forms-1.3.0.jar
  Destination=%MAINDIR%\forms-1.3.0.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\glazedlists-1.8.0_java15.jar
  Destination=%MAINDIR%\glazedlists-1.8.0_java15.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\icu4j-49_1.jar
  Destination=%MAINDIR%\icu4j-49_1.jar
  Flags=0000000010000010
end
item: Install File
  Source=v:\miglayout15-swing.jar
  Destination=%MAINDIR%\miglayout15-swing.jar
  Flags=0000000010000010
end
item: Remark
end
item: If/While Statement
  Variable=ICONS
  Value=B
  Flags=00000010
end
item: Create Shortcut
  Source=%MAINDIR%\pumpdemo.exe
  Destination=%GROUP%\Pump Demo.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\pumpdemo.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\PumpDemoWPF.exe
  Destination=%GROUP%\Pump Demo WPF.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\PumpDemoWPF.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\SampleCom.exe
  Destination=%GROUP%\Sample COM.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\vbComApiText.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\PumpDemo.jar
  Destination=%GROUP%\Pump Demo (Java).lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\vbComApiText.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: If/While Statement
  Variable=ICONS
  Value=A
  Flags=00000010
end
item: Create Shortcut
  Source=%MAINDIR%\pumpdemo.exe
  Destination=%DESKTOPDIR%\Pump Demo.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\pumpdemo.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\PumpDemoWPF.exe
  Destination=%DESKTOPDIR%\Pump Demo WPF.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\pumpdemo.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\SampleCom.exe
  Destination=%DESKTOPDIR%\Sample COM.lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\vbComApiTest.exe
  Key Type=1536
  Flags=00000001
end
item: Create Shortcut
  Source=%MAINDIR%\pumpdemo.jar
  Destination=%DESKTOPDIR%\Pump Demo (Java).lnk
  Icon Number=0
  Icon Pathname=%MAINDIR%\pumpdemo.exe
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Else Statement
end
item: Remark
  Text=Remove PumpDemo and links if it was not selected for this install
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\pumpdemo.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\pumpdemo.exe
end
item: Delete File
  Pathname=%GROUP%\Pump Demo.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\Pump Demo.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\PumpDemoWPF.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\PumpDemoWPF.exe
end
item: Delete File
  Pathname=%GROUP%\Pump Demo WPF.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\Pump Demo WPF.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SampleCom.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\SampleCom.exe
end
item: Delete File
  Pathname=%GROUP%\Sample COM.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\Sample COM.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\pumpdemo.jar
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\pumpdemo.jar
end
item: Delete File
  Pathname=%GROUP%\Pump Demo (Java).lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\Pump Demo (Java).lnk
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove vbComOleAPI sample if it exists - this has been renamed to SampleCOM
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\vbcomapitest.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\vbcomapitest.exe
end
item: Delete File
  Pathname=%DESKTOPDIR%\Pump COM/OLE API Test.lnk
end
item: Delete File
  Pathname=%GROUP%\Pump COM/OLE API Test.lnk
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove Pumpdemo2.exe if it exists - this is obsolete
end
item: Delete File
  Pathname=%MAINDIR%\pumpdemo2.exe
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL USER DOCUMENTATION - BOTH CLIENT AND SERVER INSTALLS GET THIS
end
item: Remark
  Text===========================================
end
item: Check if File/Dir Exists
  Pathname=%INST%\Documentation
  Flags=01000101
end
item: Check if File/Dir Exists
  Pathname=%INST%\Documentation\ENABLER Demonstration POS Application Reference Manual.pdf
  Flags=01000100
end
item: Copy Local File
  Source=%INST%\Documentation\ENABLER Demonstration POS Application Reference Manual.pdf
  Destination=%MAINDIR%\Doc\ENABLER Demonstration POS Application Reference Manual.pdf
  Flags=0000000011000010
end
item: Create Shortcut
  Source=%MAINDIR%\doc\ENABLER Demonstration POS Application Reference Manual.pdf
  Destination=%GROUP%\Manuals\Demonstration POS Application Reference Manual.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Remark
end
item: Check if File/Dir Exists
  Pathname=%INST%\Documentation\Enabler Web Reference Manual.pdf
  Flags=01000100
end
item: Copy Local File
  Source=%INST%\Documentation\Enabler Web Reference Manual.pdf
  Destination=%MAINDIR%\Doc\Enabler Web Reference Manual.pdf
  Flags=0000000011000010
end
item: Create Shortcut
  Source=%MAINDIR%\doc\Enabler Web Reference Manual.pdf
  Destination=%GROUP%\Manuals\Web Reference Manual.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Documentation folder not found
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Install SDK Documentation
end
item: If/While Statement
  Variable=SDK_OPTIONS
  Value=C
  Flags=00000010
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=INSTALL SDK DOCUMENTATION
end
item: Remark
  Text===========================================
end
item: Check if File/Dir Exists
  Pathname=%INST%\SDK
  Flags=01000101
end
item: Remark
end
item: Remark
  Text=Remove old SDK documentation
end
item: Delete File
  Pathname=%MAINDIR%\SDK\
  Flags=00001100
end
item: Remark
end
item: Remark
  Text=Install the new SDK documentation
end
item: Search for File
  Variable=MICROSOFT_HELP
  Pathname List=%WIN%\hh.exe
  Flags=00000110
end
item: Add Text to INSTALL.LOG
  Text=Microsoft help location: %MICROSOFT_HELP%
end
item: Copy Local File
  Source=%INST%\SDK\*
  Destination=%MAINDIR%\SDK\
  Flags=0000000111000010
end
item: Install File
  Source=V:\Extra\InnovaHxReg.exe
  Destination=%MAINDIR%\SDK\Doc\VisualStudio\InnovaHxReg.exe
  Flags=0000000010000010
end
item: If/While Statement
  Value=OS=64 And OPERATING_SYSTEM >= 6
  Flags=00001101
end
item: Execute Program
  Pathname=C:\WINDOWS\Sysnative\CMD.EXE
  Command Line=/C %MAINDIR%\SDK\Doc\VisualStudio\registerhelp2.bat
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Execute path: C:\WINDOWS\Sysnative\CMD.EXE /C %MAINDIR%\SDK\Doc\VisualStudio\unregisterhelp2.bat
end
item: Else Statement
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\SDK\Doc\VisualStudio\registerhelp2.bat
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Execute path: CMD.EXE /C %MAINDIR%\SDK\Doc\VisualStudio\unregisterhelp2.bat
end
item: End Block
end
item: If/While Statement
  Variable=ICONS
  Value=B
  Flags=00000010
end
item: Delete File
  Pathname=%GROUP%\SDK\Database Dictionary.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Developers Guide.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Developers Reference.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Hardware Setup and Installation Manual.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Embedded Getting Started Guide.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Site Installation Checklist.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Embedded Site Installation Checklist.lnk
end
item: Delete File
  Pathname=%GROUP%\SDK\Embedded REST API Reference.lnk
end
item: Remark
end
item: Remark
  Text=SDK docs common for PC and Embedded
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ActiveX\ENABLER ActiveX Developers Reference.chm
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ActiveX\ENABLER ActiveX Developers Reference.chm
  Destination=%GROUP%\SDK\V3 ActiveX Developers Reference.lnk
  Icon Number=0
  Icon Pathname=%MICROSOFT_HELP%
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\Java\JavaDoc\index.html
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\Java\JavaDoc\index.html
  Destination=%GROUP%\SDK\Java API Reference.lnk
  Icon Number=0
  Icon Pathname=%MICROSOFT_HELP%
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ENABLER Developers Reference.chm
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Developers Reference.chm
  Destination=%GROUP%\SDK\Developers Reference.lnk
  Icon Number=0
  Icon Pathname=%MICROSOFT_HELP%
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ENABLER Software Licence Agreement.pdf
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Software Licence Agreement.pdf
  Destination=%GROUP%\SDK\Licence Agreement.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=CLIENTEMBEDDED
  Value=A
  Flags=00000011
end
item: Remark
  Text=Installing SDK for PC.
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ENABLER Site Installation Checklist.pdf
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Site Installation Checklist.pdf
  Destination=%GROUP%\SDK\Site Installation Checklist.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Else Statement
end
item: Remark
  Text=Installing SDK for Embedded
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ENABLER Embedded Site Installation Checklist.pdf
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Embedded Site Installation Checklist.pdf
  Destination=%GROUP%\SDK\Embedded Site Installation Checklist.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\ENABLER Embedded Getting Started Guide.pdf
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Embedded Getting Started Guide.pdf
  Destination=%GROUP%\SDK\Embedded Getting Started Guide.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Doc\REST API Reference.chm
  Flags=01000100
end
item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\REST API Reference.chm
  Destination=%GROUP%\SDK\Embedded REST API Reference.lnk
  Icon Number=0
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: End Block
end
remarked item: Create Shortcut
  Source=%MAINDIR%\SDK\Doc\ENABLER Configuration API Reference.chm
  Destination=%GROUP%\SDK\ActiveX Configuration API Reference.lnk
  Icon Number=0
  Icon Pathname=%MICROSOFT_HELP%
  Key Type=1536
  Flags=00000001
end
item: End Block
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=SDK folder not present in installer folder
end
item: End Block
end
item: Else Statement
end
item: Remark
  Text=Not installing SDK - remove any existing files and start menu links.
end
item: Delete File
  Pathname=%MAINDIR%\SDK\
  Flags=00001100
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\SDK\Samples\
  Flags=00000101
end
item: Delete File
  Pathname=%GROUP%\SDK\
  Flags=00001100
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove OPT Simulator and DLL
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\ITLOPTSim.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\ITLOPTSim.exe
end
item: Delete File
  Pathname=%GROUP%\ITLOPTSim.lnk
end
item: Delete File
  Pathname=%DESKTOPDIR%\ITLOPTSim.lnk
end
item: End Block
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\ITLOPTSim.dll
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\ITLOPTSim.dll
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove Legacy Startmenu Link
end
item: Delete File
  Pathname=%GROUP%\Forecourt Manager.lnk
end
item: Remark
end
item: Remark
  Text=Enabler v4 always removes the CLIENT version of PSRVR
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\psrvr.exe
  Title=psrvr.exe
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\psrvr.exe
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=COMPONENTS
  Value=A
  Flags=00001010
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00000011
end
item: Remark
  Text=Client Install to Enabler (Desktop or Embedded)
end
item: Execute Program
  Pathname=%SETX_PATH%
  Command Line=ENABLER_SERVER %SERVER_NAME% -M
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
  Text=Always install ActiveX client utility - most useful for client installs.
end
item: Install File
  Source=v:\bin\enbclient.exe
  Destination=%MAINDIR%\enbclient.exe
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\enbclient.exe
  Title=Remove old EnbClient utility
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\enbclient.exe
end
item: End Block
end
item: Install File
  Source=v:\bin\Interop.IWshRuntimeLibrary.dll
  Destination=%MAINDIR%\Interop.IWshRuntimeLibrary.dll
  Flags=0000000010000010
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\bin\Interop.IWshRuntimeLibrary.dll
  Title=Remove old EnbClient DLL utility
  Flags=01000100
end
item: Delete File
  Pathname=%MAINDIR%\bin\Interop.IWshRuntimeLibrary.dll
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Setup PDF files to link to Sumatra PDF if there is no existing reader
end
item: Set Variable
  Variable=PDF
end
item: Get Registry Key Value
  Variable=PDF
  Key=.pdf
end
item: If/While Statement
  Variable=PDF
end
item: Add Text to INSTALL.LOG
  Text=There is no current PDF reader - Setting up Sumatra PDF 
end
item: Edit Registry
  Total Keys=5
  item: Key
    Key=ITLPDF.Document\Shell
  end
  item: Key
    Key=ITLPDF.Document\Shell\Open
  end
  item: Key
    Key=ITLPDF.Document\Shell\Open\Command
    New Value="%MAINDIR%\bin\PDFViewer.exe" "%%1"
    New Value=
  end
  item: Key
    Key=ITLPDF.Document
    New Value=ITL PDF Document
  end
  item: Key
    Key=ITLPDF.Document\DefaultIcon
    New Value=%MAINDIR%\bin\PDFViewer.exe
    New Value=
  end
end
item: Edit Registry
  Total Keys=1
  Key=.pdf
  New Value=ITLPDF.Document
  New Value=
end
item: Add Text to INSTALL.LOG
  Text=Sumatra pdf is now default pdf reader
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=UPDATE SYSTEM CONFIG
end
item: Remark
  Text===========================================
end
item: Remark
end
item: Remark
  Text=All OCX/DLL/EXE files that are self-registered
end
item: Self-Register OCXs/DLLs
  Description=Updating System Configuration, Please Wait...
end
item: Remark
end
item: Remark
  Text=Enabler v4 Configure default registry key for Client Username and Password
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Remark
  Text=SERVER INSTALLATION
end
item: Edit Registry
  Total Keys=2
  item: Key
    Key=SOFTWARE\ITL\Enabler\Client
    New Value=Default
    Value Name=Password
    Root=2
  end
  item: Key
    Key=SOFTWARE\ITL\Enabler\Client
    New Value=localhost
    New Value=
    Value Name=Hostname
    Root=2
  end
end
item: Else Statement
end
item: Remark
  Text=CLIENT INSTALLATION
end
item: Edit Registry
  Total Keys=2
  item: Key
    Key=SOFTWARE\ITL\Enabler\Client
    New Value=Default
    Value Name=Password
    Root=2
  end
  item: Key
    Key=SOFTWARE\ITL\Enabler\Client
    New Value=%SERVER_NAME%
    New Value=
    Value Name=Hostname
    Root=2
  end
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Setup Access Permissions
end
item: Remark
  Text===========================================
end
item: Execute Program
  Pathname=net
  Command Line=localgroup /add EnablerAdministrators
  Flags=00001010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=Setting Up Access Permissions...
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Create Enabler custom event log and grant access to the log  application and evt file
end
item: Execute Program
  Pathname=%MAINDIR%\CreateRegKeyEvent.bat
  Flags=00001010
end
item: Remark
  Text=Gives user group access to Enabler log dir and files
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=directoriesonly %MAINDIR%\log /grant=%BUILTIN_USERS_GROUP%=CRWD /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=filesonly %MAINDIR%\log\*.* /grant=%BUILTIN_USERS_GROUP%=CRWD /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
end
item: Set Variable
  Variable=LOGTIME
end
item: Get System Information
  Variable=LOGTIME
end
item: Add Text to INSTALL.LOG
  Text=Start of setting permissions %LOGTIME%
end
item: Remark
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Remark
  Text=Remove user group permissions from running enbkick, vsql and fcman
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %MAINDIR%\enbkick.exe /grant=%BUILTIN_USERS_GROUP%= /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %MAINDIR%\vsql.exe /grant=%BUILTIN_USERS_GROUP%= /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %MAINDIR%\fcman.exe /grant=%BUILTIN_USERS_GROUP%= /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
  Text=Remove Users group from sql bin dir (OSQL_PATH)
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file "%OSQL_PATH%" /grant=%BUILTIN_USERS_GROUP%= /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
  Text=Give EnablerAdministrator group full access to osql and the psrvr service
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file "%OSQL_PATH%" /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/service psrvr4 /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: End Block
end
item: Remark
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %SYS32%\eventvwr.msc  /grant=%BUILTIN_USERS_GROUP%=  /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %SYS32%\config\Enabler.evt  /grant=%BUILTIN_USERS_GROUP%= /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
  Text=Give EnablerAdministrator group full access to log dir, event viewer and Enabler event log
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=directoriesonly %MAINDIR%\log /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=filesonly %MAINDIR%\log\*.* /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
end
item: Remark
  Text=The below line was causing the permissions to be very slow.
end
item: Remark
  Text=Subinacl has a bug where running it on C:\Enabler causes it to serach all folders under C:\ and all its subfolders for folders labelled Enabler
end
item: Remark
  Text=The fix is to seperate it out and do C:\Enabler as a file which does require searching all of the root directory
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=directoriesonly %MAINDIR%\ /grant=EnablerAdministrators=F
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %MAINDIR% /grant=EnablerAdministrators=F
  Flags=00001010
end
item: Remark
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/subdirectories=filesonly %MAINDIR%\*.* /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %SYS32%\eventvwr.msc  /grant=EnablerAdministrators=E /pathexclude=C:\*.*
  Flags=00001010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\subinacl.exe
  Command Line=/file %SYS32%\config\Enabler.evt  /grant=EnablerAdministrators=F /pathexclude=C:\*.*
  Flags=00001010
end
item: Remark
end
item: Set Variable
  Variable=LOGTIME
end
item: Get System Information
  Variable=LOGTIME
end
item: Add Text to INSTALL.LOG
  Text=End of setting permissions %LOGTIME%
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Setting up Access Permissions...Complete
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Remark
  Text=SERVER INSTALLATION
end
item: Remark
end
item: Remark
  Text=We modify this component size to allow for the space needed to create the EnablerDB
end
item: Add Text to INSTALL.LOG
  Text=Installing or Updating EnablerDB
end
item: Remark
end
item: Remark
  Text=Register the Pump Server
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=%APPTITLE%
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Registering components
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Execute Program
  Pathname=%MAINDIR%\bin\psrvr4.exe
  Command Line=/service
  Flags=00000010
end
item: Execute Program
  Pathname=%MAINDIR%\bin\enbweb.exe
  Command Line=/install
  Flags=00000110
end
item: Add Text to INSTALL.LOG
  Text=Update Services Start timout setting
end
item: Edit Registry
  Total Keys=1
  Key=SYSTEM\CurrentControlSet\Control
  New Value=180000
  Value Name=ServicesPipeTimeout
  Root=2
  Data Type=3
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=CONFIRM SQL SERVER RUNNING
end
item: Remark
  Text===========================================
end
item: Remark
  Text=NOTE: This is a copy of whats just after the database password check
end
item: If/While Statement
  Variable=SQL_INSTANCE
end
item: Add Text to INSTALL.LOG
  Text=Confirming MSSQLSERVER service is running
end
item: Custom Script Item
  Filename=Check Service.wse
  Variable Name1=_SRV_NAME_
  Variable Value1=MSSQLSERVER
  Variable Name2=HELPFILE
  Variable Value2=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name3=_SRV_VAR_
  Variable Value3=SQLSERVER_STARTED
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Confirming MSSQL$%SQL_INSTANCE% service is running
end
item: Custom Script Item
  Filename=Check Service.wse
  Variable Name1=_SRV_NAME_
  Variable Value1=MSSQL$%SQL_INSTANCE%
  Variable Name2=HELPFILE
  Variable Value2=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name3=_SRV_VAR_
  Variable Value3=SQLSERVER_STARTED
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=SQLServer Status: %SQLSERVER_STARTED%
end
item: If/While Statement
  Variable=SQLSERVER_STARTED
  Value=Running
  Flags=00000011
end
item: Add Text to INSTALL.LOG
  Text=ERROR: SQLServer is not Running
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Display Message
  Title=Installation Stopped
  Text=Because the SQL Server is not running the installation is not able to continue.  Please check the SQL Server service is running.
  Flags=00101000
end
item: End Block
end
item: Exit Installation
  Flags=11
end
item: End Block
end
item: Remark
end
item: Remark
end
item: Remark
  Text=Setup ODBC Data source and Windows users, info for event logs
end
item: If/While Statement
  Variable=SQL_INSTANCE
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg.exe
  Flags=00001010
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg64.exe
  Flags=00001010
end
item: End Block
end
item: Else Statement
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg.exe
  Command Line=/i %SQL_INSTANCE% 
  Flags=00001010
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg64.exe
  Command Line=/i %SQL_INSTANCE% 
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Run the Nightly.bat script if the user has ticked the checkbox
end
item: If/While Statement
  Variable=PRE_UPGRADE_BACKUP
  Value=A
  Flags=00000010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Running backup script please wait
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=A pre upgrade backup will be performed (Nightly.bat)
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\Nightly.bat %SQLQUERY%
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=The Enabler
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Now do the EnablerDB install
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=%APPTITLE%
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Updating %APPTITLE% Database...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Create Directory
  Pathname=%DBDIR%
end
item: Add Text to INSTALL.LOG
  Text=Passing %OSQL_PATH% to DBInstall
end
item: Remark
  Text=We're supposed to be able to run BAT files directly, but it doesn't seem to work on WinNT
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C %MAINDIR%\DBInstall.bat "%DBDIR%" "%MAINDIR%" "%MAINDIR%\install.log" "%OSQL_PATH%"  %SQLQUERY%
  Default Directory=%MAINDIR%
  Flags=00001010
end
item: Remark
end
item: Remark
  Text=We can now check for DBINSTALL_OK and MKUPGRADE_OK files to see if the db install/upgrade worked 
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\DBINSTALL_OK
  Flags=00000101
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Enabler Database Install Failed
  Text=The Enabler database install did not complete successfully.
  Text=
  Text=Please collect the %MAINDIR%\Install.LOG / %MAINDIR%\WISE.LOG and send it to ITL for further investigation.
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR:Enabler DBInstall.BAT failed
end
item: Exit Installation
  Flags=9
end
item: End Block
end
item: Remark
end
item: Check if File/Dir Exists
  Pathname=%MAINDIR%\DBUPGRADE_OK
  Flags=00000101
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Display Message
  Title=Enabler Database Upgrade Failed
  Text=The Enabler database upgrade processing did not complete successfully.
  Text=
  Text=Please collect the %MAINDIR%\Install.LOG / %MAINDIR%\WISE.LOG and send it to ITL for further investigation.
  Flags=00101000
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=ERROR: Enabler Database Upgrade Failed
end
item: Exit Installation
  Flags=10
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Remove autoupgrade.bat to prevent anyone manually running it later on
end
item: Delete File
  Pathname=%MAINDIR%\autoupgrade.bat
end
item: Remark
end
item: If/While Statement
  Variable=SDK_OPTIONS
  Flags=00000001
end
item: Remark
  Text=Install schema documentation into database
end
item: Install File
  Source=V:\scripts\EnablerDBdoc.sql
  Destination=%MAINDIR%\EnablerDBdoc.sql
  Flags=0000000010100010
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d EnablerDB -E -S%SQLQUERY% -i "%MAINDIR%\EnablerDBdoc.sql"  -o  %MAINDIR%\EnablerDBdoc.log
  Flags=00001010
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=%APPTITLE%
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Value7=Updating %APPTITLE% Database...
  Variable Name8=_HEIGHT_
  Variable Value8=100
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Run PumpUpdate.EXE to install pump drivers and stuff.
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Forecourt Interface Update
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Value7=Installing interface drivers for supported forecourt devices.
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
  Text=For clean installs we need to pass the path to OSQL to PumpUpdate but Wise doesn't seem to cope with spaces, so we put the path in a txt file for PumpUpdate.exe to read.
end
item: Add Text to INSTALL.LOG
  Text=INFO: Putting OSQL path (%OSQL_PATH%) into PumpUpdate.INI
end
item: Edit INI File
  Pathname=%MAINDIR%\PumpUpdate.ini
  Settings=[DATABASE]
  Settings=OSQLPATH=%OSQL_PATH%
  Settings=
end
item: Add Text to INSTALL.LOG
  Text=INFO: SQL_INSTANCE variable set to '%SQL_INSTANCE%'
end
item: If/While Statement
  Variable=SQL_INSTANCE
end
item: Add Text to INSTALL.LOG
  Text=INFO: Running PumpUpdate for default instance
end
item: Execute Program
  Pathname=%MAINDIR%\PumpUpdate.exe
  Command Line=/S /D /OSQL
  Flags=00000010
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=INFO: Running PumpUpdate for named instance %SQL_INSTANCE%
end
item: Execute Program
  Pathname=%MAINDIR%\PumpUpdate.exe
  Command Line=/S /D /OSQL /INSTANCE:%SQL_INSTANCE%
  Flags=00000010
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=Forecourt Interface Drivers
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Pump Update install result %INSTALL_RESULT%
end
item: Remark
end
item: Remark
  Text=Add support for EnablerEvent.DLL to the registry
end
item: Edit Registry
  Total Keys=2
  item: Key
    Key=SYSTEM\CurrentControlSet\Services\Eventlog\Application\Psrvr
    New Value=7
    Value Name=TypesSupported
    Root=2
    Data Type=3
  end
  item: Key
    Key=SYSTEM\CurrentControlSet\Services\Eventlog\Application\Psrvr
    New Value=%MAINDIR%\bin\EnablerEvent.dll
    Value Name=EventMessageFile
    Root=2
  end
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_Y_POS_
  Variable Name7=_MSG_TEXT_
  Variable Name8=_HEIGHT_
  Variable Value8=80
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: Remark
  Text=SDK options
end
item: If/While Statement
  Variable=SDK_OPTIONS
end
item: Remark
  Text=delete Sim, MPP driver if SDK option is not selected
end
item: Install File
  Source=v:\scripts\UninstallSim.sql
  Destination=%MAINDIR%\UninstallSim.sql
  Flags=0000000010000010
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-d EnablerDB -E -S%SQLQUERY% -i "%MAINDIR%\UninstallSim.sql"  -o  %MAINDIR%\SimInstall.log
  Flags=00001000
end
item: Else Statement
end
item: Remark
  Text=install Sim, MPP driver if SDK option is selected
end
item: Install File
  Source=v:\scripts\InstallSim.sql
  Destination=%MAINDIR%\InstallSim.sql
  Flags=0000000010000010
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-d EnablerDB -E -S%SQLQUERY% -i "%MAINDIR%\InstallSim.sql"  -o  %MAINDIR%\SimInstall.log
  Flags=00001000
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Remove old registry license for v4.0 Beta customers
end
item: Remark
  Text===========================================
end
item: Execute Program
  Pathname=%MAINDIR%\ConvertV4BetaLicense.exe
  Command Line=/r
  Flags=00001010
end
item: If/While Statement
  Variable=INSTALL_RESULT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=v4.0 Beta registry license removed 
end
item: End Block
end
item: Delete File
  Pathname=%MAINDIR%\ConvertV4BetaLicense.exe
end
item: Remark
end
item: Remark
  Text=Ok now start the Pump Server and Webhost
end
item: If/While Statement
  Variable=NOSTART
  Value=0
end
item: Start/Stop Service
  Service Name=psrvr
end
item: Start/Stop Service
  Service Name=enbweb
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Add some extra entries to the Wise log - so temporary or generated files are removed at uninstall
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\sleep.exe
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\InstallUtil.InstallLog
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\Autoupgrade.*
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\SetVersion.*
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\config70.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\DBU*.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\DBU*.sql
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\EnablerDBdoc.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\PumpUpdate.sql
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\pumpupdate.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\WISE_UPDATE.LOG
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\enabler.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\load.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*.bat
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*.oca
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*.nxe
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*.nei
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\bin\*.dll
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*.dll
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\*OK
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\www\Parameters.xml
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\PumpUpdate.log
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\PumpUpdate.sql
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\State\*
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\Driver\*
end
item: Add Text to INSTALL.LOG
  Text=File Tree: %MAINDIR%\bin\EnbWeb.InstallLog
end
item: Remark
end
item: Remark
  Text=Add entries to the Wise log to stop and remove services
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %MAINDIR%\scutil.exe /STOP enbweb
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %MAINDIR%\scutil.exe /STOP psrvr
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %MAINDIR%\bin\psrvr4.exe /UNREGSERVER
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %MAINDIR%\bin\enbweb.exe /uninstall
end
item: Remark
end
item: Else Statement
end
item: Remark
  Text=CLIENT INSTALLATION
end
item: Remark
end
item: Remark
  Text=Need to register the Enabler COM objects
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3=%APPTITLE%
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=B
  Variable Name6=_HEIGHT_
  Variable Value6=100
  Variable Name7=_MSG_TEXT_
  Variable Value7=Registering components
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Registering Enabler objects
end
item: Execute Program
  Pathname=regsvr32
  Command Line=/s %MAINDIR%\EnbSessionX2.OCX
  Flags=00001010
end
item: Remark
end
item: Remark
  Text=Client Install to Enabler Desktop (NOT Embedded)
end
item: If/While Statement
  Variable=CLIENTEMBEDDED
  Value=A
  Flags=00000011
end
item: Remark
  Text=EnbClient utility to setup DCOM to use the remote server we prompted for earlier
end
item: Custom Script Item
  Filename=Pause.wse
  Variable Name1=_PAUSE_TIME_
  Variable Value1=2000
  Variable Name2=HELPFILE
  Variable Value2=C:\Program Files\Wise Installation System\Help\Wise.hlp
end
item: Add Text to INSTALL.LOG
  Text=Configuring DCOM
end
item: If/While Statement
  Variable=SERVER_NAME
  Value=0
  Flags=00001100
end
item: Add Text to INSTALL.LOG
  Text=WARNING: no server name given - setting to default value 'SERVER'
end
item: Set Variable
  Variable=SERVER_NAME
  Value=SERVER
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Setup ODBC Data source for clients too
end
item: If/While Statement
  Variable=SQL_INSTANCE
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg.exe
  Command Line=/s %SERVER_NAME%
  Flags=00001010
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg64.exe
  Command Line=/s %SERVER_NAME%
  Flags=00001010
end
item: End Block
end
item: Else Statement
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg.exe
  Command Line=/s %SERVER_NAME% /i %SQL_INSTANCE%
  Flags=00001010
end
item: If/While Statement
  Variable=OS
  Value=64
end
item: Execute Program
  Pathname=%MAINDIR%\bin\odbcnfg64.exe
  Command Line=/s %SERVER_NAME% /i %SQL_INSTANCE%
  Flags=00001010
end
item: End Block
end
item: End Block
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Custom Script Item
  Filename=Display Progress Message.wse
  Variable Name1=_CENTER_
  Variable Value1=AB
  Variable Name2=_WIDTH_
  Variable Value2=320
  Variable Name3=_MSG_TITLE_
  Variable Value3= 
  Variable Name4=HELPFILE
  Variable Value4=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name5=_OPTION_
  Variable Value5=A
  Variable Name6=_HEIGHT_
  Variable Value6=80
  Variable Name7=_MSG_TEXT_
  Variable Name8=_Y_POS_
  Variable Name9=_X_POS_
end
item: End Block
end
item: Remark
end
item: End Block
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=ADD UNINSTALL ITEMS TO THE WISE INSTALL LOG
end
item: Remark
  Text===========================================
end
item: Remark
end
item: Remark
  Text=Uninstall the API
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %SYS32%\msiexec.exe /quiet /L+* %MAINDIR%\log\APIInstall.log /uninstall %MAINDIR%\InstallEnablerAPI.msi
end
item: Remark
end
item: Remark
end
item: Remark
  Text=Embed the Enabler Product Version - used to determine what version is installed
end
item: Add Text to INSTALL.LOG
  Text=EnablerVersion: %ENB_VERSION%
end
item: Remark
end
item: Remark
  Text=The following two lines reset COMMON and MAINDIR to short filesnames. This is for backwards compatibility.
end
item: Set Variable
  Variable=COMMON
  Value=%COMMON%
  Flags=00010100
end
item: Set Variable
  Variable=MAINDIR
  Value=%MAINDIR%
  Flags=00010100
end
item: Remark
end
item: Remark
  Text=Add some extra entries to the Wise log - so temporary or generated files are removed at uninstall
end
item: Add Text to INSTALL.LOG
  Text=Execute path: %SYS32%\msiexec.exe /quiet /L+* %MAINDIR%\log\APIInstall.log /X %MAINDIR%\InstallEnablerAPI.msi
end
item: Remark
end
item: Remark
  Text=Run an optional integrators sql file
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Checking for %INST%\ServerHook.sql  
end
item: Check if File/Dir Exists
  Pathname=%INST%\ServerHook.sql
  Flags=01000100
end
item: Add Text to INSTALL.LOG
  Text=Running %INST%\ServerHook.sql  (osql %OSQL_PATH%)
end
item: Execute Program
  Pathname=%OSQL_PATH%\OSQL.EXE
  Command Line=-b -d EnablerDB -E -S%SQLQUERY% -i "%INST%\ServerHook.sql"  -o  %MAINDIR%\ServerHook.log
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Completed ServerHook (return code %INSTALL_RESULT% )
end
item: End Block
end
item: Custom Script Item
  Filename=Check Service.wse
  Variable Name1=_SRV_NAME_
  Variable Value1=psrvr
  Variable Name2=HELPFILE
  Variable Value2=C:\Program Files\Wise Installation System\Help\Wise.hlp
  Variable Name3=_SRV_VAR_
  Variable Value3=RUNNING
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Update Registry Keys for future installations
end
item: Edit Registry
  Total Keys=3
  item: Key
    Key=Software\ITL\Enabler
    New Value=%COMPONENTS%
    Value Name=Components
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%APPLICATIONS%
    Value Name=Applications
    Root=2
  end
  item: Key
    Key=Software\ITL\Enabler
    New Value=%SDK%
    Value Name=SDK
    Root=2
  end
end
item: Remark
end
item: Remark
end
item: Remark
end
item: Remark
  Text===========================================
end
item: Remark
  Text=Reboot system to disable fast startup and change system power settings
end
item: Remark
  Text=This should be the last thing to do, so we moved the uninstall items before this
end
item: Remark
  Text===========================================
end
item: Remark
end
item: Remark
  Text=Only change setting for server
end
item: If/While Statement
  Value=Instr(COMPONENTS,"B")
  Flags=00001101
end
item: Remark
  Text=This is a server install
end
item: Remark
end
item: Remark
  Text=Get Registry value for Fast startup 
end
item: Get Registry Key Value
  Variable=FAST_STARTUP
  Key=SYSTEM\CurrentControlSet\Control\Power
  Default=0
  Value Name=HibernateEnabled
  Flags=00000100
end
item: Add Text to INSTALL.LOG
  Text=Fast Startup setting is: %FAST_STARTUP%
end
item: If/While Statement
  Variable=FAST_STARTUP
  Value=0
  Flags=00000001
end
item: Remark
  Text=Use Powercfg to disable Fast startup. Editing of Registry does NOT work for all OS
end
item: Execute Program
  Pathname=CMD.exe
  Command Line=/C powercfg.exe -H off
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Updating Registry setting to disable Fast Startup
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Force to disable ALL other sleep settings for all devices.
end
item: Remark
end
item: Execute Program
  Pathname=CMD.exe
  Command Line=/C powercfg.exe -change -standby-timeout-ac 0
  Flags=00001010
end
item: Execute Program
  Pathname=CMD.exe
  Command Line=/C powercfg.exe -change -standby-timeout-dc 0
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Update standby TO to 0 to prevent system goes to sleep
end
item: Remark
end
item: Execute Program
  Pathname=CMD.exe
  Command Line=/C powercfg.exe -change -hibernate-timeout-ac 0
  Flags=00001010
end
item: Execute Program
  Pathname=CMD.exe
  Command Line=/C powercfg.exe -change -hibernate-timeout-dc 0
  Flags=00001010
end
item: Add Text to INSTALL.LOG
  Text=Update hibernate TO to 0 to prevent system goes to hibernate
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Log Silent setting
end
item: Add Text to INSTALL.LOG
  Text=Silent setting is %SILENT%
end
item: Remark
end
item: Remark
  Text=This Wizard Loop finalizes the install 
end
item: If/While Statement
  Variable=UNATTENDED
  Value=0
end
item: Wizard Block
  Direction Variable=DIRECTION
  Display Variable=DISPLAY
  Bitmap Pathname=%_WISE_%\Dialogs\Template\SideImage.bmp
  X Position=0
  Y Position=0
  Filler Color=8421440
  Flags=00000011
end
breakpoint item: Custom Dialog Set
  Name=Finished
  Display Variable=DISPLAY
  item: Dialog
    Title=%APPTITLE%
    Title French=%APPTITLE%
    Title German=%APPTITLE%
    Title Portuguese=%APPTITLE%
    Title Spanish=%APPTITLE%
    Title Italian=%APPTITLE%
    Title Danish=%APPTITLE%
    Title Dutch=%APPTITLE%
    Title Norwegian=%APPTITLE%
    Title Swedish=%APPTITLE%
    Width=290
    Height=238
    Font Name=Helv
    Font Size=8
    Flags=0000000100000000
    item: Push Button
      Control Name=EXIT
      Rectangle=186 200 228 214
      Variable=DIRECTION
      Value=N
      Create Flags=01010000000000010000000000000001
      Text=&Exit
      Text French=&Terminer>
      Text German=&Fertigstellen>
      Text Portuguese=&Terminar >
      Text Spanish=&Finalizar>
      Text Italian=&Fine >
      Text Danish=&Afslut >
      Text Dutch=&Klaar>
      Text Norwegian=&Avslutt>
      Text Swedish=&Sluta>
    end
    item: Push Button
      Control Name=CANCEL
      Rectangle=237 200 279 214
      Action=3
      Create Flags=01010000000000010000000000000000
      Text=Cancel
      Text French=Annuler
      Text German=Abbrechen
      Text Portuguese=Cancelar
      Text Spanish=Cancelar
      Text Italian=Annulla
      Text Danish=Annuller
      Text Dutch=Annuleren
      Text Norwegian=Avbryt
      Text Swedish=Avbryt
    end
    item: Static
      Rectangle=0 193 285 194
      Action=3
      Create Flags=01010000000000000000000000000111
    end
    item: Static
      Rectangle=100 10 275 38
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Flags=0000000000000001
      Name=Arial
      Font Style=-13 0 0 0 700 0 0 0 0 3 2 1 34
      Text=%APPTITLE% software has been successfully installed.
      Text French=L'installation de %APPTITLE% est réussie.
      Text French=
      Text French=
      Text French=Cliquez sur Terminer pour quitter cette installation.
      Text French=
      Text German=%APPTITLE% wurde erfolgreich installiert.
      Text German=
      Text German=
      Text German=Zum Beenden dieser Installation Fertigstellen anklicken.
      Text German=
      Text Portuguese=%APPTITLE% foi instalado com êxito
      Text Portuguese=
      Text Portuguese=
      Text Portuguese=Pressionar o botão Terminar para sair desta instalação
      Text Portuguese=
      Text Spanish=%APPTITLE% se ha instalado con éxito.
      Text Spanish=
      Text Spanish=
      Text Spanish=Pulse el botón de Finalizar para salir de esta instalación.
      Text Spanish=
      Text Italian=%APPTITLE% è stato installato.
      Text Italian=
      Text Italian=
      Text Italian=Premi il pulsante Fine per uscire dal programma di installazione
      Text Italian=
      Text Danish=%APPTITLE% er nu installeret korrekt.
      Text Danish=
      Text Danish=
      Text Danish=Klik på Afslut for at afslutte installationen.
      Text Danish=
      Text Dutch=%APPTITLE% is met succes geïnstalleerd.
      Text Dutch=
      Text Dutch=
      Text Dutch=Druk op Klaar om deze installatie af te ronden.
      Text Dutch=
      Text Norwegian=Installasjonen av %APPTITLE% er vellykket.
      Text Norwegian=
      Text Norwegian=
      Text Norwegian=Trykk på Avslutt-tasten for å avslutte denne installasjonen.
      Text Norwegian=
      Text Swedish=Installationen av %APPTITLE% har lyckats.
      Text Swedish=
      Text Swedish=
      Text Swedish=Tryck på Sluta för att gå ur installationsprogrammet.
      Text Swedish=
    end
    item: Push Button
      Control Name=BACK
      Rectangle=144 200 186 214
      Variable=DIRECTION
      Value=B
      Create Flags=01010000000000010000000000000000
      Text=< &Back
      Text French=<&Retour
      Text German=<&Zurück
      Text Portuguese=<&Retornar
      Text Spanish=<&Retroceder
      Text Italian=< &Indietro
      Text Danish=<&Tilbage
      Text Dutch=<&Terug
      Text Norwegian=<&Tilbake
      Text Swedish=< &Tillbaka
    end
    item: Static
      Rectangle=0 0 93 193
      Destination Dialog=1
      Action=2
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000001011
      Pathname=V:\finished.bmp
      Pathname French=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname German=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Portuguese=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Spanish=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Italian=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Danish=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Dutch=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Norwegian=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
      Pathname Swedish=%_WISE_%\DIALOGS\TEMPLATE\SideImage.bmp
    end
    item: Checkbox
      Control Name=startmpp
      Rectangle=135 168 234 179
      Variable=START_MPP
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=Start the Pump Simulator
      Text=
    end
    item: Static
      Control Name=restartMessage
      Rectangle=107 49 248 97
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=To complete the installation of Enabler you must restart this Computer.
      Text=
      Text=The Pump Server (PSRVR) is %RUNNING%
      Text=
    end
    item: Static
      Control Name=driverMessage2
      Rectangle=107 89 252 109
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=The Enabler card driver has failed to install.
    end
    item: Static
      Control Name=driverMessage3
      Rectangle=111 44 266 84
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=The Enabler installer was unable to detect an Enabler card installed in this Computer.
      Text=
      Text=Please shutdown the computer and install the Enabler card.
      Text=
      Text=See the Enabler Installation Instructions.pdf - Section 3.3 Hardware Installation - Enabler Card
    end
    item: Checkbox
      Control Name=startpump
      Rectangle=135 154 234 169
      Variable=START_PUMP
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=Start Pump Demo
      Text=
    end
    item: Checkbox
      Control Name=openweb
      Rectangle=135 180 234 191
      Variable=OPEN_WEB
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000010000000000000011
      Text=Open Enabler Web
      Text=
    end
    item: Static
      Control Name=poweroptionsMessage4
      Rectangle=109 105 244 125
      Destination Dialog=4
      Enabled Color=00000000000000001111111111111111
      Create Flags=01010000000000000000000000000000
      Text=Windows Power Options have been reconfigured for The Enabler.
    end
    item: Remark
    end
    item: Set Control Attribute
      Control Name=BACK
      Operation=1
    end
    item: Set Control Attribute
      Control Name=CANCEL
      Operation=1
    end
    item: Set Control Attribute
      Control Name=startmpp
      Operation=1
    end
    item: Set Control Attribute
      Control Name=startpump
      Operation=1
    end
    item: Set Control Attribute
      Control Name=restartMessage
      Operation=2
    end
    item: Set Control Attribute
      Control Name=driverMessage2
      Operation=2
    end
    item: Set Control Attribute
      Control Name=driverMessage3
      Operation=2
    end
    item: Set Control Attribute
      Control Name=poweroptionsMessage4
      Operation=2
    end
    item: Set Control Attribute
      Control Name=startmpp
      Operation=2
    end
    item: Set Control Attribute
      Control Name=startpump
      Operation=2
    end
    item: Set Control Attribute
      Control Name=openweb
      Operation=2
    end
    item: Remark
    end
    item: Remark
      Text=Check for NOSTART - no point offering this option the web server will be stopped!
    end
    item: If/While Statement
      Variable=NOSTART
      Value=0
    end
    item: Check if File/Dir Exists
      Pathname=%IEXPLORE_PATH%
      Flags=00000100
    end
    item: If/While Statement
      Variable=IEXPLORE_VERSION
      Value=5
      Flags=00000111
    end
    item: Set Control Attribute
      Control Name=openweb
    end
    item: End Block
    end
    item: End Block
    end
    item: End Block
    end
    item: Remark
    end
    item: Remark
      Text=Server install
    end
    item: If/While Statement
      Variable=COMPONENTS
      Value=B
      Flags=00001010
    end
    item: Remark
    end
    item: Remark
      Text=Check for NOSTART
    end
    item: If/While Statement
      Variable=NOSTART
      Value=0
    end
    item: Remark
    end
    item: Remark
      Text=Pump server is running
    end
    item: If/While Statement
      Variable=RUNNING
      Value=Running
      Flags=00000010
    end
    item: Remark
    end
    item: Remark
      Text=Check Driver install status
    end
    item: If/While Statement
      Variable=DRIVERCODE
      Value=1
      Flags=00001001
    end
    item: Remark
      Text=Return code 1 means requires Reboot but we are ignoring this
    end
    item: Remark
    end
    item: Remark
      Text=MPPsim was installed
    end
    item: If/While Statement
      Variable=SDK_OPTIONS
      Value=A
      Flags=00000010
    end
    item: Set Control Attribute
      Control Name=startmpp
    end
    item: End Block
    end
    item: Remark
    end
    item: Remark
      Text=Pump demo was installed
    end
    item: If/While Statement
      Variable=SDK_OPTIONS
      Value=B
      Flags=00000010
    end
    item: Set Control Attribute
      Control Name=startpump
    end
    item: End Block
    end
    item: Remark
    end
    item: ElseIf Statement
      Variable=DRIVERCODE
      Value=2
    end
    item: Remark
      Text=Failed Install
    end
    item: Set Control Attribute
      Control Name=driverMessage2
    end
    item: ElseIf Statement
      Variable=DRIVERCODE
      Value=3
    end
    item: Remark
      Text=No device present
    end
    item: Set Control Attribute
      Control Name=driverMessage3
    end
    item: End Block
    end
    item: Remark
    end
    item: Set Control Attribute
      Control Name=poweroptionsMessage4
    end
    item: End Block
    end
    item: Remark
    end
    item: Else Statement
    end
    item: Remark
      Text=Pump server is NOT running
    end
    item: Set Control Attribute
      Control Name=restartMessage
    end
    item: End Block
    end
    item: Remark
    end
    item: End Block
    end
    item: Remark
    end
    item: Remark
    end
  end
end
item: End Block
end
item: End Block
end
item: Add Text to INSTALL.LOG
  Text=Install is Finished
end
item: Remark
end
item: Remark
  Text=Add uninstall details to the registry...
end
item: Edit Registry
  Total Keys=3
  item: Key
    Key=Software\Microsoft\Windows\CurrentVersion\Uninstall\%APPTITLE%
    New Value=Integration Technologies Limited
    Value Name=Publisher
    Root=2
  end
  item: Key
    Key=Software\Microsoft\Windows\CurrentVersion\Uninstall\%APPTITLE%
    New Value=http://www.integration.co.nz/support.htm
    Value Name=URLInfoAbout
    Root=2
  end
  item: Key
    Key=Software\Microsoft\Windows\CurrentVersion\Uninstall\%APPTITLE%
    New Value=Windows-based Forecourt Control by Integration Technologies Limited.
    New Value=
    Value Name=Comments
    Root=2
  end
end
item: Edit Registry
  Total Keys=1
  Key=Software\Microsoft\Windows\CurrentVersion\Uninstall\%APPTITLE%
  New Value=%MAINDIR%\itl.ico,-0
  Value Name=DisplayIcon
  Root=2
end
item: Remark
end
item: Remark
  Text=Reboot the PC
end
item: If/While Statement
  Variable=FAST_STARTUP
  Value=0
  Flags=00000001
end
item: If/While Statement
  Variable=SILENT
  Value=0
end
item: Add Text to INSTALL.LOG
  Text=Rebooting system to disable fast startup
end
item: Custom Script Item
  Filename=Reboot System.wse
  Variable Name1=HELPFILE
  Variable Value1=C:\Program Files (x86)\Wise Installation System\Help\Wise.hlp
  Variable Name2=_REBOOT_TYPE_
  Variable Value2=B
end
item: Else Statement
end
item: Add Text to INSTALL.LOG
  Text=Reboot required to disable fast startup
end
item: End Block
end
item: Exit Installation
  Flags=6
end
item: End Block
end
item: Remark
end
item: If/While Statement
  Variable=SILENT
  Value=1
end
item: Remark
  Text=This error return code is only for Silent Mode Install
end
item: Set Variable
  Variable=WISE_ERROR_RTN
  Value=0
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Decide whether we should start things
end
item: Set Variable
  Variable=DO_START_ACTIONS
  Value=1
end
item: If/While Statement
  Variable=COMPONENTS
  Value=B
  Flags=00001010
end
item: Remark
  Text=For server installs we only start things if the server is running
end
item: If/While Statement
  Variable=RUNNING
  Value=Running
  Flags=00000011
end
item: Set Variable
  Variable=DO_START_ACTIONS
  Value=0
end
item: End Block
end
item: End Block
end
item: Remark
end
item: Remark
  Text=Start things the installer asked for
end
item: If/While Statement
  Variable=DO_START_ACTIONS
  Value=1
end
item: If/While Statement
  Variable=START_MPP
  Value=A
  Flags=00000010
end
item: Execute Program
  Pathname=%MAINDIR%\mppsim.exe
end
item: End Block
end
item: If/While Statement
  Variable=START_PUMP
  Value=A
  Flags=00000010
end
item: Execute Program
  Pathname=%MAINDIR%\PumpDemoWPF.exe
end
item: End Block
end
item: If/While Statement
  Variable=OPEN_WEB
  Value=A
  Flags=00000010
end
item: If/While Statement
  Variable=SERVER_NAME
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C start http://localhost:%ENBWEB_PORT%
  Flags=00000100
end
item: Else Statement
end
item: Remark
  Text=Note that this could be a PC server (port 8081), or EMB (Port 80)
end
item: Execute Program
  Pathname=CMD.EXE
  Command Line=/C start http://%SERVER_NAME%%ENBWEB_PORT_STR%
  Flags=00000100
end
item: End Block
end
item: End Block
end
item: End Block
end
